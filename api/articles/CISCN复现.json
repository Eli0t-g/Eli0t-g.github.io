{"title":"CISCN复现","uid":"dde0577c288faf648c0d6f90bbb39dc6","slug":"CISCN复现","date":"2021-05-18T11:25:16.000Z","updated":"2021-05-23T05:52:38.991Z","comments":true,"path":"api/articles/CISCN复现.json","keywords":null,"cover":"https://i.loli.net/2021/05/18/oDJvw6ieQjbXmrq.jpg","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>初次参加这种大型比赛，给我的感觉就是题目出的挺不错（一题都没做出来），但是这个比赛形式着实令人不解。不仅如此，在写完选择题后系统崩溃也是我没想得到（虽然没有停滞很久，但是感觉很意外，毕竟是国赛）。</p>\n<h1 id=\"MISC\"><a href=\"#MISC\" class=\"headerlink\" title=\"MISC\"></a>MISC</h1><h2 id=\"隔空传话\"><a href=\"#隔空传话\" class=\"headerlink\" title=\"隔空传话\"></a>隔空传话</h2><p>附件是一个txt文件，里面全是十六进制码，根据题目搜索发现是<a href=\"http://www.sendsms.cn/pdu/\"><strong>PDU编码解码</strong></a>，解码发现前面四行得到有用的信息：flag前面一部分是15030442和w465。而后面则是一堆十六进制码，但是发现在第一行十六进制码的开头几个十六进制码正好是png十六进制文件头，猜测这些应该是png图片的十六进制码，利用脚本将其导出：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打开读取data.txt文件</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;../data.txt&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    data = f.read()</span><br><span class=\"line\">data = data.splitlines()[<span class=\"number\">4</span>:]  <span class=\"comment\"># 前四条不是十六进制</span></span><br><span class=\"line\"><span class=\"comment\"># 启动谷歌</span></span><br><span class=\"line\">browser = webdriver.Chrome()</span><br><span class=\"line\">url = <span class=\"string\">&quot;http://www.sendsms.cn/pdu/&quot;</span></span><br><span class=\"line\">browser.get(url)</span><br><span class=\"line\">output = <span class=\"string\">&#x27;&#x27;</span>  <span class=\"comment\"># 用于接收结果</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">    browser.find_element_by_name(<span class=\"string\">&quot;smsText2&quot;</span>).clear()  <span class=\"comment\"># 清空转换框里面的内容</span></span><br><span class=\"line\">    browser.find_element_by_name(<span class=\"string\">&quot;smsText2&quot;</span>).send_keys(i)  <span class=\"comment\"># 输入要翻译的内容</span></span><br><span class=\"line\">    browser.find_element_by_xpath(<span class=\"string\">&quot;//input[@name=&#x27;checkButton&#x27;]&quot;</span>).click()  <span class=\"comment\"># 点击翻译</span></span><br><span class=\"line\">    recv = browser.find_element_by_name(<span class=\"string\">&quot;smsOut&quot;</span>).get_attribute(<span class=\"string\">&#x27;value&#x27;</span>)  <span class=\"comment\"># 获取翻译内容</span></span><br><span class=\"line\">    recv = recv.split()  <span class=\"comment\"># 将获得内容按空格分开</span></span><br><span class=\"line\">    n = <span class=\"number\">0</span></span><br><span class=\"line\">    txt = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> recv:  <span class=\"comment\"># 读取需要的信息</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> n == <span class=\"number\">3</span>:  <span class=\"comment\"># 获取时间戳</span></span><br><span class=\"line\">            txt += j</span><br><span class=\"line\">        <span class=\"keyword\">if</span> n == <span class=\"number\">13</span>:</span><br><span class=\"line\">            txt += j  <span class=\"comment\"># 获取十六进制码</span></span><br><span class=\"line\">            txt += <span class=\"string\">&#x27;\\n&#x27;</span>  <span class=\"comment\"># 分行</span></span><br><span class=\"line\">        n += <span class=\"number\">1</span></span><br><span class=\"line\">    output += txt</span><br><span class=\"line\">browser.quit()  <span class=\"comment\"># 退出浏览器</span></span><br><span class=\"line\">output = output.splitlines()</span><br><span class=\"line\">result = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">time = []</span><br><span class=\"line\">data = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> output:  <span class=\"comment\"># 按时间戳进行排序</span></span><br><span class=\"line\">    time.append(<span class=\"built_in\">int</span>(i[<span class=\"number\">3</span>:<span class=\"number\">5</span>]) * <span class=\"number\">60</span> + <span class=\"built_in\">int</span>(i[<span class=\"number\">6</span>:<span class=\"number\">8</span>]) - <span class=\"number\">1800</span>)</span><br><span class=\"line\">    data.append(i[<span class=\"number\">8</span>:])</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"number\">1200</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(data)):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> i == time[j]:</span><br><span class=\"line\">            result += data[j]</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;output.txt&#x27;</span>, <span class=\"string\">&#x27;w&#x27;</span>) <span class=\"keyword\">as</span> f:  <span class=\"comment\"># 将结果保存到out.txt文件中</span></span><br><span class=\"line\">    f.write(result)</span><br></pre></td></tr></table></figure>\n\n<p>之后导出图片，发现图片乱七八糟，想到之前w465应该是width465转成十六进制码就是1D1，得到图片</p>\n<p><img src=\"https://i.loli.net/2021/05/18/du2PwMJRpSQLDyW.png\" alt=\"未命名_1_.png\"></p>\n<p>结合前面得到flag：CISCN{15030442_b586_4c9e_b436_26def12293e4}</p>\n","feature":true,"text":"前言初次参加这种大型比赛，给我的感觉就是题目出的挺不错（一题都没做出来），但是这个比赛形式着实令人不解。不仅如此，在写完选择题后系统崩溃也是我没想得到（虽然没有停滞很久，但是感觉很意外，毕竟是国赛）。 MISC隔空传话附件是一个txt文件，里面全是十六进制码，根据题目搜索发现是P...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"MISC","slug":"MISC","count":4,"path":"api/categories/MISC.json"}],"tags":[{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#MISC\"><span class=\"toc-text\">MISC</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9A%94%E7%A9%BA%E4%BC%A0%E8%AF%9D\"><span class=\"toc-text\">隔空传话</span></a></li></ol></li></ol>","author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"不要等待，时机永远不会恰到好处。","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"栈溢出","uid":"a37c8c0bbab0e8b3e41a4408c944d53f","slug":"栈溢出","date":"2021-05-23T05:47:11.000Z","updated":"2021-05-25T12:46:44.648Z","comments":true,"path":"api/articles/栈溢出.json","keywords":null,"cover":"https://i.loli.net/2021/05/24/6ewQX9kiC7ZpuOd.jpg","text":"利用gets函数实现栈溢出 因为gets函数并没有对输入做限制，所以很容易造成数据被覆盖，造成栈溢出，下面几道题目就是利用gets函数获得flag rip思路首先查看附件，发现没开什么保护，丢进IDA里面看一下 发现可疑函数（fun），点进去可以发现函数调用了/bin/sh，接下...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"PWN","slug":"PWN","count":2,"path":"api/categories/PWN.json"}],"tags":[{"name":"wp","slug":"wp","count":3,"path":"api/tags/wp.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"不要等待，时机永远不会恰到好处。","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"pygame使用","uid":"7ceb9bfebefe73ecc89b8753e3a43190","slug":"pygame使用","date":"2021-05-12T12:25:39.000Z","updated":"2021-05-13T13:05:28.997Z","comments":true,"path":"api/articles/pygame使用.json","keywords":null,"cover":"https://i.loli.net/2021/05/06/flvMEUJHAYwSNq2.jpg","text":" 了解，学习一个第三方模块，最好是去官网学习，因为官方有第一手资料，而在其他人手里则是第二手，使用要学好还是得去官网。在这里我就直接拿实例讲pygame 安装pygame (windows)1python -m pip install -U pygame --user 可能的报错...","link":"","photos":[],"count_time":{"symbolsCount":"20k","symbolsTime":"19 mins."},"categories":[{"name":"心得","slug":"心得","count":2,"path":"api/categories/心得.json"}],"tags":[{"name":"python","slug":"python","count":1,"path":"api/tags/python.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"不要等待，时机永远不会恰到好处。","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}}}}