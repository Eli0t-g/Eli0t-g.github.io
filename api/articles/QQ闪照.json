{"title":"QQé—ªç…§ç ´è§£ï¼ˆå¾…å®Œç»“ï¼‰","uid":"cca552dbfefca5d5c398c58d9b5bb49c","slug":"QQé—ªç…§","date":"2021-10-13T11:02:46.000Z","updated":"2021-10-13T12:12:39.912Z","comments":true,"path":"api/articles/QQé—ªç…§.json","keywords":null,"cover":"https://i.loli.net/2021/10/13/SQzI7OaUjl2bJ83.jpg","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å’Œæœ‹å‹èŠå¤©æ—¶çªå‘å¥‡æƒ³ï¼Œæƒ³å°è¯•ä¸€ä¸‹è·å–é—ªç…§æºæ–‡ä»¶ï¼Œå¿™äº†ä¸€ä¸ªä¸‹åˆè¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼ˆä¸»è¦æ˜¯å¤ªèœäº† /(ã„’oã„’)/~~ ï¼‰</p></blockquote>\n<h1 id=\"åŸç†å’Œæ€è·¯\"><a href=\"#åŸç†å’Œæ€è·¯\" class=\"headerlink\" title=\"åŸç†å’Œæ€è·¯\"></a>åŸç†å’Œæ€è·¯</h1><p>é—ªç…§è²Œä¼¼æ˜¯ä¸€ç§æœ¨é©¬æ”¹ç¼–è€Œæ¥ï¼Œä½†æ˜¯å› ä¸ºå®ç”¨æ€§ä¸é«˜å¯èƒ½å°±è¢«è®¾è®¡æˆé—ªç…§äº†ï¼ˆç›²çŒœï¼‰ã€‚é—ªç…§çš„å·¥ä½œåŸç†å¤§æ¦‚æ˜¯æœ‰ä¸€ä¸ªFLAG_SECUREçª—å£ï¼Œå¦‚æœå¯ç”¨äº†FLAG_SECUREï¼Œé‚£ä¹ˆå°†ä¸å…è®¸ç”¨æˆ·åœ¨æ­¤ç•Œé¢æˆªå›¾/å½•å±ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸æˆªå›¾è¿™ä¸ªåŠŸèƒ½æ˜¯Androidç³»ç»Ÿæä¾›ç»™å¼€å‘è€…çš„ã€‚å½“æ—¶é—´ä¸€è¿‡ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨å°†é—ªç…§åˆ é™¤ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æœ‰ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼Œå°±æ˜¯åœ¨ç…§ç‰‡è¿˜æœªè¯»å–æ—¶ï¼Œç…§ç‰‡ä¼šå­˜åœ¨äºç¼“å­˜ä¹‹ä¸­ï¼Œå¾ˆå®¹æ˜“è¢«æå–å‡ºæ¥æŸ¥çœ‹ã€‚<img src=\"https://i.loli.net/2021/10/13/94hWsJ3cOzAQvUk.jpg\" alt=\"v2-490e56ae39fb40e269e4b0076e8fcf43_r.jpg\"></p>\n<p>æ‰€ä»¥åœ¨2021å¹´ä»¥å‰çš„qqï¼Œé—ªç…§åŸºæœ¬ä¸Šå’Œæ™®é€šç…§ç‰‡æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªè¦åœ¨ç¼“å­˜ä¸­æå–åˆ°å°±å¯ä»¥ä¿å­˜èµ·æ¥ã€‚ä½†æ˜¯ç°åœ¨å·²ç»è¢«ä¿®å¤äº†ï¼Œç½‘ä¸Šå¤§éƒ¨åˆ†æ•™ç¨‹å·²ç»å¤±æ•ˆäº†ã€‚ï¼ˆå¯èƒ½æŸäº›å¤§ä½¬è‡ªå·±ç ´è§£äº†ï¼Œåªæ˜¯æˆ‘ä¸çŸ¥é“ï¼‰ã€‚ç°åœ¨çš„é—ªç…§åœ¨ç¼“å­˜ä¸­æå–åˆ°æ”¹åç¼€å·²ç»æ²¡æœ‰ç”¨äº†ï¼Œå› ä¸ºç°åœ¨çš„ç…§ç‰‡å·²ç»è¢«åŠ å¯†äº†ï¼ˆæ–‡ä»¶å¤´å°±å†™ç€åŠ å¯†äºŒå­—ğŸ˜’ï¼‰</p>\n<p>æ¥ä¸‹æ¥å°±æ˜¯è®²è®²æˆ‘è‡ªå·±çš„æ€è·¯ï¼š</p>\n<p>1ã€é¦–å…ˆæ‰¾åˆ°ç¼“å†²åŒºæ–‡ä»¶ï¼Œè·¯å¾„ï¼ˆAndriod/data/com.tecent.mobileqq/Tencent/MobileQQ/chatpic/chatimgï¼‰ï¼Œé‡Œé¢çš„ä¸œè¥¿åº”è¯¥å’Œä¸‹é¢å·®ä¸å¤šï¼ˆå¦‚æœæ‰¾ä¸åˆ°å¯èƒ½æ˜¯æ²¡æœ‰æ‰“å¼€æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚ï¼‰ï¼Œä¹‹åæŒ‰ç…§æ—¶é—´é¡ºåºæ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚<img src=\"https://i.loli.net/2021/10/13/bcLsOGxe7SrHBPq.jpg\" alt=\"QQå›¾ç‰‡20211013192450.jpg\"></p>\n<p>å½“åˆæ‰¾åˆ°ä»¥åé«˜å…´äº†è€åŠå¤©ï¼Œç»“æœæ‰“å¼€å‘ç°è¢«åŠ å¯†äº†ï¼Œæ°”çš„æƒ³æ‰“äººã€‚åé¢çœ‹åˆ°ä¸€ä¸ªå¤§ä½¬è®²è§£ï¼Œå‘ç°æ˜¯desåŠ å¯†ï¼ˆå°±çŸ¥é“è…¾è®¯ä¸ä¼šå‹¤å¿«åˆ°è‡ªå·±å†™å‡ºç®—æ³•ï¼‰ä»–é€šè¿‡TIM2.1.0çš„apkåç¼–è¯‘äº†ä¸€ä¸‹ï¼Œå‘ç°com.tencent.mobileqq.utils.DESUtilä¸­æœ‰å‡ ä¸ªå‡½æ•°å¯ä»¥åŠ è§£å¯†é—ªç…§å›¾ç‰‡ï¼Œå‘ç°ä½¿ç”¨çš„æ˜¯javax.cryptoåŠ è§£å¯†ã€‚</p>\n<p>è¿™ä¸ªç±»å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå…¶ä¸­byte[]å‚æ•°æ˜¯åŠ è§£å¯†çš„key</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * Decompiled with CFR 0_123.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.tencent.mobileqq.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.tencent.mobileqq.utils.FileUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.tencent.qphone.base.util.QLog;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileInputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.OutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.RandomAccessFile;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.UnsupportedEncodingException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.security.Key;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.crypto.Cipher;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.crypto.CipherInputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.crypto.CipherOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DESUtil</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">a</span><span class=\"params\">(File var0, File var1_6, <span class=\"keyword\">byte</span>[] var2_8)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//åŠ å¯†</span></span><br><span class=\"line\">        var6_15 = <span class=\"keyword\">new</span> SecretKeySpec(DESUtil.a((<span class=\"keyword\">byte</span>[])var2_8), <span class=\"string\">&quot;DES&quot;</span>);</span><br><span class=\"line\">        var2_8 = Cipher.getInstance(<span class=\"string\">&quot;DES&quot;</span>);</span><br><span class=\"line\">        var2_8.init(<span class=\"number\">1</span>, (Key)var6_15);</span><br><span class=\"line\">        var6_15 = <span class=\"keyword\">new</span> FileInputStream((File)var0);</span><br><span class=\"line\">        var0 = <span class=\"keyword\">new</span> FileOutputStream((File)var1_6);</span><br><span class=\"line\">        var1_6 = <span class=\"keyword\">new</span> CipherInputStream((InputStream)var6_15, (Cipher)var2_8);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            var2_8 = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            var0.write(<span class=\"string\">&quot;ENCRYPT:&quot;</span>.getBytes(<span class=\"string\">&quot;UTF-8&quot;</span>));<span class=\"comment\">//å†™æ–‡ä»¶å¤´</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> ((var3_16 = var1_6.read((<span class=\"keyword\">byte</span>[])var2_8)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                var0.write((<span class=\"keyword\">byte</span>[])var2_8, <span class=\"number\">0</span>, var3_16);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception var4_11) &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//ç•¥</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">a</span><span class=\"params\">(String string, String string2)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (DESUtil.a(string)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">2</span>, (String)(<span class=\"string\">&quot;encrypt had encrypt,file:&quot;</span> + string));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l = System.currentTimeMillis();</span><br><span class=\"line\">                Object object = string + <span class=\"string\">&quot;.tmp&quot;</span>;</span><br><span class=\"line\">                File file = <span class=\"keyword\">new</span> File(string);</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l2 = file.length() / <span class=\"number\">1024</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((object = <span class=\"keyword\">new</span> File((String)object)).exists()) &#123;</span><br><span class=\"line\">                    object.delete();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                DESUtil.a(file, (File)object, string2.getBytes(<span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">                FileUtils.a((File)object, (File)file);</span><br><span class=\"line\">                object.delete();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">4</span>, (String)(<span class=\"string\">&quot;DES Encrypt filePath:&quot;</span> + string + <span class=\"string\">&quot;,key:&quot;</span> + string2 + <span class=\"string\">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class=\"string\">&quot;,fileSize:&quot;</span> + l2 + <span class=\"string\">&quot;KB&quot;</span>));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class=\"line\">            unsupportedEncodingException.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">a</span><span class=\"params\">(String string, String object, String string2)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//è¿˜æ˜¯å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (DESUtil.a(string)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">2</span>, (String)(<span class=\"string\">&quot;encrypt had encrypt,file:&quot;</span> + string));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l = System.currentTimeMillis();</span><br><span class=\"line\">                File file = <span class=\"keyword\">new</span> File(string);</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l2 = file.length() / <span class=\"number\">1024</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((object = <span class=\"keyword\">new</span> File((String)object)).exists()) &#123;</span><br><span class=\"line\">                    object.delete();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                DESUtil.a(file, (File)object, string2.getBytes(<span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">                file.delete();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">4</span>, (String)(<span class=\"string\">&quot;DES Encrypt filePath:&quot;</span> + string + <span class=\"string\">&quot;,key:&quot;</span> + string2 + <span class=\"string\">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class=\"string\">&quot;,fileSize:&quot;</span> + l2 + <span class=\"string\">&quot;KB&quot;</span>));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class=\"line\">            unsupportedEncodingException.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">a</span><span class=\"params\">(String var0)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//åç¼–è¯‘å‡ºæ¥çš„ä»£ç æ¯”ä¸Šé¢çš„è¿˜ä¹±æ­¤ç•¥ï¼Œ</span></span><br><span class=\"line\">\t<span class=\"comment\">//ä»QLogå†™å…¥çš„å†…å®¹å¤§è‡´å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°çš„ä½œç”¨åº”è¯¥æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²ç»åŠ /è§£å¯†è¿‡</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">byte</span>[] a(<span class=\"keyword\">byte</span>[] arrby) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¿è¯keyæ•°ç»„å®šé•¿æ˜¯8ï¼Ÿ</span></span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] arrby2 = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">8</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arrby2.length &gt; arrby.length) &#123;</span><br><span class=\"line\">            System.arraycopy(arrby, <span class=\"number\">0</span>, arrby2, <span class=\"number\">0</span>, arrby.length);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> arrby2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.arraycopy(arrby, <span class=\"number\">0</span>, arrby2, <span class=\"number\">0</span>, arrby2.length);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arrby2;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">b</span><span class=\"params\">(File var0, File var1_5, <span class=\"keyword\">byte</span>[] var2_7)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//è§£å¯†</span></span><br><span class=\"line\">        var2_7 = <span class=\"keyword\">new</span> SecretKeySpec(DESUtil.a((<span class=\"keyword\">byte</span>[])var2_7), <span class=\"string\">&quot;DES&quot;</span>);</span><br><span class=\"line\">        var6_15 = Cipher.getInstance(<span class=\"string\">&quot;DES&quot;</span>);</span><br><span class=\"line\">        var6_15.init(<span class=\"number\">2</span>, (Key)var2_7);</span><br><span class=\"line\">        var2_7 = <span class=\"keyword\">new</span> RandomAccessFile((File)var0, <span class=\"string\">&quot;r&quot;</span>);</span><br><span class=\"line\">        var2_7.seek(<span class=\"string\">&quot;ENCRYPT:&quot;</span>.getBytes(<span class=\"string\">&quot;UTF-8&quot;</span>).length);<span class=\"comment\">//è·³è¿‡æ–‡ä»¶å¤´</span></span><br><span class=\"line\">        var0 = <span class=\"keyword\">new</span> CipherOutputStream(<span class=\"keyword\">new</span> FileOutputStream((File)var1_5), var6_15);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            var1_5 = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            <span class=\"keyword\">while</span> ((var3_16 = var2_7.read((<span class=\"keyword\">byte</span>[])var1_5)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                var0.write((<span class=\"keyword\">byte</span>[])var1_5, <span class=\"number\">0</span>, var3_16);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (Exception var4_10) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//ç•¥</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">b</span><span class=\"params\">(String string, String string2)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//å¸¦æ—¥å¿—çš„è§£å¯†</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!DESUtil.a(string)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">2</span>, (String)(<span class=\"string\">&quot;decrypt had no encrypt,file:&quot;</span> + string));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l = System.currentTimeMillis();</span><br><span class=\"line\">                Object object = string + <span class=\"string\">&quot;.tmp&quot;</span>;</span><br><span class=\"line\">                File file = <span class=\"keyword\">new</span> File(string);</span><br><span class=\"line\">                <span class=\"keyword\">long</span> l2 = file.length() / <span class=\"number\">1024</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> ((object = <span class=\"keyword\">new</span> File((String)object)).exists()) &#123;</span><br><span class=\"line\">                    object.delete();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                DESUtil.b(file, (File)object, string2.getBytes(<span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">                FileUtils.a((File)object, (File)file);</span><br><span class=\"line\">                object.delete();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class=\"line\">                    QLog.d((String)<span class=\"string\">&quot;DESUtil&quot;</span>, (<span class=\"keyword\">int</span>)<span class=\"number\">4</span>, (String)(<span class=\"string\">&quot;DES Decrypt filePath:&quot;</span> + string + <span class=\"string\">&quot;,key:&quot;</span> + string2 + <span class=\"string\">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class=\"string\">&quot;,fileSize:&quot;</span> + l2 + <span class=\"string\">&quot;KB&quot;</span>));</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class=\"line\">            unsupportedEncodingException.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æˆ‘ä»¥ä¸ºèƒœåˆ©åœ¨æœ›ï¼Œæˆ‘è¯·æ•™äº†å¸ˆå…„ï¼Œå‘ç°å…¶ä¸­å‡ ä¸ªåŒ…å¾—ä¸åˆ°ï¼Œæ ¹æœ¬ç ´è§£ä¸äº†ï¼ˆo(*â‰§â–½â‰¦)ãƒ„â”â”â”“ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.tencent.mobileqq.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.tencent.mobileqq.utils.FileUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.tencent.qphone.base.util.QLog;</span><br></pre></td></tr></table></figure>\n\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä¸çŸ¥é“keyä»ä½•æ¥ï¼Œå¤§ä½¬ä¹Ÿè¯´è¦ä¹ˆéœ€è¦å¤„äºç™»å½•çŠ¶æ€ç”¨ä¸€å®šæ–¹å¼ä»æœåŠ¡å™¨å¾—åˆ°ï¼Œè¦ä¹ˆä»æœ¬åœ°æ¶ˆæ¯å¯¹è±¡çš„å±æ€§ä¸­è·å¾—ï¼Œåæ­£å“ªä¸ªéƒ½ä¸å®¹æ˜“ï¼Œå•é ä¸€ä¸ª_fpæ–‡ä»¶å°±è§£å¯†å‡ºæ¥åŸæ–‡ä»¶åº”è¯¥ä¸å¤ªç°å®ã€‚æ‰€ä»¥æˆ‘å°±åªèƒ½æ”¾å¼ƒäº†ã€‚</p>\n<h1 id=\"ç ´è§£æ–¹æ³•\"><a href=\"#ç ´è§£æ–¹æ³•\" class=\"headerlink\" title=\"ç ´è§£æ–¹æ³•\"></a>ç ´è§£æ–¹æ³•</h1><p>è™½ç„¶å‰é¢è¯´äº†æ²¡è§£å‡ºæ¥ï¼Œä½†æ˜¯ä¸ä»£è¡¨ä¸èƒ½è·å¾—ç…§ç‰‡å•Šï¼ˆï¿£ï¸¶ï¿£ï¼‰â†—ã€€</p>\n<p>æä¾›ä¸‰ç§æ–¹æ³•ï¼š</p>\n<ul>\n<li><p>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨bugå®ç°ï¼Œä¸¾æŠ¥å¥½å‹å¡«å†™ä¿¡æ¯æ—¶å‹¾é€‰é—ªç…§ï¼Œåœ¨ä¸¾æŠ¥æˆåŠŸåä¼šæ˜¾ç¤ºé—ªç…§å†…å®¹ï¼ˆå¥½å‹ï¼šæˆ‘tmçœŸçš„è°¢è°¢ä½ ï¼‰ï¼Œä¸è¿‡æˆ‘è§‰å¾—åé¢è…¾è®¯åº”è¯¥ä¼šä¿®å¤ã€‚</p>\n</li>\n<li><p>æ–¹æ³•äºŒï¼šæœ€ç®€å•çš„ï¼Œç”¨å¦ä¸€ä¸ªæ‰‹æœºæ‹ç…§ï¼Œæœ€å®ç”¨æœ€é è°±çš„(ï½ï¿£â–½ï¿£)ï½</p>\n</li>\n<li><p>æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨æ¨¡æ‹Ÿæœºæ‰“å¼€qqï¼Œåœ¨æ¨¡æ‹Ÿæœºé‡Œé¢æ˜¯æ— æ³•é™åˆ¶ä¸»æœºæˆªå›¾çš„ï¼Œä¸‹è½½ä¸€ä¸ªVMOSæ¨¡æ‹Ÿæœºåï¼ˆåº”ç”¨å•†åº—æœ‰ï¼‰åœ¨é‡Œé¢ä¸‹è½½ä¸€ä¸ªqqæ‰“å¼€é—ªç…§æ—¶å°±å¯ä»¥æˆªå›¾äº†[]<del>(ï¿£â–½ï¿£)</del>*</p>\n</li>\n</ul>\n<p>ä¸ªäººè§‚ç‚¹ï¼šæˆ‘è§‰å¾—éå¿…è¦æƒ…å†µæ²¡å¿…è¦å»è·å¾—é—ªç…§ï¼Œæ¯•ç«Ÿåˆ«äººå‘é—ªç…§å°±æ˜¯ä¸æƒ³è®©ä½ ä¿å­˜ï¼Œæ‰€ä»¥çœ‹çœ‹å°±è¡Œäº†</p>\n","text":" å’Œæœ‹å‹èŠå¤©æ—¶çªå‘å¥‡æƒ³ï¼Œæƒ³å°è¯•ä¸€ä¸‹è·å–é—ªç…§æºæ–‡ä»¶ï¼Œå¿™äº†ä¸€ä¸ªä¸‹åˆè¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼ˆä¸»è¦æ˜¯å¤ªèœäº† /(ã„’oã„’)/~~ ï¼‰ åŸç†å’Œæ€è·¯é—ªç…§è²Œä¼¼æ˜¯ä¸€ç§æœ¨é©¬æ”¹ç¼–è€Œæ¥ï¼Œä½†æ˜¯å› ä¸ºå®ç”¨æ€§ä¸é«˜å¯èƒ½å°±è¢«è®¾è®¡æˆé—ªç…§äº†ï¼ˆç›²çŒœï¼‰ã€‚é—ªç…§çš„å·¥ä½œåŸç†å¤§æ¦‚æ˜¯æœ‰ä¸€ä¸ªFLAG_SECUREçª—å£ï¼Œå¦‚æœå¯ç”¨äº†FLAG_SEC...","link":"","photos":[],"count_time":{"symbolsCount":"8.6k","symbolsTime":"8 mins."},"categories":[],"tags":[{"name":"æ„Ÿæƒ³","slug":"æ„Ÿæƒ³","count":2,"path":"api/tags/æ„Ÿæƒ³.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8E%9F%E7%90%86%E5%92%8C%E6%80%9D%E8%B7%AF\"><span class=\"toc-text\">åŸç†å’Œæ€è·¯</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">ç ´è§£æ–¹æ³•</span></a></li></ol>","author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ctfshow-pwn","uid":"52662f34cef48ec0871eed4c3bef0137","slug":"ctfshow-pwn","date":"2021-10-16T09:55:50.000Z","updated":"2021-10-29T10:54:03.057Z","comments":true,"path":"api/articles/ctfshow-pwn.json","keywords":null,"cover":"https://i.loli.net/2021/10/29/ctwdE4PqChNIpzb.jpg","text":"pwn03å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ æ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š æ³„éœ² putsåœ°å€ è·å– libc ç‰ˆæœ¬ è·å– system åœ°å€ä¸ /bin/s...","link":"","photos":[],"count_time":{"symbolsCount":"9.6k","symbolsTime":"9 mins."},"categories":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","count":6,"path":"api/categories/åˆ·é¢˜.json"}],"tags":[{"name":"pwn","slug":"pwn","count":6,"path":"api/tags/pwn.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}}},"next_post":{"title":"ctfshow-misc","uid":"050531b15fb9d2cd0cab573b50dcfcd8","slug":"ctfshow-misc","date":"2021-10-05T14:43:36.000Z","updated":"2021-10-16T10:01:31.821Z","comments":true,"path":"api/articles/ctfshow-misc.json","keywords":null,"cover":"https://i.loli.net/2021/10/13/nMZwPpxO8NWJRi4.jpg","text":"misc1ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€å°±æœ‰flag misc2æ‰“å¼€txtæ–‡ä»¶å‡ºç°ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngï¼Œç›´æ¥æ”¹åç¼€åå³å¯ misc3bpgæ–‡ä»¶ä½¿ç”¨bpgviewå·¥å…·æ‰“å¼€ï¼Œæ‰“å¼€åå³å¯è·å¾—flag ","link":"","photos":[],"count_time":{"symbolsCount":98,"symbolsTime":"1 mins."},"categories":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","count":6,"path":"api/categories/åˆ·é¢˜.json"}],"tags":[{"name":"misc","slug":"misc","count":3,"path":"api/tags/misc.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}}}}